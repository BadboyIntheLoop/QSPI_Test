ARM GAS  /tmp/ccdMdDsR.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 28, 1
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 1
  10              		.eabi_attribute 34, 1
  11              		.eabi_attribute 18, 4
  12              		.file	"z_qflash_W25QXXX.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.section	.text.QFlash_IsQSPIAvailable,"ax",%progbits
  17              		.align	1
  18              		.global	QFlash_IsQSPIAvailable
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv5-d16
  25              	QFlash_IsQSPIAvailable:
  26              	.LFB144:
  27              		.file 1 "Core/Src/z_qflash_W25QXXX.c"
   1:Core/Src/z_qflash_W25QXXX.c **** /*********************************************
   2:Core/Src/z_qflash_W25QXXX.c ****  * @file Z_QFLASH_W25QXXX.c
   3:Core/Src/z_qflash_W25QXXX.c ****  * @author mauro
   4:Core/Src/z_qflash_W25QXXX.c ****  * @date: 01 august 2024
   5:Core/Src/z_qflash_W25QXXX.c ****  * @version V.1.0.0
   6:Core/Src/z_qflash_W25QXXX.c ****  * 
   7:Core/Src/z_qflash_W25QXXX.c ****  *********************************************
   8:Core/Src/z_qflash_W25QXXX.c ****  * this version of library uses QSPI port
   9:Core/Src/z_qflash_W25QXXX.c ****  * mode transmission
  10:Core/Src/z_qflash_W25QXXX.c ****  * this version of library uses QUADSPI flash mode
  11:Core/Src/z_qflash_W25QXXX.c ****  *********************************************
  12:Core/Src/z_qflash_W25QXXX.c ****  * it previously neets to setup
  13:Core/Src/z_qflash_W25QXXX.c ****  * configuration in Z_QFLASH_W25QXXX.h
  14:Core/Src/z_qflash_W25QXXX.c ****  *********************************************/
  15:Core/Src/z_qflash_W25QXXX.c **** 
  16:Core/Src/z_qflash_W25QXXX.c **** 
  17:Core/Src/z_qflash_W25QXXX.c **** #include "main.h"
  18:Core/Src/z_qflash_W25QXXX.c **** 
  19:Core/Src/z_qflash_W25QXXX.c **** 
  20:Core/Src/z_qflash_W25QXXX.c **** extern QSPI_HandleTypeDef FLASH_QSPI_PORT;
  21:Core/Src/z_qflash_W25QXXX.c **** 
  22:Core/Src/z_qflash_W25QXXX.c **** static volatile uint8_t QSpiAvailable=1;  			// 0 if QuadSPI is busy; 1 if it is free (operation cp
  23:Core/Src/z_qflash_W25QXXX.c **** static volatile uint8_t QSpiReadDataAvailable=1;  	// 0 if QuadSPI is busy; 1 if it is free (operat
  24:Core/Src/z_qflash_W25QXXX.c **** 
  25:Core/Src/z_qflash_W25QXXX.c **** 
  26:Core/Src/z_qflash_W25QXXX.c **** 
  27:Core/Src/z_qflash_W25QXXX.c **** /***********************************************
  28:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	It returns the status of the QSPI port
  29:Core/Src/z_qflash_W25QXXX.c ****  * @RETURN	1	QuadSPI port available
  30:Core/Src/z_qflash_W25QXXX.c ****  * 			0	QuadSPI port busy
  31:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************/
ARM GAS  /tmp/ccdMdDsR.s 			page 2


  32:Core/Src/z_qflash_W25QXXX.c **** uint8_t QFlash_IsQSPIAvailable() {
  28              		.loc 1 32 34 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33:Core/Src/z_qflash_W25QXXX.c **** 	return QSpiAvailable;
  33              		.loc 1 33 2 view .LVU1
  34              		.loc 1 33 9 is_stmt 0 view .LVU2
  35 0000 014B     		ldr	r3, .L2
  36 0002 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  34:Core/Src/z_qflash_W25QXXX.c **** }
  37              		.loc 1 34 1 view .LVU3
  38 0004 7047     		bx	lr
  39              	.L3:
  40 0006 00BF     		.align	2
  41              	.L2:
  42 0008 00000000 		.word	.LANCHOR0
  43              		.cfi_endproc
  44              	.LFE144:
  46              		.section	.text.QFlash_WaitForQSPIAvailable,"ax",%progbits
  47              		.align	1
  48              		.global	QFlash_WaitForQSPIAvailable
  49              		.syntax unified
  50              		.thumb
  51              		.thumb_func
  52              		.fpu fpv5-d16
  54              	QFlash_WaitForQSPIAvailable:
  55              	.LVL0:
  56              	.LFB145:
  35:Core/Src/z_qflash_W25QXXX.c **** 
  36:Core/Src/z_qflash_W25QXXX.c **** 
  37:Core/Src/z_qflash_W25QXXX.c **** 
  38:Core/Src/z_qflash_W25QXXX.c **** 
  39:Core/Src/z_qflash_W25QXXX.c **** /***********************************************
  40:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Wait for a free QuadSPI port
  41:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	timeout		non 0 	= 	time limit for data
  42:Core/Src/z_qflash_W25QXXX.c ****  * 									transfer complete
  43:Core/Src/z_qflash_W25QXXX.c ****  * 						0 		= 	indefinite waiting
  44:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************/
  45:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WaitForQSPIAvailable(uint32_t timeout) {
  57              		.loc 1 45 65 is_stmt 1 view -0
  58              		.cfi_startproc
  59              		@ args = 0, pretend = 0, frame = 0
  60              		@ frame_needed = 0, uses_anonymous_args = 0
  61              		.loc 1 45 65 is_stmt 0 view .LVU5
  62 0000 38B5     		push	{r3, r4, r5, lr}
  63              	.LCFI0:
  64              		.cfi_def_cfa_offset 16
  65              		.cfi_offset 3, -16
  66              		.cfi_offset 4, -12
  67              		.cfi_offset 5, -8
  68              		.cfi_offset 14, -4
  69 0002 0446     		mov	r4, r0
  46:Core/Src/z_qflash_W25QXXX.c **** 	uint32_t curtime = HAL_GetTick();
  70              		.loc 1 46 2 is_stmt 1 view .LVU6
  71              		.loc 1 46 21 is_stmt 0 view .LVU7
ARM GAS  /tmp/ccdMdDsR.s 			page 3


  72 0004 FFF7FEFF 		bl	HAL_GetTick
  73              	.LVL1:
  74              		.loc 1 46 21 view .LVU8
  75 0008 0546     		mov	r5, r0
  76              	.LVL2:
  47:Core/Src/z_qflash_W25QXXX.c **** 
  48:Core/Src/z_qflash_W25QXXX.c **** 	while ((!QSpiAvailable) && ((timeout==0) || ((HAL_GetTick()-curtime)<=timeout))) {};
  77              		.loc 1 48 2 is_stmt 1 view .LVU9
  78              	.L6:
  79              		.loc 1 48 84 discriminator 5 view .LVU10
  80              		.loc 1 48 8 discriminator 5 view .LVU11
  81              		.loc 1 48 10 is_stmt 0 discriminator 5 view .LVU12
  82 000a 084B     		ldr	r3, .L11
  83 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  84              		.loc 1 48 8 discriminator 5 view .LVU13
  85 000e 33B9     		cbnz	r3, .L5
  86              		.loc 1 48 26 discriminator 1 view .LVU14
  87 0010 002C     		cmp	r4, #0
  88 0012 FAD0     		beq	.L6
  89              		.loc 1 48 48 discriminator 4 view .LVU15
  90 0014 FFF7FEFF 		bl	HAL_GetTick
  91              	.LVL3:
  92              		.loc 1 48 61 discriminator 4 view .LVU16
  93 0018 401B     		subs	r0, r0, r5
  94              		.loc 1 48 43 discriminator 4 view .LVU17
  95 001a A042     		cmp	r0, r4
  96 001c F5D9     		bls	.L6
  97              	.L5:
  98              		.loc 1 48 85 is_stmt 1 discriminator 6 view .LVU18
  49:Core/Src/z_qflash_W25QXXX.c **** 	if (!QSpiAvailable)
  99              		.loc 1 49 2 discriminator 6 view .LVU19
 100              		.loc 1 49 6 is_stmt 0 discriminator 6 view .LVU20
 101 001e 034B     		ldr	r3, .L11
 102 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 103              		.loc 1 49 5 discriminator 6 view .LVU21
 104 0022 0BB1     		cbz	r3, .L9
  50:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
  51:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 105              		.loc 1 51 9 view .LVU22
 106 0024 0020     		movs	r0, #0
 107              	.L8:
  52:Core/Src/z_qflash_W25QXXX.c **** };
 108              		.loc 1 52 1 view .LVU23
 109 0026 38BD     		pop	{r3, r4, r5, pc}
 110              	.LVL4:
 111              	.L9:
  50:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 112              		.loc 1 50 10 view .LVU24
 113 0028 0120     		movs	r0, #1
 114 002a FCE7     		b	.L8
 115              	.L12:
 116              		.align	2
 117              	.L11:
 118 002c 00000000 		.word	.LANCHOR0
 119              		.cfi_endproc
 120              	.LFE145:
 122              		.section	.text.QFlash_IsDataAvailable,"ax",%progbits
ARM GAS  /tmp/ccdMdDsR.s 			page 4


 123              		.align	1
 124              		.global	QFlash_IsDataAvailable
 125              		.syntax unified
 126              		.thumb
 127              		.thumb_func
 128              		.fpu fpv5-d16
 130              	QFlash_IsDataAvailable:
 131              	.LFB146:
  53:Core/Src/z_qflash_W25QXXX.c **** 
  54:Core/Src/z_qflash_W25QXXX.c **** 
  55:Core/Src/z_qflash_W25QXXX.c **** 
  56:Core/Src/z_qflash_W25QXXX.c **** 
  57:Core/Src/z_qflash_W25QXXX.c **** 
  58:Core/Src/z_qflash_W25QXXX.c **** /***********************************************
  59:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	It returns the status of the QSPI
  60:Core/Src/z_qflash_W25QXXX.c ****  * 			receive command
  61:Core/Src/z_qflash_W25QXXX.c ****  * @RETURN	1	= data transmission completed:
  62:Core/Src/z_qflash_W25QXXX.c ****  * 				  data requested is available
  63:Core/Src/z_qflash_W25QXXX.c ****  * 			0	= data transmission still running
  64:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************/
  65:Core/Src/z_qflash_W25QXXX.c **** uint8_t QFlash_IsDataAvailable() {
 132              		.loc 1 65 34 is_stmt 1 view -0
 133              		.cfi_startproc
 134              		@ args = 0, pretend = 0, frame = 0
 135              		@ frame_needed = 0, uses_anonymous_args = 0
 136              		@ link register save eliminated.
  66:Core/Src/z_qflash_W25QXXX.c **** 	return QSpiReadDataAvailable;
 137              		.loc 1 66 2 view .LVU26
 138              		.loc 1 66 9 is_stmt 0 view .LVU27
 139 0000 014B     		ldr	r3, .L14
 140 0002 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  67:Core/Src/z_qflash_W25QXXX.c **** }
 141              		.loc 1 67 1 view .LVU28
 142 0004 7047     		bx	lr
 143              	.L15:
 144 0006 00BF     		.align	2
 145              	.L14:
 146 0008 00000000 		.word	.LANCHOR1
 147              		.cfi_endproc
 148              	.LFE146:
 150              		.section	.text.QFlash_WaitForDataAvailable,"ax",%progbits
 151              		.align	1
 152              		.global	QFlash_WaitForDataAvailable
 153              		.syntax unified
 154              		.thumb
 155              		.thumb_func
 156              		.fpu fpv5-d16
 158              	QFlash_WaitForDataAvailable:
 159              	.LVL5:
 160              	.LFB147:
  68:Core/Src/z_qflash_W25QXXX.c **** 
  69:Core/Src/z_qflash_W25QXXX.c **** 
  70:Core/Src/z_qflash_W25QXXX.c **** 
  71:Core/Src/z_qflash_W25QXXX.c **** /***********************************************
  72:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Wait for the completed data
  73:Core/Src/z_qflash_W25QXXX.c ****  * 			transfer (meaningless in polling
  74:Core/Src/z_qflash_W25QXXX.c ****  * 			mode
ARM GAS  /tmp/ccdMdDsR.s 			page 5


  75:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	timeout		non 0 	= 	time limit for data
  76:Core/Src/z_qflash_W25QXXX.c ****  * 									transfer complete
  77:Core/Src/z_qflash_W25QXXX.c ****  * 						0 		= 	indefinite waiting
  78:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************/
  79:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WaitForDataAvailable(uint32_t timeout) {
 161              		.loc 1 79 65 is_stmt 1 view -0
 162              		.cfi_startproc
 163              		@ args = 0, pretend = 0, frame = 0
 164              		@ frame_needed = 0, uses_anonymous_args = 0
 165              		.loc 1 79 65 is_stmt 0 view .LVU30
 166 0000 38B5     		push	{r3, r4, r5, lr}
 167              	.LCFI1:
 168              		.cfi_def_cfa_offset 16
 169              		.cfi_offset 3, -16
 170              		.cfi_offset 4, -12
 171              		.cfi_offset 5, -8
 172              		.cfi_offset 14, -4
 173 0002 0446     		mov	r4, r0
  80:Core/Src/z_qflash_W25QXXX.c **** 	uint32_t curtime = HAL_GetTick();
 174              		.loc 1 80 2 is_stmt 1 view .LVU31
 175              		.loc 1 80 21 is_stmt 0 view .LVU32
 176 0004 FFF7FEFF 		bl	HAL_GetTick
 177              	.LVL6:
 178              		.loc 1 80 21 view .LVU33
 179 0008 0546     		mov	r5, r0
 180              	.LVL7:
  81:Core/Src/z_qflash_W25QXXX.c **** 
  82:Core/Src/z_qflash_W25QXXX.c **** 	while ((!QSpiReadDataAvailable) && ((timeout==0) || ((HAL_GetTick()-curtime)<=timeout))) {};
 181              		.loc 1 82 2 is_stmt 1 view .LVU34
 182              	.L18:
 183              		.loc 1 82 92 discriminator 5 view .LVU35
 184              		.loc 1 82 8 discriminator 5 view .LVU36
 185              		.loc 1 82 10 is_stmt 0 discriminator 5 view .LVU37
 186 000a 084B     		ldr	r3, .L23
 187 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 188              		.loc 1 82 8 discriminator 5 view .LVU38
 189 000e 33B9     		cbnz	r3, .L17
 190              		.loc 1 82 34 discriminator 1 view .LVU39
 191 0010 002C     		cmp	r4, #0
 192 0012 FAD0     		beq	.L18
 193              		.loc 1 82 56 discriminator 4 view .LVU40
 194 0014 FFF7FEFF 		bl	HAL_GetTick
 195              	.LVL8:
 196              		.loc 1 82 69 discriminator 4 view .LVU41
 197 0018 401B     		subs	r0, r0, r5
 198              		.loc 1 82 51 discriminator 4 view .LVU42
 199 001a A042     		cmp	r0, r4
 200 001c F5D9     		bls	.L18
 201              	.L17:
 202              		.loc 1 82 93 is_stmt 1 discriminator 6 view .LVU43
  83:Core/Src/z_qflash_W25QXXX.c **** 	if (!QSpiReadDataAvailable)
 203              		.loc 1 83 2 discriminator 6 view .LVU44
 204              		.loc 1 83 6 is_stmt 0 discriminator 6 view .LVU45
 205 001e 034B     		ldr	r3, .L23
 206 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 207              		.loc 1 83 5 discriminator 6 view .LVU46
 208 0022 0BB1     		cbz	r3, .L21
ARM GAS  /tmp/ccdMdDsR.s 			page 6


  84:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
  85:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 209              		.loc 1 85 9 view .LVU47
 210 0024 0020     		movs	r0, #0
 211              	.L20:
  86:Core/Src/z_qflash_W25QXXX.c **** };
 212              		.loc 1 86 1 view .LVU48
 213 0026 38BD     		pop	{r3, r4, r5, pc}
 214              	.LVL9:
 215              	.L21:
  84:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 216              		.loc 1 84 10 view .LVU49
 217 0028 0120     		movs	r0, #1
 218 002a FCE7     		b	.L20
 219              	.L24:
 220              		.align	2
 221              	.L23:
 222 002c 00000000 		.word	.LANCHOR1
 223              		.cfi_endproc
 224              	.LFE147:
 226              		.section	.text.QFlash_DefaultCmd,"ax",%progbits
 227              		.align	1
 228              		.global	QFlash_DefaultCmd
 229              		.syntax unified
 230              		.thumb
 231              		.thumb_func
 232              		.fpu fpv5-d16
 234              	QFlash_DefaultCmd:
 235              	.LVL10:
 236              	.LFB148:
  87:Core/Src/z_qflash_W25QXXX.c **** 
  88:Core/Src/z_qflash_W25QXXX.c **** 
  89:Core/Src/z_qflash_W25QXXX.c **** 
  90:Core/Src/z_qflash_W25QXXX.c **** 
  91:Core/Src/z_qflash_W25QXXX.c **** 
  92:Core/Src/z_qflash_W25QXXX.c **** /************************************************
  93:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Desault configuration
  94:Core/Src/z_qflash_W25QXXX.c ****  * 			of the "sCommand" parameters set
  95:Core/Src/z_qflash_W25QXXX.c ****  * 			for "HAL_QSPI_Command()"
  96:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	SCommand	parameters set to setup
  97:Core/Src/z_qflash_W25QXXX.c ****  ************************************************/
  98:Core/Src/z_qflash_W25QXXX.c **** void QFlash_DefaultCmd(QSPI_CommandTypeDef *sCommand) {
 237              		.loc 1 98 55 is_stmt 1 view -0
 238              		.cfi_startproc
 239              		@ args = 0, pretend = 0, frame = 0
 240              		@ frame_needed = 0, uses_anonymous_args = 0
 241              		@ link register save eliminated.
  99:Core/Src/z_qflash_W25QXXX.c **** 
 100:Core/Src/z_qflash_W25QXXX.c ****     sCommand->InstructionMode = QFLASH_INSTRUCTION_MODE;
 242              		.loc 1 100 5 view .LVU51
 243              		.loc 1 100 31 is_stmt 0 view .LVU52
 244 0000 4FF48073 		mov	r3, #256
 245 0004 8361     		str	r3, [r0, #24]
 101:Core/Src/z_qflash_W25QXXX.c ****     sCommand->AddressMode = QFLASH_ADDRESS_MODE;
 246              		.loc 1 101 5 is_stmt 1 view .LVU53
 247              		.loc 1 101 27 is_stmt 0 view .LVU54
 248 0006 4FF44063 		mov	r3, #3072
ARM GAS  /tmp/ccdMdDsR.s 			page 7


 249 000a C361     		str	r3, [r0, #28]
 102:Core/Src/z_qflash_W25QXXX.c ****     sCommand->AddressSize = QFLASH_ADDRESS_SIZE;
 250              		.loc 1 102 5 is_stmt 1 view .LVU55
 251              		.loc 1 102 27 is_stmt 0 view .LVU56
 252 000c 4FF40053 		mov	r3, #8192
 253 0010 C360     		str	r3, [r0, #12]
 103:Core/Src/z_qflash_W25QXXX.c ****     sCommand->DataMode = QFLASH_DATA_MODE;
 254              		.loc 1 103 5 is_stmt 1 view .LVU57
 255              		.loc 1 103 24 is_stmt 0 view .LVU58
 256 0012 4FF04073 		mov	r3, #50331648
 257 0016 4362     		str	r3, [r0, #36]
 104:Core/Src/z_qflash_W25QXXX.c ****     sCommand->AlternateByteMode = QFLASH_ALTERNATE_BYTE_MODE;
 258              		.loc 1 104 5 is_stmt 1 view .LVU59
 259              		.loc 1 104 33 is_stmt 0 view .LVU60
 260 0018 0023     		movs	r3, #0
 261 001a 0362     		str	r3, [r0, #32]
 105:Core/Src/z_qflash_W25QXXX.c ****     sCommand->DdrMode = QFLASH_DDR_MODE;
 262              		.loc 1 105 5 is_stmt 1 view .LVU61
 263              		.loc 1 105 23 is_stmt 0 view .LVU62
 264 001c C362     		str	r3, [r0, #44]
 106:Core/Src/z_qflash_W25QXXX.c ****     sCommand->DdrHoldHalfCycle = QFLASH_DDR_HOLD_HALF_CYCLE;
 265              		.loc 1 106 5 is_stmt 1 view .LVU63
 266              		.loc 1 106 32 is_stmt 0 view .LVU64
 267 001e 0363     		str	r3, [r0, #48]
 107:Core/Src/z_qflash_W25QXXX.c ****     sCommand->SIOOMode = QFLASH_SIOO_MODE;
 268              		.loc 1 107 5 is_stmt 1 view .LVU65
 269              		.loc 1 107 24 is_stmt 0 view .LVU66
 270 0020 4363     		str	r3, [r0, #52]
 108:Core/Src/z_qflash_W25QXXX.c ****     sCommand->DummyCycles = QFLASH_DUMMY_CYCLES;
 271              		.loc 1 108 5 is_stmt 1 view .LVU67
 272              		.loc 1 108 27 is_stmt 0 view .LVU68
 273 0022 4361     		str	r3, [r0, #20]
 109:Core/Src/z_qflash_W25QXXX.c **** 
 110:Core/Src/z_qflash_W25QXXX.c ****     return;
 274              		.loc 1 110 5 is_stmt 1 view .LVU69
 111:Core/Src/z_qflash_W25QXXX.c **** }
 275              		.loc 1 111 1 is_stmt 0 view .LVU70
 276 0024 7047     		bx	lr
 277              		.cfi_endproc
 278              	.LFE148:
 280              		.section	.text.QFlash_Reset,"ax",%progbits
 281              		.align	1
 282              		.global	QFlash_Reset
 283              		.syntax unified
 284              		.thumb
 285              		.thumb_func
 286              		.fpu fpv5-d16
 288              	QFlash_Reset:
 289              	.LFB149:
 112:Core/Src/z_qflash_W25QXXX.c **** 
 113:Core/Src/z_qflash_W25QXXX.c **** 
 114:Core/Src/z_qflash_W25QXXX.c **** 
 115:Core/Src/z_qflash_W25QXXX.c **** 
 116:Core/Src/z_qflash_W25QXXX.c **** 
 117:Core/Src/z_qflash_W25QXXX.c **** 
 118:Core/Src/z_qflash_W25QXXX.c **** /******************************************************************
 119:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Reset W25Q chip
ARM GAS  /tmp/ccdMdDsR.s 			page 8


 120:Core/Src/z_qflash_W25QXXX.c ****  ******************************************************************/
 121:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_Reset() {
 290              		.loc 1 121 34 is_stmt 1 view -0
 291              		.cfi_startproc
 292              		@ args = 0, pretend = 0, frame = 56
 293              		@ frame_needed = 0, uses_anonymous_args = 0
 294 0000 10B5     		push	{r4, lr}
 295              	.LCFI2:
 296              		.cfi_def_cfa_offset 8
 297              		.cfi_offset 4, -8
 298              		.cfi_offset 14, -4
 299 0002 8EB0     		sub	sp, sp, #56
 300              	.LCFI3:
 301              		.cfi_def_cfa_offset 64
 122:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 302              		.loc 1 122 2 view .LVU72
 303              		.loc 1 122 22 is_stmt 0 view .LVU73
 304 0004 3822     		movs	r2, #56
 305 0006 0021     		movs	r1, #0
 306 0008 6846     		mov	r0, sp
 307 000a FFF7FEFF 		bl	memset
 308              	.LVL11:
 123:Core/Src/z_qflash_W25QXXX.c **** 
 124:Core/Src/z_qflash_W25QXXX.c **** 	// send a "reset enable" command
 125:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 309              		.loc 1 125 2 is_stmt 1 view .LVU74
 310 000e 6846     		mov	r0, sp
 311 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 312              	.LVL12:
 126:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction = W25_RESET_EN;
 313              		.loc 1 126 2 view .LVU75
 314              		.loc 1 126 23 is_stmt 0 view .LVU76
 315 0014 6623     		movs	r3, #102
 316 0016 0093     		str	r3, [sp]
 127:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode = QSPI_ADDRESS_NONE;
 317              		.loc 1 127 2 is_stmt 1 view .LVU77
 318              		.loc 1 127 23 is_stmt 0 view .LVU78
 319 0018 0023     		movs	r3, #0
 320 001a 0793     		str	r3, [sp, #28]
 128:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode = QSPI_DATA_NONE;
 321              		.loc 1 128 2 is_stmt 1 view .LVU79
 322              		.loc 1 128 20 is_stmt 0 view .LVU80
 323 001c 0993     		str	r3, [sp, #36]
 129:Core/Src/z_qflash_W25QXXX.c **** 
 130:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 131:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 324              		.loc 1 131 2 is_stmt 1 view .LVU81
 325              	.L27:
 326              		.loc 1 131 26 discriminator 1 view .LVU82
 327              		.loc 1 131 8 discriminator 1 view .LVU83
 328              		.loc 1 131 9 is_stmt 0 discriminator 1 view .LVU84
 329 001e 164B     		ldr	r3, .L35
 330 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 331              		.loc 1 131 8 discriminator 1 view .LVU85
 332 0022 002B     		cmp	r3, #0
 333 0024 FBD0     		beq	.L27
 334              		.loc 1 131 27 is_stmt 1 discriminator 2 view .LVU86
ARM GAS  /tmp/ccdMdDsR.s 			page 9


 132:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 133:Core/Src/z_qflash_W25QXXX.c **** 
 134:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 335              		.loc 1 134 2 discriminator 2 view .LVU87
 336              		.loc 1 134 6 is_stmt 0 discriminator 2 view .LVU88
 337 0026 41F28832 		movw	r2, #5000
 338 002a 6946     		mov	r1, sp
 339 002c 1348     		ldr	r0, .L35+4
 340 002e FFF7FEFF 		bl	HAL_QSPI_Command
 341              	.LVL13:
 342              		.loc 1 134 5 discriminator 2 view .LVU89
 343 0032 18B1     		cbz	r0, .L33
 135:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 344              		.loc 1 135 10 view .LVU90
 345 0034 0124     		movs	r4, #1
 346              	.L28:
 136:Core/Src/z_qflash_W25QXXX.c **** 	}
 137:Core/Src/z_qflash_W25QXXX.c **** 	HAL_Delay(1);									// 30us needed by resetting
 138:Core/Src/z_qflash_W25QXXX.c **** 
 139:Core/Src/z_qflash_W25QXXX.c **** 	// send a "reset" command
 140:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 141:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction = W25_RESET;
 142:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode = QSPI_ADDRESS_NONE;
 143:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode = QSPI_DATA_NONE;
 144:Core/Src/z_qflash_W25QXXX.c **** 
 145:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 146:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 147:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 148:Core/Src/z_qflash_W25QXXX.c **** 
 149:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 150:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 151:Core/Src/z_qflash_W25QXXX.c **** 	}
 152:Core/Src/z_qflash_W25QXXX.c **** 	HAL_Delay(1);									// 30us needed by resetting
 153:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 154:Core/Src/z_qflash_W25QXXX.c **** 
 155:Core/Src/z_qflash_W25QXXX.c **** }
 347              		.loc 1 155 1 view .LVU91
 348 0036 2046     		mov	r0, r4
 349 0038 0EB0     		add	sp, sp, #56
 350              	.LCFI4:
 351              		.cfi_remember_state
 352              		.cfi_def_cfa_offset 8
 353              		@ sp needed
 354 003a 10BD     		pop	{r4, pc}
 355              	.L33:
 356              	.LCFI5:
 357              		.cfi_restore_state
 137:Core/Src/z_qflash_W25QXXX.c **** 
 358              		.loc 1 137 2 is_stmt 1 view .LVU92
 359 003c 0120     		movs	r0, #1
 360 003e FFF7FEFF 		bl	HAL_Delay
 361              	.LVL14:
 140:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction = W25_RESET;
 362              		.loc 1 140 2 view .LVU93
 363 0042 6846     		mov	r0, sp
 364 0044 FFF7FEFF 		bl	QFlash_DefaultCmd
 365              	.LVL15:
ARM GAS  /tmp/ccdMdDsR.s 			page 10


 141:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode = QSPI_ADDRESS_NONE;
 366              		.loc 1 141 2 view .LVU94
 141:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode = QSPI_ADDRESS_NONE;
 367              		.loc 1 141 23 is_stmt 0 view .LVU95
 368 0048 9923     		movs	r3, #153
 369 004a 0093     		str	r3, [sp]
 142:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode = QSPI_DATA_NONE;
 370              		.loc 1 142 2 is_stmt 1 view .LVU96
 142:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode = QSPI_DATA_NONE;
 371              		.loc 1 142 23 is_stmt 0 view .LVU97
 372 004c 0023     		movs	r3, #0
 373 004e 0793     		str	r3, [sp, #28]
 143:Core/Src/z_qflash_W25QXXX.c **** 
 374              		.loc 1 143 2 is_stmt 1 view .LVU98
 143:Core/Src/z_qflash_W25QXXX.c **** 
 375              		.loc 1 143 20 is_stmt 0 view .LVU99
 376 0050 0993     		str	r3, [sp, #36]
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 377              		.loc 1 146 2 is_stmt 1 view .LVU100
 378              	.L29:
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 379              		.loc 1 146 26 discriminator 1 view .LVU101
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 380              		.loc 1 146 8 discriminator 1 view .LVU102
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 381              		.loc 1 146 9 is_stmt 0 discriminator 1 view .LVU103
 382 0052 094B     		ldr	r3, .L35
 383 0054 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 384              		.loc 1 146 8 discriminator 1 view .LVU104
 385 0056 002B     		cmp	r3, #0
 386 0058 FBD0     		beq	.L29
 146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 387              		.loc 1 146 27 is_stmt 1 discriminator 2 view .LVU105
 149:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 388              		.loc 1 149 2 discriminator 2 view .LVU106
 149:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 389              		.loc 1 149 6 is_stmt 0 discriminator 2 view .LVU107
 390 005a 41F28832 		movw	r2, #5000
 391 005e 6946     		mov	r1, sp
 392 0060 0648     		ldr	r0, .L35+4
 393 0062 FFF7FEFF 		bl	HAL_QSPI_Command
 394              	.LVL16:
 149:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 395              		.loc 1 149 5 discriminator 2 view .LVU108
 396 0066 0446     		mov	r4, r0
 397 0068 08B1     		cbz	r0, .L34
 150:Core/Src/z_qflash_W25QXXX.c **** 	}
 398              		.loc 1 150 10 view .LVU109
 399 006a 0124     		movs	r4, #1
 400 006c E3E7     		b	.L28
 401              	.L34:
 152:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 402              		.loc 1 152 2 is_stmt 1 view .LVU110
 403 006e 0120     		movs	r0, #1
 404 0070 FFF7FEFF 		bl	HAL_Delay
 405              	.LVL17:
ARM GAS  /tmp/ccdMdDsR.s 			page 11


 153:Core/Src/z_qflash_W25QXXX.c **** 
 406              		.loc 1 153 2 view .LVU111
 153:Core/Src/z_qflash_W25QXXX.c **** 
 407              		.loc 1 153 9 is_stmt 0 view .LVU112
 408 0074 DFE7     		b	.L28
 409              	.L36:
 410 0076 00BF     		.align	2
 411              	.L35:
 412 0078 00000000 		.word	.LANCHOR0
 413 007c 00000000 		.word	hqspi
 414              		.cfi_endproc
 415              	.LFE149:
 417              		.section	.text.QFlash_ReadJedecID,"ax",%progbits
 418              		.align	1
 419              		.global	QFlash_ReadJedecID
 420              		.syntax unified
 421              		.thumb
 422              		.thumb_func
 423              		.fpu fpv5-d16
 425              	QFlash_ReadJedecID:
 426              	.LVL18:
 427              	.LFB150:
 156:Core/Src/z_qflash_W25QXXX.c **** 
 157:Core/Src/z_qflash_W25QXXX.c **** 
 158:Core/Src/z_qflash_W25QXXX.c **** 
 159:Core/Src/z_qflash_W25QXXX.c **** 
 160:Core/Src/z_qflash_W25QXXX.c **** 
 161:Core/Src/z_qflash_W25QXXX.c **** /******************************************************************
 162:Core/Src/z_qflash_W25QXXX.c ****  * "result[] string will contain:
 163:Core/Src/z_qflash_W25QXXX.c ****  * 		result[0]		Jedec Manufacturer ID (0xEF means Winbond)
 164:Core/Src/z_qflash_W25QXXX.c ****  * 		result[1]		Memory Type
 165:Core/Src/z_qflash_W25QXXX.c ****  * 		result[2]		Capacity
 166:Core/Src/z_qflash_W25QXXX.c ****  ******************************************************************
 167:Core/Src/z_qflash_W25QXXX.c ****  * Memory Capacity code:
 168:Core/Src/z_qflash_W25QXXX.c ****  * 		10H ->	 5Mb		11H ->  10Mb		12H ->  20Mb
 169:Core/Src/z_qflash_W25QXXX.c ****  * 		13H ->  40Mb		14H ->  80Mb		15H ->  16Mb
 170:Core/Src/z_qflash_W25QXXX.c ****  * 		16H ->  32Mb		17H ->  64Mb		18H -> 128Mb
 171:Core/Src/z_qflash_W25QXXX.c ****  * 		19H -> 256Mb		20H -> 512Mb		21H ->   1Gb
 172:Core/Src/z_qflash_W25QXXX.c ****  ******************************************************************/
 173:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadJedecID(uint8_t *dataptr) {
 428              		.loc 1 173 56 is_stmt 1 view -0
 429              		.cfi_startproc
 430              		@ args = 0, pretend = 0, frame = 56
 431              		@ frame_needed = 0, uses_anonymous_args = 0
 432              		.loc 1 173 56 is_stmt 0 view .LVU114
 433 0000 10B5     		push	{r4, lr}
 434              	.LCFI6:
 435              		.cfi_def_cfa_offset 8
 436              		.cfi_offset 4, -8
 437              		.cfi_offset 14, -4
 438 0002 8EB0     		sub	sp, sp, #56
 439              	.LCFI7:
 440              		.cfi_def_cfa_offset 64
 441 0004 0446     		mov	r4, r0
 174:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 442              		.loc 1 174 1 is_stmt 1 view .LVU115
 443              		.loc 1 174 21 is_stmt 0 view .LVU116
ARM GAS  /tmp/ccdMdDsR.s 			page 12


 444 0006 3822     		movs	r2, #56
 445 0008 0021     		movs	r1, #0
 446 000a 6846     		mov	r0, sp
 447              	.LVL19:
 448              		.loc 1 174 21 view .LVU117
 449 000c FFF7FEFF 		bl	memset
 450              	.LVL20:
 175:Core/Src/z_qflash_W25QXXX.c **** 
 176:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 451              		.loc 1 176 2 is_stmt 1 view .LVU118
 452 0010 6846     		mov	r0, sp
 453 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 454              	.LVL21:
 177:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_JEDEC_ID;
 455              		.loc 1 177 2 view .LVU119
 456              		.loc 1 177 23 is_stmt 0 view .LVU120
 457 0016 9F23     		movs	r3, #159
 458 0018 0093     		str	r3, [sp]
 178:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 459              		.loc 1 178 2 is_stmt 1 view .LVU121
 460              		.loc 1 178 22 is_stmt 0 view .LVU122
 461 001a 4FF08073 		mov	r3, #16777216
 462 001e 0993     		str	r3, [sp, #36]
 179:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 463              		.loc 1 179 2 is_stmt 1 view .LVU123
 464              		.loc 1 179 23 is_stmt 0 view .LVU124
 465 0020 0023     		movs	r3, #0
 466 0022 0793     		str	r3, [sp, #28]
 180:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0;
 467              		.loc 1 180 2 is_stmt 1 view .LVU125
 468              		.loc 1 180 20 is_stmt 0 view .LVU126
 469 0024 0193     		str	r3, [sp, #4]
 181:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 3;
 470              		.loc 1 181 5 is_stmt 1 view .LVU127
 471              		.loc 1 181 23 is_stmt 0 view .LVU128
 472 0026 0322     		movs	r2, #3
 473 0028 0A92     		str	r2, [sp, #40]
 182:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DummyCycles 	= 0;
 474              		.loc 1 182 2 is_stmt 1 view .LVU129
 475              		.loc 1 182 24 is_stmt 0 view .LVU130
 476 002a 0593     		str	r3, [sp, #20]
 183:Core/Src/z_qflash_W25QXXX.c **** 
 184:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 185:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 477              		.loc 1 185 2 is_stmt 1 view .LVU131
 478              	.L38:
 479              		.loc 1 185 26 discriminator 1 view .LVU132
 480              		.loc 1 185 8 discriminator 1 view .LVU133
 481              		.loc 1 185 9 is_stmt 0 discriminator 1 view .LVU134
 482 002c 0F4B     		ldr	r3, .L45
 483 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 484              		.loc 1 185 8 discriminator 1 view .LVU135
 485 0030 002B     		cmp	r3, #0
 486 0032 FBD0     		beq	.L38
 487              		.loc 1 185 27 is_stmt 1 discriminator 2 view .LVU136
 186:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 488              		.loc 1 186 2 discriminator 2 view .LVU137
ARM GAS  /tmp/ccdMdDsR.s 			page 13


 489              		.loc 1 186 15 is_stmt 0 discriminator 2 view .LVU138
 490 0034 0023     		movs	r3, #0
 491 0036 0D4A     		ldr	r2, .L45
 492 0038 1370     		strb	r3, [r2]
 187:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 493              		.loc 1 187 2 is_stmt 1 discriminator 2 view .LVU139
 494              		.loc 1 187 23 is_stmt 0 discriminator 2 view .LVU140
 495 003a 0D4A     		ldr	r2, .L45+4
 496 003c 1370     		strb	r3, [r2]
 188:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 497              		.loc 1 188 5 is_stmt 1 discriminator 2 view .LVU141
 498              		.loc 1 188 9 is_stmt 0 discriminator 2 view .LVU142
 499 003e 41F28832 		movw	r2, #5000
 500 0042 6946     		mov	r1, sp
 501 0044 0B48     		ldr	r0, .L45+8
 502 0046 FFF7FEFF 		bl	HAL_QSPI_Command
 503              	.LVL22:
 504              		.loc 1 188 8 discriminator 2 view .LVU143
 505 004a 18B1     		cbz	r0, .L43
 189:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 506              		.loc 1 189 16 view .LVU144
 507 004c 0124     		movs	r4, #1
 508              	.LVL23:
 509              	.L39:
 190:Core/Src/z_qflash_W25QXXX.c ****     }
 191:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 192:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 193:Core/Src/z_qflash_W25QXXX.c ****     }
 194:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
 195:Core/Src/z_qflash_W25QXXX.c **** #else
 196:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 197:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 198:Core/Src/z_qflash_W25QXXX.c ****     }
 199:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
 200:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 201:Core/Src/z_qflash_W25QXXX.c ****     }
 202:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 203:Core/Src/z_qflash_W25QXXX.c **** 
 204:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
 205:Core/Src/z_qflash_W25QXXX.c **** }
 510              		.loc 1 205 1 view .LVU145
 511 004e 2046     		mov	r0, r4
 512 0050 0EB0     		add	sp, sp, #56
 513              	.LCFI8:
 514              		.cfi_remember_state
 515              		.cfi_def_cfa_offset 8
 516              		@ sp needed
 517 0052 10BD     		pop	{r4, pc}
 518              	.LVL24:
 519              	.L43:
 520              	.LCFI9:
 521              		.cfi_restore_state
 191:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 522              		.loc 1 191 5 is_stmt 1 view .LVU146
 191:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 523              		.loc 1 191 9 is_stmt 0 view .LVU147
 524 0054 2146     		mov	r1, r4
ARM GAS  /tmp/ccdMdDsR.s 			page 14


 525 0056 0748     		ldr	r0, .L45+8
 526 0058 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 527              	.LVL25:
 191:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 528              		.loc 1 191 8 view .LVU148
 529 005c 0446     		mov	r4, r0
 530              	.LVL26:
 191:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 531              		.loc 1 191 8 view .LVU149
 532 005e 08B1     		cbz	r0, .L44
 192:Core/Src/z_qflash_W25QXXX.c ****     }
 533              		.loc 1 192 13 view .LVU150
 534 0060 0124     		movs	r4, #1
 535 0062 F4E7     		b	.L39
 536              	.L44:
 194:Core/Src/z_qflash_W25QXXX.c **** #else
 537              		.loc 1 194 2 is_stmt 1 view .LVU151
 538 0064 FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 539              	.LVL27:
 204:Core/Src/z_qflash_W25QXXX.c **** }
 540              		.loc 1 204 5 view .LVU152
 204:Core/Src/z_qflash_W25QXXX.c **** }
 541              		.loc 1 204 12 is_stmt 0 view .LVU153
 542 0068 F1E7     		b	.L39
 543              	.L46:
 544 006a 00BF     		.align	2
 545              	.L45:
 546 006c 00000000 		.word	.LANCHOR0
 547 0070 00000000 		.word	.LANCHOR1
 548 0074 00000000 		.word	hqspi
 549              		.cfi_endproc
 550              	.LFE150:
 552              		.section	.text.QFlash_ReadSFDP,"ax",%progbits
 553              		.align	1
 554              		.global	QFlash_ReadSFDP
 555              		.syntax unified
 556              		.thumb
 557              		.thumb_func
 558              		.fpu fpv5-d16
 560              	QFlash_ReadSFDP:
 561              	.LVL28:
 562              	.LFB151:
 206:Core/Src/z_qflash_W25QXXX.c **** 
 207:Core/Src/z_qflash_W25QXXX.c **** 
 208:Core/Src/z_qflash_W25QXXX.c **** 
 209:Core/Src/z_qflash_W25QXXX.c **** 
 210:Core/Src/z_qflash_W25QXXX.c **** /*********************************
 211:Core/Src/z_qflash_W25QXXX.c ****  * @RETURN	256byte SFDP register content:
 212:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 213:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadSFDP(uint8_t* dataptr) {
 563              		.loc 1 213 53 is_stmt 1 view -0
 564              		.cfi_startproc
 565              		@ args = 0, pretend = 0, frame = 56
 566              		@ frame_needed = 0, uses_anonymous_args = 0
 567              		.loc 1 213 53 is_stmt 0 view .LVU155
 568 0000 10B5     		push	{r4, lr}
 569              	.LCFI10:
ARM GAS  /tmp/ccdMdDsR.s 			page 15


 570              		.cfi_def_cfa_offset 8
 571              		.cfi_offset 4, -8
 572              		.cfi_offset 14, -4
 573 0002 8EB0     		sub	sp, sp, #56
 574              	.LCFI11:
 575              		.cfi_def_cfa_offset 64
 576 0004 0446     		mov	r4, r0
 214:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 577              		.loc 1 214 1 is_stmt 1 view .LVU156
 578              		.loc 1 214 21 is_stmt 0 view .LVU157
 579 0006 3822     		movs	r2, #56
 580 0008 0021     		movs	r1, #0
 581 000a 6846     		mov	r0, sp
 582              	.LVL29:
 583              		.loc 1 214 21 view .LVU158
 584 000c FFF7FEFF 		bl	memset
 585              	.LVL30:
 215:Core/Src/z_qflash_W25QXXX.c **** 
 216:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 586              		.loc 1 216 2 is_stmt 1 view .LVU159
 587 0010 6846     		mov	r0, sp
 588 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 589              	.LVL31:
 217:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_R_SFPD_REG;
 590              		.loc 1 217 2 view .LVU160
 591              		.loc 1 217 23 is_stmt 0 view .LVU161
 592 0016 5A23     		movs	r3, #90
 593 0018 0093     		str	r3, [sp]
 218:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
 594              		.loc 1 218 5 is_stmt 1 view .LVU162
 595              		.loc 1 218 25 is_stmt 0 view .LVU163
 596 001a 4FF08073 		mov	r3, #16777216
 597 001e 0993     		str	r3, [sp, #36]
 219:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_1_LINE;
 598              		.loc 1 219 5 is_stmt 1 view .LVU164
 599              		.loc 1 219 26 is_stmt 0 view .LVU165
 600 0020 4FF48063 		mov	r3, #1024
 601 0024 0793     		str	r3, [sp, #28]
 220:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressSize 	= QSPI_ADDRESS_24_BITS;
 602              		.loc 1 220 5 is_stmt 1 view .LVU166
 603              		.loc 1 220 27 is_stmt 0 view .LVU167
 604 0026 4FF40053 		mov	r3, #8192
 605 002a 0393     		str	r3, [sp, #12]
 221:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address		= 0;
 606              		.loc 1 221 5 is_stmt 1 view .LVU168
 607              		.loc 1 221 23 is_stmt 0 view .LVU169
 608 002c 0023     		movs	r3, #0
 609 002e 0193     		str	r3, [sp, #4]
 222:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 256;
 610              		.loc 1 222 5 is_stmt 1 view .LVU170
 611              		.loc 1 222 23 is_stmt 0 view .LVU171
 612 0030 4FF48073 		mov	r3, #256
 613 0034 0A93     		str	r3, [sp, #40]
 223:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 	= 8;
 614              		.loc 1 223 5 is_stmt 1 view .LVU172
 615              		.loc 1 223 27 is_stmt 0 view .LVU173
 616 0036 0823     		movs	r3, #8
ARM GAS  /tmp/ccdMdDsR.s 			page 16


 617 0038 0593     		str	r3, [sp, #20]
 224:Core/Src/z_qflash_W25QXXX.c **** 
 225:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 226:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 618              		.loc 1 226 2 is_stmt 1 view .LVU174
 619              	.L48:
 620              		.loc 1 226 26 discriminator 1 view .LVU175
 621              		.loc 1 226 8 discriminator 1 view .LVU176
 622              		.loc 1 226 9 is_stmt 0 discriminator 1 view .LVU177
 623 003a 0F4B     		ldr	r3, .L55
 624 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 625              		.loc 1 226 8 discriminator 1 view .LVU178
 626 003e 002B     		cmp	r3, #0
 627 0040 FBD0     		beq	.L48
 628              		.loc 1 226 27 is_stmt 1 discriminator 2 view .LVU179
 227:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 629              		.loc 1 227 2 discriminator 2 view .LVU180
 630              		.loc 1 227 15 is_stmt 0 discriminator 2 view .LVU181
 631 0042 0023     		movs	r3, #0
 632 0044 0C4A     		ldr	r2, .L55
 633 0046 1370     		strb	r3, [r2]
 228:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0; 	//set data requested unavailable yet
 634              		.loc 1 228 2 is_stmt 1 discriminator 2 view .LVU182
 635              		.loc 1 228 23 is_stmt 0 discriminator 2 view .LVU183
 636 0048 0C4A     		ldr	r2, .L55+4
 637 004a 1370     		strb	r3, [r2]
 229:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 638              		.loc 1 229 5 is_stmt 1 discriminator 2 view .LVU184
 639              		.loc 1 229 9 is_stmt 0 discriminator 2 view .LVU185
 640 004c 41F28832 		movw	r2, #5000
 641 0050 6946     		mov	r1, sp
 642 0052 0B48     		ldr	r0, .L55+8
 643 0054 FFF7FEFF 		bl	HAL_QSPI_Command
 644              	.LVL32:
 645              		.loc 1 229 8 discriminator 2 view .LVU186
 646 0058 18B1     		cbz	r0, .L53
 230:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 647              		.loc 1 230 16 view .LVU187
 648 005a 0124     		movs	r4, #1
 649              	.LVL33:
 650              	.L49:
 231:Core/Src/z_qflash_W25QXXX.c ****     }
 232:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 233:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 234:Core/Src/z_qflash_W25QXXX.c ****     }
 235:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
 236:Core/Src/z_qflash_W25QXXX.c **** #else
 237:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 238:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 239:Core/Src/z_qflash_W25QXXX.c ****     }
 240:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
 241:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 242:Core/Src/z_qflash_W25QXXX.c ****     }
 243:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 244:Core/Src/z_qflash_W25QXXX.c **** 
 245:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 246:Core/Src/z_qflash_W25QXXX.c **** }
ARM GAS  /tmp/ccdMdDsR.s 			page 17


 651              		.loc 1 246 1 view .LVU188
 652 005c 2046     		mov	r0, r4
 653 005e 0EB0     		add	sp, sp, #56
 654              	.LCFI12:
 655              		.cfi_remember_state
 656              		.cfi_def_cfa_offset 8
 657              		@ sp needed
 658 0060 10BD     		pop	{r4, pc}
 659              	.LVL34:
 660              	.L53:
 661              	.LCFI13:
 662              		.cfi_restore_state
 232:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 663              		.loc 1 232 5 is_stmt 1 view .LVU189
 232:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 664              		.loc 1 232 9 is_stmt 0 view .LVU190
 665 0062 2146     		mov	r1, r4
 666 0064 0648     		ldr	r0, .L55+8
 667 0066 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 668              	.LVL35:
 232:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 669              		.loc 1 232 8 view .LVU191
 670 006a 0446     		mov	r4, r0
 671              	.LVL36:
 232:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 672              		.loc 1 232 8 view .LVU192
 673 006c 08B1     		cbz	r0, .L54
 233:Core/Src/z_qflash_W25QXXX.c ****     }
 674              		.loc 1 233 13 view .LVU193
 675 006e 0124     		movs	r4, #1
 676 0070 F4E7     		b	.L49
 677              	.L54:
 235:Core/Src/z_qflash_W25QXXX.c **** #else
 678              		.loc 1 235 2 is_stmt 1 view .LVU194
 679 0072 FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 680              	.LVL37:
 245:Core/Src/z_qflash_W25QXXX.c **** }
 681              		.loc 1 245 2 view .LVU195
 245:Core/Src/z_qflash_W25QXXX.c **** }
 682              		.loc 1 245 9 is_stmt 0 view .LVU196
 683 0076 F1E7     		b	.L49
 684              	.L56:
 685              		.align	2
 686              	.L55:
 687 0078 00000000 		.word	.LANCHOR0
 688 007c 00000000 		.word	.LANCHOR1
 689 0080 00000000 		.word	hqspi
 690              		.cfi_endproc
 691              	.LFE151:
 693              		.section	.text.QFlash_Init,"ax",%progbits
 694              		.align	1
 695              		.global	QFlash_Init
 696              		.syntax unified
 697              		.thumb
 698              		.thumb_func
 699              		.fpu fpv5-d16
 701              	QFlash_Init:
ARM GAS  /tmp/ccdMdDsR.s 			page 18


 702              	.LFB152:
 247:Core/Src/z_qflash_W25QXXX.c **** 
 248:Core/Src/z_qflash_W25QXXX.c **** 
 249:Core/Src/z_qflash_W25QXXX.c **** 
 250:Core/Src/z_qflash_W25QXXX.c **** 
 251:Core/Src/z_qflash_W25QXXX.c **** /******************************************************************
 252:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	reset memory chip, then
 253:Core/Src/z_qflash_W25QXXX.c ****  * 			read manufacutrer and device ID
 254:Core/Src/z_qflash_W25QXXX.c ****  * 			checking if the connected device is a Winbond Flash
 255:Core/Src/z_qflash_W25QXXX.c ****  ******************************************************************/
 256:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_Init(){
 703              		.loc 1 256 32 is_stmt 1 view -0
 704              		.cfi_startproc
 705              		@ args = 0, pretend = 0, frame = 256
 706              		@ frame_needed = 0, uses_anonymous_args = 0
 707 0000 00B5     		push	{lr}
 708              	.LCFI14:
 709              		.cfi_def_cfa_offset 4
 710              		.cfi_offset 14, -4
 711 0002 C1B0     		sub	sp, sp, #260
 712              	.LCFI15:
 713              		.cfi_def_cfa_offset 264
 257:Core/Src/z_qflash_W25QXXX.c **** uint8_t data[256];
 714              		.loc 1 257 1 view .LVU198
 258:Core/Src/z_qflash_W25QXXX.c **** 
 259:Core/Src/z_qflash_W25QXXX.c **** 	HAL_Delay(6);	// supposing init is called on system startup: 5 ms (tPUW) required after power-up t
 715              		.loc 1 259 2 view .LVU199
 716 0004 0620     		movs	r0, #6
 717 0006 FFF7FEFF 		bl	HAL_Delay
 718              	.LVL38:
 260:Core/Src/z_qflash_W25QXXX.c **** 
 261:Core/Src/z_qflash_W25QXXX.c **** // reset the device (supposing it is a W25Q)
 262:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_Reset()!=HAL_OK)
 719              		.loc 1 262 2 view .LVU200
 720              		.loc 1 262 6 is_stmt 0 view .LVU201
 721 000a FFF7FEFF 		bl	QFlash_Reset
 722              	.LVL39:
 723              		.loc 1 262 5 view .LVU202
 724 000e 0346     		mov	r3, r0
 725 0010 40B1     		cbz	r0, .L59
 263:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 726              		.loc 1 263 10 view .LVU203
 727 0012 0120     		movs	r0, #1
 728              	.L58:
 264:Core/Src/z_qflash_W25QXXX.c **** 
 265:Core/Src/z_qflash_W25QXXX.c **** // testing if an SFPD device is connected and working
 266:Core/Src/z_qflash_W25QXXX.c **** 	for (uint8_t k=0;k!=3;k++)
 267:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 268:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_ReadSFDP(data))
 269:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 270:Core/Src/z_qflash_W25QXXX.c **** 	if (!((data[0]=='S') && (data[1]=='F') && (data[2]=='D') && (data[3]=='P')))
 271:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 272:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 273:Core/Src/z_qflash_W25QXXX.c **** 
 274:Core/Src/z_qflash_W25QXXX.c **** //testing if it is a Winbond memory
 275:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_ReadJedecID(data)) //select the memSize byte
 276:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;;
ARM GAS  /tmp/ccdMdDsR.s 			page 19


 277:Core/Src/z_qflash_W25QXXX.c **** 	if (data[0] != 0xEF)  // if ManufacturerID is not Winbond (0xEF)
 278:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 279:Core/Src/z_qflash_W25QXXX.c **** 
 280:Core/Src/z_qflash_W25QXXX.c **** 
 281:Core/Src/z_qflash_W25QXXX.c **** #ifdef FLASH_QSPI_MEMORY_MAPPED
 282:Core/Src/z_qflash_W25QXXX.c **** // reset and tests are OK: enable memory mapped mode
 283:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_EnableMemoryMappedMode()==HAL_ERROR)
 284:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 285:Core/Src/z_qflash_W25QXXX.c **** #endif //FLASH_QSPI_MEMORY_MAPPED
 286:Core/Src/z_qflash_W25QXXX.c **** 
 287:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;  //return memSize as per table in Flash_ReadJedecID() definition
 288:Core/Src/z_qflash_W25QXXX.c **** }
 729              		.loc 1 288 1 view .LVU204
 730 0014 41B0     		add	sp, sp, #260
 731              	.LCFI16:
 732              		.cfi_remember_state
 733              		.cfi_def_cfa_offset 4
 734              		@ sp needed
 735 0016 5DF804FB 		ldr	pc, [sp], #4
 736              	.LVL40:
 737              	.L60:
 738              	.LCFI17:
 739              		.cfi_restore_state
 740              	.LBB2:
 267:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_ReadSFDP(data))
 741              		.loc 1 267 5 is_stmt 1 discriminator 3 view .LVU205
 267:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_ReadSFDP(data))
 742              		.loc 1 267 12 is_stmt 0 discriminator 3 view .LVU206
 743 001a FF22     		movs	r2, #255
 744 001c 0DF80320 		strb	r2, [sp, r3]
 266:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 745              		.loc 1 266 24 is_stmt 1 discriminator 3 view .LVU207
 266:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 746              		.loc 1 266 25 is_stmt 0 discriminator 3 view .LVU208
 747 0020 0133     		adds	r3, r3, #1
 748              	.LVL41:
 266:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 749              		.loc 1 266 25 discriminator 3 view .LVU209
 750 0022 DBB2     		uxtb	r3, r3
 751              	.LVL42:
 752              	.L59:
 266:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 753              		.loc 1 266 19 is_stmt 1 discriminator 1 view .LVU210
 266:Core/Src/z_qflash_W25QXXX.c **** 		  data[k]=0xFF;
 754              		.loc 1 266 2 is_stmt 0 discriminator 1 view .LVU211
 755 0024 032B     		cmp	r3, #3
 756 0026 F8D1     		bne	.L60
 757              	.LBE2:
 268:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 758              		.loc 1 268 2 is_stmt 1 view .LVU212
 268:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 759              		.loc 1 268 6 is_stmt 0 view .LVU213
 760 0028 6846     		mov	r0, sp
 761 002a FFF7FEFF 		bl	QFlash_ReadSFDP
 762              	.LVL43:
 268:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 763              		.loc 1 268 5 view .LVU214
ARM GAS  /tmp/ccdMdDsR.s 			page 20


 764 002e 40BB     		cbnz	r0, .L64
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 765              		.loc 1 270 2 is_stmt 1 view .LVU215
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 766              		.loc 1 270 13 is_stmt 0 view .LVU216
 767 0030 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 768              		.loc 1 270 5 view .LVU217
 769 0034 532B     		cmp	r3, #83
 770 0036 17D0     		beq	.L72
 771              	.L61:
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 772              		.loc 1 271 3 is_stmt 1 view .LVU218
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 773              		.loc 1 271 6 is_stmt 0 view .LVU219
 774 0038 532B     		cmp	r3, #83
 775 003a 24D1     		bne	.L65
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 776              		.loc 1 271 32 discriminator 1 view .LVU220
 777 003c 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 778              		.loc 1 271 24 discriminator 1 view .LVU221
 779 0040 462B     		cmp	r3, #70
 780 0042 22D1     		bne	.L66
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 781              		.loc 1 271 50 discriminator 2 view .LVU222
 782 0044 9DF80530 		ldrb	r3, [sp, #5]	@ zero_extendqisi2
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 783              		.loc 1 271 42 discriminator 2 view .LVU223
 784 0048 442B     		cmp	r3, #68
 785 004a 20D1     		bne	.L67
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 786              		.loc 1 271 68 discriminator 3 view .LVU224
 787 004c 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 271:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 788              		.loc 1 271 7 discriminator 3 view .LVU225
 789 0050 502B     		cmp	r3, #80
 790 0052 1ED1     		bne	.L68
 791              	.L62:
 275:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;;
 792              		.loc 1 275 2 is_stmt 1 view .LVU226
 275:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;;
 793              		.loc 1 275 6 is_stmt 0 view .LVU227
 794 0054 6846     		mov	r0, sp
 795 0056 FFF7FEFF 		bl	QFlash_ReadJedecID
 796              	.LVL44:
 275:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;;
 797              		.loc 1 275 5 view .LVU228
 798 005a E0B9     		cbnz	r0, .L69
 276:Core/Src/z_qflash_W25QXXX.c **** 	if (data[0] != 0xEF)  // if ManufacturerID is not Winbond (0xEF)
 799              		.loc 1 276 20 is_stmt 1 view .LVU229
 277:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 800              		.loc 1 277 2 view .LVU230
 277:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 801              		.loc 1 277 10 is_stmt 0 view .LVU231
 802 005c 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 277:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
ARM GAS  /tmp/ccdMdDsR.s 			page 21


 803              		.loc 1 277 5 view .LVU232
 804 0060 EF2B     		cmp	r3, #239
 805 0062 D7D0     		beq	.L58
 278:Core/Src/z_qflash_W25QXXX.c **** 
 806              		.loc 1 278 10 view .LVU233
 807 0064 0120     		movs	r0, #1
 808 0066 D5E7     		b	.L58
 809              	.L72:
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 810              		.loc 1 270 31 discriminator 1 view .LVU234
 811 0068 9DF80120 		ldrb	r2, [sp, #1]	@ zero_extendqisi2
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 812              		.loc 1 270 23 discriminator 1 view .LVU235
 813 006c 462A     		cmp	r2, #70
 814 006e E3D1     		bne	.L61
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 815              		.loc 1 270 49 discriminator 2 view .LVU236
 816 0070 9DF80220 		ldrb	r2, [sp, #2]	@ zero_extendqisi2
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 817              		.loc 1 270 41 discriminator 2 view .LVU237
 818 0074 442A     		cmp	r2, #68
 819 0076 DFD1     		bne	.L61
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 820              		.loc 1 270 67 discriminator 3 view .LVU238
 821 0078 9DF80320 		ldrb	r2, [sp, #3]	@ zero_extendqisi2
 270:Core/Src/z_qflash_W25QXXX.c **** 		if (!((data[0]=='S') && (data[2]=='F') && (data[5]=='D') && (data[7]=='P')))  //this is in case o
 822              		.loc 1 270 6 discriminator 3 view .LVU239
 823 007c 502A     		cmp	r2, #80
 824 007e DBD1     		bne	.L61
 825 0080 E8E7     		b	.L62
 826              	.L64:
 269:Core/Src/z_qflash_W25QXXX.c **** 	if (!((data[0]=='S') && (data[1]=='F') && (data[2]=='D') && (data[3]=='P')))
 827              		.loc 1 269 10 view .LVU240
 828 0082 0120     		movs	r0, #1
 829 0084 C6E7     		b	.L58
 830              	.L65:
 272:Core/Src/z_qflash_W25QXXX.c **** 
 831              		.loc 1 272 11 view .LVU241
 832 0086 0120     		movs	r0, #1
 833 0088 C4E7     		b	.L58
 834              	.L66:
 835 008a 0120     		movs	r0, #1
 836 008c C2E7     		b	.L58
 837              	.L67:
 838 008e 0120     		movs	r0, #1
 839 0090 C0E7     		b	.L58
 840              	.L68:
 841 0092 0120     		movs	r0, #1
 842 0094 BEE7     		b	.L58
 843              	.L69:
 276:Core/Src/z_qflash_W25QXXX.c **** 	if (data[0] != 0xEF)  // if ManufacturerID is not Winbond (0xEF)
 844              		.loc 1 276 10 view .LVU242
 845 0096 0120     		movs	r0, #1
 846 0098 BCE7     		b	.L58
 847              		.cfi_endproc
 848              	.LFE152:
 850              		.section	.text.QFlash_Read,"ax",%progbits
ARM GAS  /tmp/ccdMdDsR.s 			page 22


 851              		.align	1
 852              		.global	QFlash_Read
 853              		.syntax unified
 854              		.thumb
 855              		.thumb_func
 856              		.fpu fpv5-d16
 858              	QFlash_Read:
 859              	.LVL45:
 860              	.LFB153:
 289:Core/Src/z_qflash_W25QXXX.c **** 
 290:Core/Src/z_qflash_W25QXXX.c **** 
 291:Core/Src/z_qflash_W25QXXX.c **** 
 292:Core/Src/z_qflash_W25QXXX.c **** 
 293:Core/Src/z_qflash_W25QXXX.c **** #ifdef FLASH_QSPI_MEMORY_MAPPED
 294:Core/Src/z_qflash_W25QXXX.c **** 
 295:Core/Src/z_qflash_W25QXXX.c **** 
 296:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_EnableMemoryMappedMode(void) {
 297:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 298:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_MemoryMappedTypeDef sMemMappedCfg = {0};
 299:Core/Src/z_qflash_W25QXXX.c **** 
 300:Core/Src/z_qflash_W25QXXX.c **** 	// Setup reading command
 301:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 302:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction		= QFLASH_READ_COMMAND;
 303:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DummyCycles 		= QFLASH_READ_DUMMYC;
 304:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytes     = QFLASH_ALT_BYTES;
 305:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytesSize = QFLASH_ALT_BYTES_S;
 306:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateByteMode  = QFLASH_ALT_BYTES_M;
 307:Core/Src/z_qflash_W25QXXX.c **** 
 308:Core/Src/z_qflash_W25QXXX.c **** 	// Set memory-mapped mode CS and prefetch handling:
 309:Core/Src/z_qflash_W25QXXX.c **** 	// timeout disabled: prefetch and CS always active
 310:Core/Src/z_qflash_W25QXXX.c **** 	sMemMappedCfg.TimeOutActivation = QSPI_TIMEOUT_COUNTER_DISABLE;
 311:Core/Src/z_qflash_W25QXXX.c **** /*
 312:Core/Src/z_qflash_W25QXXX.c **** 	// Set memory-mapped mode CS and prefetch handling
 313:Core/Src/z_qflash_W25QXXX.c **** 	// timeout enabled: prefetch and CS disabled after 4 SPI clock cycles
 314:Core/Src/z_qflash_W25QXXX.c **** 	sMemMappedCfg.TimeOutActivation = QSPI_TIMEOUT_COUNTER_ENABLE;
 315:Core/Src/z_qflash_W25QXXX.c **** 	sMemMappedCfg.TimeOutPeriod=4;
 316:Core/Src/z_qflash_W25QXXX.c **** */
 317:Core/Src/z_qflash_W25QXXX.c **** 
 318:Core/Src/z_qflash_W25QXXX.c **** 
 319:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 320:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 321:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 322:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_MemoryMapped(&FLASH_QSPI_PORT, &sCommand, &sMemMappedCfg) != HAL_OK) {
 323:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 324:Core/Src/z_qflash_W25QXXX.c **** 	}
 325:Core/Src/z_qflash_W25QXXX.c **** 
 326:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 327:Core/Src/z_qflash_W25QXXX.c **** }
 328:Core/Src/z_qflash_W25QXXX.c **** 
 329:Core/Src/z_qflash_W25QXXX.c **** #else
 330:Core/Src/z_qflash_W25QXXX.c **** 
 331:Core/Src/z_qflash_W25QXXX.c **** 
 332:Core/Src/z_qflash_W25QXXX.c **** /**************************
 333:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	reads from Flash Eeprom
 334:Core/Src/z_qflash_W25QXXX.c ****  * 			using "communication mode" selected by
 335:Core/Src/z_qflash_W25QXXX.c ****  * 			command doesn't check for the BUSY flag in SR1
 336:Core/Src/z_qflash_W25QXXX.c ****  * 			that must be done before calling this function
ARM GAS  /tmp/ccdMdDsR.s 			page 23


 337:Core/Src/z_qflash_W25QXXX.c ****  * 			current version of library doesn't need it
 338:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr		EEPROM address to start reading
 339:Core/Src/z_qflash_W25QXXX.c ****  *  		data		buffer to fill with read data
 340:Core/Src/z_qflash_W25QXXX.c ****  * 			dataSize	number of bytes to read
 341:Core/Src/z_qflash_W25QXXX.c ****  **************************/
 342:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_Read(uint32_t address,  uint8_t* buffer, uint32_t dataSize) {
 861              		.loc 1 342 86 is_stmt 1 view -0
 862              		.cfi_startproc
 863              		@ args = 0, pretend = 0, frame = 56
 864              		@ frame_needed = 0, uses_anonymous_args = 0
 865              		.loc 1 342 86 is_stmt 0 view .LVU244
 866 0000 70B5     		push	{r4, r5, r6, lr}
 867              	.LCFI18:
 868              		.cfi_def_cfa_offset 16
 869              		.cfi_offset 4, -16
 870              		.cfi_offset 5, -12
 871              		.cfi_offset 6, -8
 872              		.cfi_offset 14, -4
 873 0002 8EB0     		sub	sp, sp, #56
 874              	.LCFI19:
 875              		.cfi_def_cfa_offset 72
 876 0004 0546     		mov	r5, r0
 877 0006 0E46     		mov	r6, r1
 878 0008 1446     		mov	r4, r2
 343:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 879              		.loc 1 343 1 is_stmt 1 view .LVU245
 880              		.loc 1 343 21 is_stmt 0 view .LVU246
 881 000a 3822     		movs	r2, #56
 882              	.LVL46:
 883              		.loc 1 343 21 view .LVU247
 884 000c 0021     		movs	r1, #0
 885              	.LVL47:
 886              		.loc 1 343 21 view .LVU248
 887 000e 6846     		mov	r0, sp
 888              	.LVL48:
 889              		.loc 1 343 21 view .LVU249
 890 0010 FFF7FEFF 		bl	memset
 891              	.LVL49:
 344:Core/Src/z_qflash_W25QXXX.c **** 
 345:Core/Src/z_qflash_W25QXXX.c **** 	if (dataSize==0)
 892              		.loc 1 345 2 is_stmt 1 view .LVU250
 893              		.loc 1 345 5 is_stmt 0 view .LVU251
 894 0014 14B9     		cbnz	r4, .L80
 346:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_OK;
 895              		.loc 1 346 10 view .LVU252
 896 0016 0020     		movs	r0, #0
 897              	.L74:
 347:Core/Src/z_qflash_W25QXXX.c **** 
 348:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 349:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Instruction		= QFLASH_READ_COMMAND;
 350:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address			= address;
 351:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData				= dataSize;
 352:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 		= QFLASH_READ_DUMMYC;
 353:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytes     = QFLASH_ALT_BYTES;
 354:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytesSize = QFLASH_ALT_BYTES_S;
 355:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateByteMode  = QFLASH_ALT_BYTES_M;
 356:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 24


 357:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 358:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 359:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 360:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 361:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 362:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 363:Core/Src/z_qflash_W25QXXX.c ****     }
 364:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, buffer) != HAL_OK) { // Receive data
 365:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 366:Core/Src/z_qflash_W25QXXX.c ****     }
 367:Core/Src/z_qflash_W25QXXX.c **** #ifdef FLASH_QSPI_WAIT_FOR_READING_COMPLETE
 368:Core/Src/z_qflash_W25QXXX.c ****     QFlash_WaitForDataAvailable(0);
 369:Core/Src/z_qflash_W25QXXX.c **** #endif //FLASH_QSPI_WAIT_FOR_READING_COMPLETED
 370:Core/Src/z_qflash_W25QXXX.c **** 
 371:Core/Src/z_qflash_W25QXXX.c **** #else
 372:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 373:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 374:Core/Src/z_qflash_W25QXXX.c ****     }
 375:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, buffer, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive data
 376:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 377:Core/Src/z_qflash_W25QXXX.c ****     }
 378:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 379:Core/Src/z_qflash_W25QXXX.c **** 
 380:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 381:Core/Src/z_qflash_W25QXXX.c **** }
 898              		.loc 1 381 1 view .LVU253
 899 0018 0EB0     		add	sp, sp, #56
 900              	.LCFI20:
 901              		.cfi_remember_state
 902              		.cfi_def_cfa_offset 16
 903              		@ sp needed
 904 001a 70BD     		pop	{r4, r5, r6, pc}
 905              	.LVL50:
 906              	.L80:
 907              	.LCFI21:
 908              		.cfi_restore_state
 348:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Instruction		= QFLASH_READ_COMMAND;
 909              		.loc 1 348 2 is_stmt 1 view .LVU254
 910 001c 6846     		mov	r0, sp
 911 001e FFF7FEFF 		bl	QFlash_DefaultCmd
 912              	.LVL51:
 349:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address			= address;
 913              		.loc 1 349 5 view .LVU255
 349:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address			= address;
 914              		.loc 1 349 27 is_stmt 0 view .LVU256
 915 0022 EB23     		movs	r3, #235
 916 0024 0093     		str	r3, [sp]
 350:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData				= dataSize;
 917              		.loc 1 350 5 is_stmt 1 view .LVU257
 350:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData				= dataSize;
 918              		.loc 1 350 24 is_stmt 0 view .LVU258
 919 0026 0195     		str	r5, [sp, #4]
 351:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 		= QFLASH_READ_DUMMYC;
 920              		.loc 1 351 5 is_stmt 1 view .LVU259
 351:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 		= QFLASH_READ_DUMMYC;
 921              		.loc 1 351 24 is_stmt 0 view .LVU260
 922 0028 0A94     		str	r4, [sp, #40]
ARM GAS  /tmp/ccdMdDsR.s 			page 25


 352:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytes     = QFLASH_ALT_BYTES;
 923              		.loc 1 352 5 is_stmt 1 view .LVU261
 352:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytes     = QFLASH_ALT_BYTES;
 924              		.loc 1 352 28 is_stmt 0 view .LVU262
 925 002a 0423     		movs	r3, #4
 926 002c 0593     		str	r3, [sp, #20]
 353:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytesSize = QFLASH_ALT_BYTES_S;
 927              		.loc 1 353 5 is_stmt 1 view .LVU263
 353:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateBytesSize = QFLASH_ALT_BYTES_S;
 928              		.loc 1 353 33 is_stmt 0 view .LVU264
 929 002e FF23     		movs	r3, #255
 930 0030 0293     		str	r3, [sp, #8]
 354:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateByteMode  = QFLASH_ALT_BYTES_M;
 931              		.loc 1 354 5 is_stmt 1 view .LVU265
 354:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AlternateByteMode  = QFLASH_ALT_BYTES_M;
 932              		.loc 1 354 33 is_stmt 0 view .LVU266
 933 0032 0023     		movs	r3, #0
 934 0034 0493     		str	r3, [sp, #16]
 355:Core/Src/z_qflash_W25QXXX.c **** 
 935              		.loc 1 355 5 is_stmt 1 view .LVU267
 355:Core/Src/z_qflash_W25QXXX.c **** 
 936              		.loc 1 355 33 is_stmt 0 view .LVU268
 937 0036 4FF44043 		mov	r3, #49152
 938 003a 0893     		str	r3, [sp, #32]
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 939              		.loc 1 358 2 is_stmt 1 view .LVU269
 940              	.L75:
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 941              		.loc 1 358 26 discriminator 1 view .LVU270
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 942              		.loc 1 358 8 discriminator 1 view .LVU271
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 943              		.loc 1 358 9 is_stmt 0 discriminator 1 view .LVU272
 944 003c 0C4B     		ldr	r3, .L82
 945 003e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 946              		.loc 1 358 8 discriminator 1 view .LVU273
 947 0040 002B     		cmp	r3, #0
 948 0042 FBD0     		beq	.L75
 358:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 949              		.loc 1 358 27 is_stmt 1 discriminator 2 view .LVU274
 359:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 950              		.loc 1 359 2 discriminator 2 view .LVU275
 359:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 951              		.loc 1 359 15 is_stmt 0 discriminator 2 view .LVU276
 952 0044 0023     		movs	r3, #0
 953 0046 0A4A     		ldr	r2, .L82
 954 0048 1370     		strb	r3, [r2]
 360:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 955              		.loc 1 360 2 is_stmt 1 discriminator 2 view .LVU277
 360:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 956              		.loc 1 360 23 is_stmt 0 discriminator 2 view .LVU278
 957 004a 0A4A     		ldr	r2, .L82+4
 958 004c 1370     		strb	r3, [r2]
 361:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 959              		.loc 1 361 5 is_stmt 1 discriminator 2 view .LVU279
 361:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
ARM GAS  /tmp/ccdMdDsR.s 			page 26


 960              		.loc 1 361 9 is_stmt 0 discriminator 2 view .LVU280
 961 004e 41F28832 		movw	r2, #5000
 962 0052 6946     		mov	r1, sp
 963 0054 0848     		ldr	r0, .L82+8
 964 0056 FFF7FEFF 		bl	HAL_QSPI_Command
 965              	.LVL52:
 361:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 966              		.loc 1 361 8 discriminator 2 view .LVU281
 967 005a 08B1     		cbz	r0, .L81
 362:Core/Src/z_qflash_W25QXXX.c ****     }
 968              		.loc 1 362 16 view .LVU282
 969 005c 0120     		movs	r0, #1
 970 005e DBE7     		b	.L74
 971              	.L81:
 364:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 972              		.loc 1 364 5 is_stmt 1 view .LVU283
 364:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 973              		.loc 1 364 9 is_stmt 0 view .LVU284
 974 0060 3146     		mov	r1, r6
 975 0062 0548     		ldr	r0, .L82+8
 976 0064 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 977              	.LVL53:
 364:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 978              		.loc 1 364 8 view .LVU285
 979 0068 0028     		cmp	r0, #0
 980 006a D5D0     		beq	.L74
 365:Core/Src/z_qflash_W25QXXX.c ****     }
 981              		.loc 1 365 13 view .LVU286
 982 006c 0120     		movs	r0, #1
 983 006e D3E7     		b	.L74
 984              	.L83:
 985              		.align	2
 986              	.L82:
 987 0070 00000000 		.word	.LANCHOR0
 988 0074 00000000 		.word	.LANCHOR1
 989 0078 00000000 		.word	hqspi
 990              		.cfi_endproc
 991              	.LFE153:
 993              		.section	.text.QFlash_WriteEnable,"ax",%progbits
 994              		.align	1
 995              		.global	QFlash_WriteEnable
 996              		.syntax unified
 997              		.thumb
 998              		.thumb_func
 999              		.fpu fpv5-d16
 1001              	QFlash_WriteEnable:
 1002              	.LFB154:
 382:Core/Src/z_qflash_W25QXXX.c **** 
 383:Core/Src/z_qflash_W25QXXX.c **** 
 384:Core/Src/z_qflash_W25QXXX.c **** 
 385:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WriteEnable(){
 1003              		.loc 1 385 39 is_stmt 1 view -0
 1004              		.cfi_startproc
 1005              		@ args = 0, pretend = 0, frame = 56
 1006              		@ frame_needed = 0, uses_anonymous_args = 0
 1007 0000 00B5     		push	{lr}
 1008              	.LCFI22:
ARM GAS  /tmp/ccdMdDsR.s 			page 27


 1009              		.cfi_def_cfa_offset 4
 1010              		.cfi_offset 14, -4
 1011 0002 8FB0     		sub	sp, sp, #60
 1012              	.LCFI23:
 1013              		.cfi_def_cfa_offset 64
 386:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 1014              		.loc 1 386 1 view .LVU288
 1015              		.loc 1 386 21 is_stmt 0 view .LVU289
 1016 0004 3822     		movs	r2, #56
 1017 0006 0021     		movs	r1, #0
 1018 0008 6846     		mov	r0, sp
 1019 000a FFF7FEFF 		bl	memset
 1020              	.LVL54:
 387:Core/Src/z_qflash_W25QXXX.c **** 
 388:Core/Src/z_qflash_W25QXXX.c **** 
 389:Core/Src/z_qflash_W25QXXX.c **** //Send a "Write Enable" command
 390:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 1021              		.loc 1 390 2 is_stmt 1 view .LVU290
 1022 000e 6846     		mov	r0, sp
 1023 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 1024              	.LVL55:
 391:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_ENABLE;
 1025              		.loc 1 391 2 view .LVU291
 1026              		.loc 1 391 23 is_stmt 0 view .LVU292
 1027 0014 0623     		movs	r3, #6
 1028 0016 0093     		str	r3, [sp]
 392:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_NONE;
 1029              		.loc 1 392 2 is_stmt 1 view .LVU293
 1030              		.loc 1 392 22 is_stmt 0 view .LVU294
 1031 0018 0023     		movs	r3, #0
 1032 001a 0993     		str	r3, [sp, #36]
 393:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1033              		.loc 1 393 2 is_stmt 1 view .LVU295
 1034              		.loc 1 393 23 is_stmt 0 view .LVU296
 1035 001c 0793     		str	r3, [sp, #28]
 394:Core/Src/z_qflash_W25QXXX.c **** 
 395:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 396:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1036              		.loc 1 396 2 is_stmt 1 view .LVU297
 1037              	.L85:
 1038              		.loc 1 396 26 discriminator 1 view .LVU298
 1039              		.loc 1 396 8 discriminator 1 view .LVU299
 1040              		.loc 1 396 9 is_stmt 0 discriminator 1 view .LVU300
 1041 001e 084B     		ldr	r3, .L90
 1042 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1043              		.loc 1 396 8 discriminator 1 view .LVU301
 1044 0022 002B     		cmp	r3, #0
 1045 0024 FBD0     		beq	.L85
 1046              		.loc 1 396 27 is_stmt 1 discriminator 2 view .LVU302
 397:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 398:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 1047              		.loc 1 398 2 discriminator 2 view .LVU303
 1048              		.loc 1 398 6 is_stmt 0 discriminator 2 view .LVU304
 1049 0026 41F28832 		movw	r2, #5000
 1050 002a 6946     		mov	r1, sp
 1051 002c 0548     		ldr	r0, .L90+4
 1052 002e FFF7FEFF 		bl	HAL_QSPI_Command
ARM GAS  /tmp/ccdMdDsR.s 			page 28


 1053              	.LVL56:
 1054              		.loc 1 398 5 discriminator 2 view .LVU305
 1055 0032 10B9     		cbnz	r0, .L89
 1056              	.L86:
 399:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 400:Core/Src/z_qflash_W25QXXX.c **** 	}
 401:Core/Src/z_qflash_W25QXXX.c **** 
 402:Core/Src/z_qflash_W25QXXX.c **** /*
 403:Core/Src/z_qflash_W25QXXX.c **** //Wait for Write Enable bit set
 404:Core/Src/z_qflash_W25QXXX.c **** 
 405:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_AutoPollingTypeDef sConfig;
 406:Core/Src/z_qflash_W25QXXX.c **** 
 407:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 408:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction = W25_R_SR1;
 409:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode = QSPI_DATA_1_LINE;
 410:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode = QSPI_ADDRESS_NONE;
 411:Core/Src/z_qflash_W25QXXX.c **** 
 412:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.Mask = SR1_BIT_WEL;
 413:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.Match = 2;
 414:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.MatchMode = QSPI_MATCH_MODE_AND;
 415:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.StatusBytesSize = 1;
 416:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.Interval = 0x10;
 417:Core/Src/z_qflash_W25QXXX.c **** 	sConfig.AutomaticStop = QSPI_AUTOMATIC_STOP_ENABLE;
 418:Core/Src/z_qflash_W25QXXX.c **** 
 419:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_AutoPolling(&FLASH_QSPI_PORT, &sCommand, &sConfig, QFLASH_BSY_TIMEOUT) != HAL_OK) {
 420:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 421:Core/Src/z_qflash_W25QXXX.c **** 	}
 422:Core/Src/z_qflash_W25QXXX.c **** */
 423:Core/Src/z_qflash_W25QXXX.c **** 
 424:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 425:Core/Src/z_qflash_W25QXXX.c **** 
 426:Core/Src/z_qflash_W25QXXX.c **** }
 1057              		.loc 1 426 1 view .LVU306
 1058 0034 0FB0     		add	sp, sp, #60
 1059              	.LCFI24:
 1060              		.cfi_remember_state
 1061              		.cfi_def_cfa_offset 4
 1062              		@ sp needed
 1063 0036 5DF804FB 		ldr	pc, [sp], #4
 1064              	.L89:
 1065              	.LCFI25:
 1066              		.cfi_restore_state
 399:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1067              		.loc 1 399 10 view .LVU307
 1068 003a 0120     		movs	r0, #1
 1069 003c FAE7     		b	.L86
 1070              	.L91:
 1071 003e 00BF     		.align	2
 1072              	.L90:
 1073 0040 00000000 		.word	.LANCHOR0
 1074 0044 00000000 		.word	hqspi
 1075              		.cfi_endproc
 1076              	.LFE154:
 1078              		.section	.text.QFlash_WriteDisable,"ax",%progbits
 1079              		.align	1
 1080              		.global	QFlash_WriteDisable
 1081              		.syntax unified
ARM GAS  /tmp/ccdMdDsR.s 			page 29


 1082              		.thumb
 1083              		.thumb_func
 1084              		.fpu fpv5-d16
 1086              	QFlash_WriteDisable:
 1087              	.LFB155:
 427:Core/Src/z_qflash_W25QXXX.c **** 
 428:Core/Src/z_qflash_W25QXXX.c **** 
 429:Core/Src/z_qflash_W25QXXX.c **** 
 430:Core/Src/z_qflash_W25QXXX.c **** 
 431:Core/Src/z_qflash_W25QXXX.c **** 
 432:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WriteDisable(){
 1088              		.loc 1 432 40 is_stmt 1 view -0
 1089              		.cfi_startproc
 1090              		@ args = 0, pretend = 0, frame = 56
 1091              		@ frame_needed = 0, uses_anonymous_args = 0
 1092 0000 00B5     		push	{lr}
 1093              	.LCFI26:
 1094              		.cfi_def_cfa_offset 4
 1095              		.cfi_offset 14, -4
 1096 0002 8FB0     		sub	sp, sp, #60
 1097              	.LCFI27:
 1098              		.cfi_def_cfa_offset 64
 433:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1099              		.loc 1 433 2 view .LVU309
 1100              		.loc 1 433 22 is_stmt 0 view .LVU310
 1101 0004 3822     		movs	r2, #56
 1102 0006 0021     		movs	r1, #0
 1103 0008 6846     		mov	r0, sp
 1104 000a FFF7FEFF 		bl	memset
 1105              	.LVL57:
 434:Core/Src/z_qflash_W25QXXX.c **** 
 435:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 1106              		.loc 1 435 2 is_stmt 1 view .LVU311
 1107 000e 6846     		mov	r0, sp
 1108 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 1109              	.LVL58:
 436:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_DISABLE;
 1110              		.loc 1 436 2 view .LVU312
 1111              		.loc 1 436 23 is_stmt 0 view .LVU313
 1112 0014 0423     		movs	r3, #4
 1113 0016 0093     		str	r3, [sp]
 437:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 1114              		.loc 1 437 5 is_stmt 1 view .LVU314
 1115              		.loc 1 437 25 is_stmt 0 view .LVU315
 1116 0018 0023     		movs	r3, #0
 1117 001a 0993     		str	r3, [sp, #36]
 438:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1118              		.loc 1 438 5 is_stmt 1 view .LVU316
 1119              		.loc 1 438 26 is_stmt 0 view .LVU317
 1120 001c 0793     		str	r3, [sp, #28]
 439:Core/Src/z_qflash_W25QXXX.c **** 
 440:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 441:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1121              		.loc 1 441 2 is_stmt 1 view .LVU318
 1122              	.L93:
 1123              		.loc 1 441 26 discriminator 1 view .LVU319
 1124              		.loc 1 441 8 discriminator 1 view .LVU320
ARM GAS  /tmp/ccdMdDsR.s 			page 30


 1125              		.loc 1 441 9 is_stmt 0 discriminator 1 view .LVU321
 1126 001e 084B     		ldr	r3, .L98
 1127 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1128              		.loc 1 441 8 discriminator 1 view .LVU322
 1129 0022 002B     		cmp	r3, #0
 1130 0024 FBD0     		beq	.L93
 1131              		.loc 1 441 27 is_stmt 1 discriminator 2 view .LVU323
 442:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 443:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 1132              		.loc 1 443 5 discriminator 2 view .LVU324
 1133              		.loc 1 443 9 is_stmt 0 discriminator 2 view .LVU325
 1134 0026 41F28832 		movw	r2, #5000
 1135 002a 6946     		mov	r1, sp
 1136 002c 0548     		ldr	r0, .L98+4
 1137 002e FFF7FEFF 		bl	HAL_QSPI_Command
 1138              	.LVL59:
 1139              		.loc 1 443 8 discriminator 2 view .LVU326
 1140 0032 10B9     		cbnz	r0, .L97
 1141              	.L94:
 444:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 445:Core/Src/z_qflash_W25QXXX.c ****     }
 446:Core/Src/z_qflash_W25QXXX.c **** 
 447:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
 448:Core/Src/z_qflash_W25QXXX.c **** }
 1142              		.loc 1 448 1 view .LVU327
 1143 0034 0FB0     		add	sp, sp, #60
 1144              	.LCFI28:
 1145              		.cfi_remember_state
 1146              		.cfi_def_cfa_offset 4
 1147              		@ sp needed
 1148 0036 5DF804FB 		ldr	pc, [sp], #4
 1149              	.L97:
 1150              	.LCFI29:
 1151              		.cfi_restore_state
 444:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 1152              		.loc 1 444 16 view .LVU328
 1153 003a 0120     		movs	r0, #1
 1154 003c FAE7     		b	.L94
 1155              	.L99:
 1156 003e 00BF     		.align	2
 1157              	.L98:
 1158 0040 00000000 		.word	.LANCHOR0
 1159 0044 00000000 		.word	hqspi
 1160              		.cfi_endproc
 1161              	.LFE155:
 1163              		.section	.text.QFlash_ReadSR1,"ax",%progbits
 1164              		.align	1
 1165              		.global	QFlash_ReadSR1
 1166              		.syntax unified
 1167              		.thumb
 1168              		.thumb_func
 1169              		.fpu fpv5-d16
 1171              	QFlash_ReadSR1:
 1172              	.LVL60:
 1173              	.LFB156:
 449:Core/Src/z_qflash_W25QXXX.c **** 
 450:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 31


 451:Core/Src/z_qflash_W25QXXX.c **** 
 452:Core/Src/z_qflash_W25QXXX.c **** 
 453:Core/Src/z_qflash_W25QXXX.c **** 
 454:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 455:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	read 	STATUS REGISTER 1
 456:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	dataptr	points to a 1 byte registering the SR1 value
 457:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 458:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadSR1(uint8_t *dataptr){
 1174              		.loc 1 458 51 is_stmt 1 view -0
 1175              		.cfi_startproc
 1176              		@ args = 0, pretend = 0, frame = 56
 1177              		@ frame_needed = 0, uses_anonymous_args = 0
 1178              		.loc 1 458 51 is_stmt 0 view .LVU330
 1179 0000 10B5     		push	{r4, lr}
 1180              	.LCFI30:
 1181              		.cfi_def_cfa_offset 8
 1182              		.cfi_offset 4, -8
 1183              		.cfi_offset 14, -4
 1184 0002 8EB0     		sub	sp, sp, #56
 1185              	.LCFI31:
 1186              		.cfi_def_cfa_offset 64
 1187 0004 0446     		mov	r4, r0
 459:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 1188              		.loc 1 459 1 is_stmt 1 view .LVU331
 1189              		.loc 1 459 21 is_stmt 0 view .LVU332
 1190 0006 3822     		movs	r2, #56
 1191 0008 0021     		movs	r1, #0
 1192 000a 6846     		mov	r0, sp
 1193              	.LVL61:
 1194              		.loc 1 459 21 view .LVU333
 1195 000c FFF7FEFF 		bl	memset
 1196              	.LVL62:
 460:Core/Src/z_qflash_W25QXXX.c **** 
 461:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 1197              		.loc 1 461 2 is_stmt 1 view .LVU334
 1198 0010 6846     		mov	r0, sp
 1199 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 1200              	.LVL63:
 462:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_R_SR1;
 1201              		.loc 1 462 2 view .LVU335
 1202              		.loc 1 462 23 is_stmt 0 view .LVU336
 1203 0016 0523     		movs	r3, #5
 1204 0018 0093     		str	r3, [sp]
 463:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
 1205              		.loc 1 463 5 is_stmt 1 view .LVU337
 1206              		.loc 1 463 25 is_stmt 0 view .LVU338
 1207 001a 4FF08073 		mov	r3, #16777216
 1208 001e 0993     		str	r3, [sp, #36]
 464:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1209              		.loc 1 464 2 is_stmt 1 view .LVU339
 1210              		.loc 1 464 23 is_stmt 0 view .LVU340
 1211 0020 0023     		movs	r3, #0
 1212 0022 0793     		str	r3, [sp, #28]
 465:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1213              		.loc 1 465 2 is_stmt 1 view .LVU341
 1214              		.loc 1 465 23 is_stmt 0 view .LVU342
 1215 0024 0393     		str	r3, [sp, #12]
ARM GAS  /tmp/ccdMdDsR.s 			page 32


 466:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1216              		.loc 1 466 2 is_stmt 1 view .LVU343
 1217              		.loc 1 466 20 is_stmt 0 view .LVU344
 1218 0026 0193     		str	r3, [sp, #4]
 467:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 1;
 1219              		.loc 1 467 5 is_stmt 1 view .LVU345
 1220              		.loc 1 467 23 is_stmt 0 view .LVU346
 1221 0028 0123     		movs	r3, #1
 1222 002a 0A93     		str	r3, [sp, #40]
 468:Core/Src/z_qflash_W25QXXX.c **** 
 469:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 470:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1223              		.loc 1 470 2 is_stmt 1 view .LVU347
 1224              	.L101:
 1225              		.loc 1 470 26 discriminator 1 view .LVU348
 1226              		.loc 1 470 8 discriminator 1 view .LVU349
 1227              		.loc 1 470 9 is_stmt 0 discriminator 1 view .LVU350
 1228 002c 0F4B     		ldr	r3, .L108
 1229 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1230              		.loc 1 470 8 discriminator 1 view .LVU351
 1231 0030 002B     		cmp	r3, #0
 1232 0032 FBD0     		beq	.L101
 1233              		.loc 1 470 27 is_stmt 1 discriminator 2 view .LVU352
 471:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1234              		.loc 1 471 2 discriminator 2 view .LVU353
 1235              		.loc 1 471 15 is_stmt 0 discriminator 2 view .LVU354
 1236 0034 0023     		movs	r3, #0
 1237 0036 0D4A     		ldr	r2, .L108
 1238 0038 1370     		strb	r3, [r2]
 472:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 1239              		.loc 1 472 2 is_stmt 1 discriminator 2 view .LVU355
 1240              		.loc 1 472 23 is_stmt 0 discriminator 2 view .LVU356
 1241 003a 0D4A     		ldr	r2, .L108+4
 1242 003c 1370     		strb	r3, [r2]
 473:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 1243              		.loc 1 473 5 is_stmt 1 discriminator 2 view .LVU357
 1244              		.loc 1 473 9 is_stmt 0 discriminator 2 view .LVU358
 1245 003e 41F28832 		movw	r2, #5000
 1246 0042 6946     		mov	r1, sp
 1247 0044 0B48     		ldr	r0, .L108+8
 1248 0046 FFF7FEFF 		bl	HAL_QSPI_Command
 1249              	.LVL64:
 1250              		.loc 1 473 8 discriminator 2 view .LVU359
 1251 004a 18B1     		cbz	r0, .L106
 474:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 1252              		.loc 1 474 16 view .LVU360
 1253 004c 0124     		movs	r4, #1
 1254              	.LVL65:
 1255              	.L102:
 475:Core/Src/z_qflash_W25QXXX.c ****     }
 476:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 477:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 478:Core/Src/z_qflash_W25QXXX.c ****     }
 479:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
 480:Core/Src/z_qflash_W25QXXX.c **** #else
 481:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 482:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
ARM GAS  /tmp/ccdMdDsR.s 			page 33


 483:Core/Src/z_qflash_W25QXXX.c ****     }
 484:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
 485:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 486:Core/Src/z_qflash_W25QXXX.c ****     }
 487:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 488:Core/Src/z_qflash_W25QXXX.c **** 
 489:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
 490:Core/Src/z_qflash_W25QXXX.c **** }
 1256              		.loc 1 490 1 view .LVU361
 1257 004e 2046     		mov	r0, r4
 1258 0050 0EB0     		add	sp, sp, #56
 1259              	.LCFI32:
 1260              		.cfi_remember_state
 1261              		.cfi_def_cfa_offset 8
 1262              		@ sp needed
 1263 0052 10BD     		pop	{r4, pc}
 1264              	.LVL66:
 1265              	.L106:
 1266              	.LCFI33:
 1267              		.cfi_restore_state
 476:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1268              		.loc 1 476 5 is_stmt 1 view .LVU362
 476:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1269              		.loc 1 476 9 is_stmt 0 view .LVU363
 1270 0054 2146     		mov	r1, r4
 1271 0056 0748     		ldr	r0, .L108+8
 1272 0058 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 1273              	.LVL67:
 476:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1274              		.loc 1 476 8 view .LVU364
 1275 005c 0446     		mov	r4, r0
 1276              	.LVL68:
 476:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1277              		.loc 1 476 8 view .LVU365
 1278 005e 08B1     		cbz	r0, .L107
 477:Core/Src/z_qflash_W25QXXX.c ****     }
 1279              		.loc 1 477 13 view .LVU366
 1280 0060 0124     		movs	r4, #1
 1281 0062 F4E7     		b	.L102
 1282              	.L107:
 479:Core/Src/z_qflash_W25QXXX.c **** #else
 1283              		.loc 1 479 2 is_stmt 1 view .LVU367
 1284 0064 FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 1285              	.LVL69:
 489:Core/Src/z_qflash_W25QXXX.c **** }
 1286              		.loc 1 489 5 view .LVU368
 489:Core/Src/z_qflash_W25QXXX.c **** }
 1287              		.loc 1 489 12 is_stmt 0 view .LVU369
 1288 0068 F1E7     		b	.L102
 1289              	.L109:
 1290 006a 00BF     		.align	2
 1291              	.L108:
 1292 006c 00000000 		.word	.LANCHOR0
 1293 0070 00000000 		.word	.LANCHOR1
 1294 0074 00000000 		.word	hqspi
 1295              		.cfi_endproc
 1296              	.LFE156:
ARM GAS  /tmp/ccdMdDsR.s 			page 34


 1298              		.section	.text.QFlash_ReadSR2,"ax",%progbits
 1299              		.align	1
 1300              		.global	QFlash_ReadSR2
 1301              		.syntax unified
 1302              		.thumb
 1303              		.thumb_func
 1304              		.fpu fpv5-d16
 1306              	QFlash_ReadSR2:
 1307              	.LVL70:
 1308              	.LFB157:
 491:Core/Src/z_qflash_W25QXXX.c **** 
 492:Core/Src/z_qflash_W25QXXX.c **** 
 493:Core/Src/z_qflash_W25QXXX.c **** 
 494:Core/Src/z_qflash_W25QXXX.c **** 
 495:Core/Src/z_qflash_W25QXXX.c **** 
 496:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 497:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	read STATUS REGISTER 2
 498:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	dataptr	points to a 1 byte registering the SR2 value
 499:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 500:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadSR2(uint8_t *dataptr){
 1309              		.loc 1 500 51 is_stmt 1 view -0
 1310              		.cfi_startproc
 1311              		@ args = 0, pretend = 0, frame = 56
 1312              		@ frame_needed = 0, uses_anonymous_args = 0
 1313              		.loc 1 500 51 is_stmt 0 view .LVU371
 1314 0000 10B5     		push	{r4, lr}
 1315              	.LCFI34:
 1316              		.cfi_def_cfa_offset 8
 1317              		.cfi_offset 4, -8
 1318              		.cfi_offset 14, -4
 1319 0002 8EB0     		sub	sp, sp, #56
 1320              	.LCFI35:
 1321              		.cfi_def_cfa_offset 64
 1322 0004 0446     		mov	r4, r0
 501:Core/Src/z_qflash_W25QXXX.c **** 
 502:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 1323              		.loc 1 502 1 is_stmt 1 view .LVU372
 1324              		.loc 1 502 21 is_stmt 0 view .LVU373
 1325 0006 3822     		movs	r2, #56
 1326 0008 0021     		movs	r1, #0
 1327 000a 6846     		mov	r0, sp
 1328              	.LVL71:
 1329              		.loc 1 502 21 view .LVU374
 1330 000c FFF7FEFF 		bl	memset
 1331              	.LVL72:
 503:Core/Src/z_qflash_W25QXXX.c **** 
 504:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 1332              		.loc 1 504 2 is_stmt 1 view .LVU375
 1333 0010 6846     		mov	r0, sp
 1334 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 1335              	.LVL73:
 505:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_R_SR2;
 1336              		.loc 1 505 2 view .LVU376
 1337              		.loc 1 505 23 is_stmt 0 view .LVU377
 1338 0016 3523     		movs	r3, #53
 1339 0018 0093     		str	r3, [sp]
 506:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
ARM GAS  /tmp/ccdMdDsR.s 			page 35


 1340              		.loc 1 506 5 is_stmt 1 view .LVU378
 1341              		.loc 1 506 25 is_stmt 0 view .LVU379
 1342 001a 4FF08073 		mov	r3, #16777216
 1343 001e 0993     		str	r3, [sp, #36]
 507:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1344              		.loc 1 507 2 is_stmt 1 view .LVU380
 1345              		.loc 1 507 23 is_stmt 0 view .LVU381
 1346 0020 0023     		movs	r3, #0
 1347 0022 0793     		str	r3, [sp, #28]
 508:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1348              		.loc 1 508 2 is_stmt 1 view .LVU382
 1349              		.loc 1 508 23 is_stmt 0 view .LVU383
 1350 0024 0393     		str	r3, [sp, #12]
 509:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1351              		.loc 1 509 2 is_stmt 1 view .LVU384
 1352              		.loc 1 509 20 is_stmt 0 view .LVU385
 1353 0026 0193     		str	r3, [sp, #4]
 510:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 1;
 1354              		.loc 1 510 5 is_stmt 1 view .LVU386
 1355              		.loc 1 510 23 is_stmt 0 view .LVU387
 1356 0028 0123     		movs	r3, #1
 1357 002a 0A93     		str	r3, [sp, #40]
 511:Core/Src/z_qflash_W25QXXX.c **** 
 512:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 513:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1358              		.loc 1 513 2 is_stmt 1 view .LVU388
 1359              	.L111:
 1360              		.loc 1 513 26 discriminator 1 view .LVU389
 1361              		.loc 1 513 8 discriminator 1 view .LVU390
 1362              		.loc 1 513 9 is_stmt 0 discriminator 1 view .LVU391
 1363 002c 0F4B     		ldr	r3, .L118
 1364 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1365              		.loc 1 513 8 discriminator 1 view .LVU392
 1366 0030 002B     		cmp	r3, #0
 1367 0032 FBD0     		beq	.L111
 1368              		.loc 1 513 27 is_stmt 1 discriminator 2 view .LVU393
 514:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1369              		.loc 1 514 2 discriminator 2 view .LVU394
 1370              		.loc 1 514 15 is_stmt 0 discriminator 2 view .LVU395
 1371 0034 0023     		movs	r3, #0
 1372 0036 0D4A     		ldr	r2, .L118
 1373 0038 1370     		strb	r3, [r2]
 515:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 1374              		.loc 1 515 2 is_stmt 1 discriminator 2 view .LVU396
 1375              		.loc 1 515 23 is_stmt 0 discriminator 2 view .LVU397
 1376 003a 0D4A     		ldr	r2, .L118+4
 1377 003c 1370     		strb	r3, [r2]
 516:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 1378              		.loc 1 516 5 is_stmt 1 discriminator 2 view .LVU398
 1379              		.loc 1 516 9 is_stmt 0 discriminator 2 view .LVU399
 1380 003e 41F28832 		movw	r2, #5000
 1381 0042 6946     		mov	r1, sp
 1382 0044 0B48     		ldr	r0, .L118+8
 1383 0046 FFF7FEFF 		bl	HAL_QSPI_Command
 1384              	.LVL74:
 1385              		.loc 1 516 8 discriminator 2 view .LVU400
 1386 004a 18B1     		cbz	r0, .L116
ARM GAS  /tmp/ccdMdDsR.s 			page 36


 517:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 1387              		.loc 1 517 16 view .LVU401
 1388 004c 0124     		movs	r4, #1
 1389              	.LVL75:
 1390              	.L112:
 518:Core/Src/z_qflash_W25QXXX.c ****     }
 519:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 520:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 521:Core/Src/z_qflash_W25QXXX.c ****     }
 522:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
 523:Core/Src/z_qflash_W25QXXX.c **** #else
 524:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 525:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 526:Core/Src/z_qflash_W25QXXX.c ****     }
 527:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
 528:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 529:Core/Src/z_qflash_W25QXXX.c ****     }
 530:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 531:Core/Src/z_qflash_W25QXXX.c **** 
 532:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 533:Core/Src/z_qflash_W25QXXX.c **** }
 1391              		.loc 1 533 1 view .LVU402
 1392 004e 2046     		mov	r0, r4
 1393 0050 0EB0     		add	sp, sp, #56
 1394              	.LCFI36:
 1395              		.cfi_remember_state
 1396              		.cfi_def_cfa_offset 8
 1397              		@ sp needed
 1398 0052 10BD     		pop	{r4, pc}
 1399              	.LVL76:
 1400              	.L116:
 1401              	.LCFI37:
 1402              		.cfi_restore_state
 519:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1403              		.loc 1 519 5 is_stmt 1 view .LVU403
 519:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1404              		.loc 1 519 9 is_stmt 0 view .LVU404
 1405 0054 2146     		mov	r1, r4
 1406 0056 0748     		ldr	r0, .L118+8
 1407 0058 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 1408              	.LVL77:
 519:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1409              		.loc 1 519 8 view .LVU405
 1410 005c 0446     		mov	r4, r0
 1411              	.LVL78:
 519:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1412              		.loc 1 519 8 view .LVU406
 1413 005e 08B1     		cbz	r0, .L117
 520:Core/Src/z_qflash_W25QXXX.c ****     }
 1414              		.loc 1 520 13 view .LVU407
 1415 0060 0124     		movs	r4, #1
 1416 0062 F4E7     		b	.L112
 1417              	.L117:
 522:Core/Src/z_qflash_W25QXXX.c **** #else
 1418              		.loc 1 522 2 is_stmt 1 view .LVU408
 1419 0064 FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 1420              	.LVL79:
ARM GAS  /tmp/ccdMdDsR.s 			page 37


 532:Core/Src/z_qflash_W25QXXX.c **** }
 1421              		.loc 1 532 2 view .LVU409
 532:Core/Src/z_qflash_W25QXXX.c **** }
 1422              		.loc 1 532 9 is_stmt 0 view .LVU410
 1423 0068 F1E7     		b	.L112
 1424              	.L119:
 1425 006a 00BF     		.align	2
 1426              	.L118:
 1427 006c 00000000 		.word	.LANCHOR0
 1428 0070 00000000 		.word	.LANCHOR1
 1429 0074 00000000 		.word	hqspi
 1430              		.cfi_endproc
 1431              	.LFE157:
 1433              		.section	.text.QFlash_ReadSR3,"ax",%progbits
 1434              		.align	1
 1435              		.global	QFlash_ReadSR3
 1436              		.syntax unified
 1437              		.thumb
 1438              		.thumb_func
 1439              		.fpu fpv5-d16
 1441              	QFlash_ReadSR3:
 1442              	.LVL80:
 1443              	.LFB158:
 534:Core/Src/z_qflash_W25QXXX.c **** 
 535:Core/Src/z_qflash_W25QXXX.c **** 
 536:Core/Src/z_qflash_W25QXXX.c **** 
 537:Core/Src/z_qflash_W25QXXX.c **** 
 538:Core/Src/z_qflash_W25QXXX.c **** 
 539:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 540:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	read STATUS REGISTER 3
 541:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	dataptr	points to a 1 byte registering the SR2 value
 542:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 543:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadSR3(uint8_t *dataptr){
 1444              		.loc 1 543 51 is_stmt 1 view -0
 1445              		.cfi_startproc
 1446              		@ args = 0, pretend = 0, frame = 56
 1447              		@ frame_needed = 0, uses_anonymous_args = 0
 1448              		.loc 1 543 51 is_stmt 0 view .LVU412
 1449 0000 10B5     		push	{r4, lr}
 1450              	.LCFI38:
 1451              		.cfi_def_cfa_offset 8
 1452              		.cfi_offset 4, -8
 1453              		.cfi_offset 14, -4
 1454 0002 8EB0     		sub	sp, sp, #56
 1455              	.LCFI39:
 1456              		.cfi_def_cfa_offset 64
 1457 0004 0446     		mov	r4, r0
 544:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 1458              		.loc 1 544 1 is_stmt 1 view .LVU413
 1459              		.loc 1 544 21 is_stmt 0 view .LVU414
 1460 0006 3822     		movs	r2, #56
 1461 0008 0021     		movs	r1, #0
 1462 000a 6846     		mov	r0, sp
 1463              	.LVL81:
 1464              		.loc 1 544 21 view .LVU415
 1465 000c FFF7FEFF 		bl	memset
 1466              	.LVL82:
ARM GAS  /tmp/ccdMdDsR.s 			page 38


 545:Core/Src/z_qflash_W25QXXX.c **** 
 546:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 1467              		.loc 1 546 2 is_stmt 1 view .LVU416
 1468 0010 6846     		mov	r0, sp
 1469 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 1470              	.LVL83:
 547:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_R_SR3;
 1471              		.loc 1 547 2 view .LVU417
 1472              		.loc 1 547 23 is_stmt 0 view .LVU418
 1473 0016 1523     		movs	r3, #21
 1474 0018 0093     		str	r3, [sp]
 548:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
 1475              		.loc 1 548 5 is_stmt 1 view .LVU419
 1476              		.loc 1 548 25 is_stmt 0 view .LVU420
 1477 001a 4FF08073 		mov	r3, #16777216
 1478 001e 0993     		str	r3, [sp, #36]
 549:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1479              		.loc 1 549 2 is_stmt 1 view .LVU421
 1480              		.loc 1 549 23 is_stmt 0 view .LVU422
 1481 0020 0023     		movs	r3, #0
 1482 0022 0793     		str	r3, [sp, #28]
 550:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1483              		.loc 1 550 2 is_stmt 1 view .LVU423
 1484              		.loc 1 550 23 is_stmt 0 view .LVU424
 1485 0024 0393     		str	r3, [sp, #12]
 551:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1486              		.loc 1 551 2 is_stmt 1 view .LVU425
 1487              		.loc 1 551 20 is_stmt 0 view .LVU426
 1488 0026 0193     		str	r3, [sp, #4]
 552:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 1;
 1489              		.loc 1 552 5 is_stmt 1 view .LVU427
 1490              		.loc 1 552 23 is_stmt 0 view .LVU428
 1491 0028 0123     		movs	r3, #1
 1492 002a 0A93     		str	r3, [sp, #40]
 553:Core/Src/z_qflash_W25QXXX.c **** 
 554:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 555:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1493              		.loc 1 555 2 is_stmt 1 view .LVU429
 1494              	.L121:
 1495              		.loc 1 555 26 discriminator 1 view .LVU430
 1496              		.loc 1 555 8 discriminator 1 view .LVU431
 1497              		.loc 1 555 9 is_stmt 0 discriminator 1 view .LVU432
 1498 002c 0F4B     		ldr	r3, .L128
 1499 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1500              		.loc 1 555 8 discriminator 1 view .LVU433
 1501 0030 002B     		cmp	r3, #0
 1502 0032 FBD0     		beq	.L121
 1503              		.loc 1 555 27 is_stmt 1 discriminator 2 view .LVU434
 556:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1504              		.loc 1 556 2 discriminator 2 view .LVU435
 1505              		.loc 1 556 15 is_stmt 0 discriminator 2 view .LVU436
 1506 0034 0023     		movs	r3, #0
 1507 0036 0D4A     		ldr	r2, .L128
 1508 0038 1370     		strb	r3, [r2]
 557:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 1509              		.loc 1 557 2 is_stmt 1 discriminator 2 view .LVU437
 1510              		.loc 1 557 23 is_stmt 0 discriminator 2 view .LVU438
ARM GAS  /tmp/ccdMdDsR.s 			page 39


 1511 003a 0D4A     		ldr	r2, .L128+4
 1512 003c 1370     		strb	r3, [r2]
 558:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 1513              		.loc 1 558 5 is_stmt 1 discriminator 2 view .LVU439
 1514              		.loc 1 558 9 is_stmt 0 discriminator 2 view .LVU440
 1515 003e 41F28832 		movw	r2, #5000
 1516 0042 6946     		mov	r1, sp
 1517 0044 0B48     		ldr	r0, .L128+8
 1518 0046 FFF7FEFF 		bl	HAL_QSPI_Command
 1519              	.LVL84:
 1520              		.loc 1 558 8 discriminator 2 view .LVU441
 1521 004a 18B1     		cbz	r0, .L126
 559:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 1522              		.loc 1 559 16 view .LVU442
 1523 004c 0124     		movs	r4, #1
 1524              	.LVL85:
 1525              	.L122:
 560:Core/Src/z_qflash_W25QXXX.c ****     }
 561:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 562:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 563:Core/Src/z_qflash_W25QXXX.c ****     }
 564:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
 565:Core/Src/z_qflash_W25QXXX.c **** #else
 566:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 567:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 568:Core/Src/z_qflash_W25QXXX.c ****     }
 569:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
 570:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 571:Core/Src/z_qflash_W25QXXX.c ****     }
 572:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 573:Core/Src/z_qflash_W25QXXX.c **** 
 574:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 575:Core/Src/z_qflash_W25QXXX.c **** }
 1526              		.loc 1 575 1 view .LVU443
 1527 004e 2046     		mov	r0, r4
 1528 0050 0EB0     		add	sp, sp, #56
 1529              	.LCFI40:
 1530              		.cfi_remember_state
 1531              		.cfi_def_cfa_offset 8
 1532              		@ sp needed
 1533 0052 10BD     		pop	{r4, pc}
 1534              	.LVL86:
 1535              	.L126:
 1536              	.LCFI41:
 1537              		.cfi_restore_state
 561:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1538              		.loc 1 561 5 is_stmt 1 view .LVU444
 561:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1539              		.loc 1 561 9 is_stmt 0 view .LVU445
 1540 0054 2146     		mov	r1, r4
 1541 0056 0748     		ldr	r0, .L128+8
 1542 0058 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 1543              	.LVL87:
 561:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1544              		.loc 1 561 8 view .LVU446
 1545 005c 0446     		mov	r4, r0
 1546              	.LVL88:
ARM GAS  /tmp/ccdMdDsR.s 			page 40


 561:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 1547              		.loc 1 561 8 view .LVU447
 1548 005e 08B1     		cbz	r0, .L127
 562:Core/Src/z_qflash_W25QXXX.c ****     }
 1549              		.loc 1 562 13 view .LVU448
 1550 0060 0124     		movs	r4, #1
 1551 0062 F4E7     		b	.L122
 1552              	.L127:
 564:Core/Src/z_qflash_W25QXXX.c **** #else
 1553              		.loc 1 564 2 is_stmt 1 view .LVU449
 1554 0064 FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 1555              	.LVL89:
 574:Core/Src/z_qflash_W25QXXX.c **** }
 1556              		.loc 1 574 2 view .LVU450
 574:Core/Src/z_qflash_W25QXXX.c **** }
 1557              		.loc 1 574 9 is_stmt 0 view .LVU451
 1558 0068 F1E7     		b	.L122
 1559              	.L129:
 1560 006a 00BF     		.align	2
 1561              	.L128:
 1562 006c 00000000 		.word	.LANCHOR0
 1563 0070 00000000 		.word	.LANCHOR1
 1564 0074 00000000 		.word	hqspi
 1565              		.cfi_endproc
 1566              	.LFE158:
 1568              		.section	.text.QFlash_CheckSR1,"ax",%progbits
 1569              		.align	1
 1570              		.global	QFlash_CheckSR1
 1571              		.syntax unified
 1572              		.thumb
 1573              		.thumb_func
 1574              		.fpu fpv5-d16
 1576              	QFlash_CheckSR1:
 1577              	.LFB161:
 576:Core/Src/z_qflash_W25QXXX.c **** 
 577:Core/Src/z_qflash_W25QXXX.c **** 
 578:Core/Src/z_qflash_W25QXXX.c **** 
 579:Core/Src/z_qflash_W25QXXX.c **** 
 580:Core/Src/z_qflash_W25QXXX.c **** 
 581:Core/Src/z_qflash_W25QXXX.c **** 
 582:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef  QFlash_WriteSR2(uint8_t data){
 583:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 584:Core/Src/z_qflash_W25QXXX.c **** 
 585:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 586:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 587:Core/Src/z_qflash_W25QXXX.c **** 
 588:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 589:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_SR2;
 590:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 591:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 592:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 593:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 594:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 595:Core/Src/z_qflash_W25QXXX.c **** 
 596:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 597:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 598:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
ARM GAS  /tmp/ccdMdDsR.s 			page 41


 599:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 600:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 601:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 602:Core/Src/z_qflash_W25QXXX.c **** 	}
 603:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Transmit_DMA(&FLASH_QSPI_PORT, &data) != HAL_OK) { // Receive data
 604:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 605:Core/Src/z_qflash_W25QXXX.c **** 	}
 606:Core/Src/z_qflash_W25QXXX.c **** #else
 607:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 608:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 609:Core/Src/z_qflash_W25QXXX.c **** 	}
 610:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Transmit(&FLASH_QSPI_PORT, &data, QFLASH_DEF_TIMEOUT) != HAL_OK) {
 611:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 612:Core/Src/z_qflash_W25QXXX.c **** 	}
 613:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 614:Core/Src/z_qflash_W25QXXX.c **** 
 615:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForWritingComplete();
 616:Core/Src/z_qflash_W25QXXX.c **** 
 617:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 618:Core/Src/z_qflash_W25QXXX.c **** }
 619:Core/Src/z_qflash_W25QXXX.c **** 
 620:Core/Src/z_qflash_W25QXXX.c **** 
 621:Core/Src/z_qflash_W25QXXX.c **** 
 622:Core/Src/z_qflash_W25QXXX.c **** 
 623:Core/Src/z_qflash_W25QXXX.c **** 
 624:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef  QFlash_WriteSR3(uint8_t data){
 625:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 626:Core/Src/z_qflash_W25QXXX.c **** 
 627:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 628:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 629:Core/Src/z_qflash_W25QXXX.c **** 
 630:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 631:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_SR3;
 632:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 633:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 634:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 635:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 636:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 637:Core/Src/z_qflash_W25QXXX.c **** 
 638:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_QDMA_MODE
 639:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 640:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 641:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 642:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 643:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 644:Core/Src/z_qflash_W25QXXX.c **** 	}
 645:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Transmit_DMA(&FLASH_QSPI_PORT, &data) != HAL_OK) { // Receive data
 646:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 647:Core/Src/z_qflash_W25QXXX.c **** 	}
 648:Core/Src/z_qflash_W25QXXX.c **** #else
 649:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 650:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 651:Core/Src/z_qflash_W25QXXX.c **** 	}
 652:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Transmit(&FLASH_QSPI_PORT, &data, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive data
 653:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 654:Core/Src/z_qflash_W25QXXX.c **** 	}
 655:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
ARM GAS  /tmp/ccdMdDsR.s 			page 42


 656:Core/Src/z_qflash_W25QXXX.c **** 
 657:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForWritingComplete();
 658:Core/Src/z_qflash_W25QXXX.c **** 
 659:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 660:Core/Src/z_qflash_W25QXXX.c **** }
 661:Core/Src/z_qflash_W25QXXX.c **** 
 662:Core/Src/z_qflash_W25QXXX.c **** 
 663:Core/Src/z_qflash_W25QXXX.c **** 
 664:Core/Src/z_qflash_W25QXXX.c **** 
 665:Core/Src/z_qflash_W25QXXX.c **** 
 666:Core/Src/z_qflash_W25QXXX.c **** 
 667:Core/Src/z_qflash_W25QXXX.c **** /*********************************
 668:Core/Src/z_qflash_W25QXXX.c ****  * just a funcion testing Status
 669:Core/Src/z_qflash_W25QXXX.c ****  * Register 1 reading
 670:Core/Src/z_qflash_W25QXXX.c ****  * It verifies flash is not busy and
 671:Core/Src/z_qflash_W25QXXX.c ****  * not write-enabled
 672:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 673:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_CheckSR1() {
 1578              		.loc 1 673 37 is_stmt 1 view -0
 1579              		.cfi_startproc
 1580              		@ args = 0, pretend = 0, frame = 8
 1581              		@ frame_needed = 0, uses_anonymous_args = 0
 1582 0000 00B5     		push	{lr}
 1583              	.LCFI42:
 1584              		.cfi_def_cfa_offset 4
 1585              		.cfi_offset 14, -4
 1586 0002 83B0     		sub	sp, sp, #12
 1587              	.LCFI43:
 1588              		.cfi_def_cfa_offset 16
 674:Core/Src/z_qflash_W25QXXX.c **** 	HAL_StatusTypeDef result = HAL_OK;
 1589              		.loc 1 674 2 view .LVU453
 1590              	.LVL90:
 675:Core/Src/z_qflash_W25QXXX.c **** 	uint8_t sr;
 1591              		.loc 1 675 2 view .LVU454
 676:Core/Src/z_qflash_W25QXXX.c **** 
 677:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_ReadSR1(&sr);
 1592              		.loc 1 677 2 view .LVU455
 1593 0004 0DF10700 		add	r0, sp, #7
 1594 0008 FFF7FEFF 		bl	QFlash_ReadSR1
 1595              	.LVL91:
 678:Core/Src/z_qflash_W25QXXX.c **** 
 679:Core/Src/z_qflash_W25QXXX.c **** //bitwise test of the SR1 content
 680:Core/Src/z_qflash_W25QXXX.c **** 	if (!((sr & 1)==0)) {  //why flash is busy? It shouldn't
 1596              		.loc 1 680 2 view .LVU456
 1597              		.loc 1 680 12 is_stmt 0 view .LVU457
 1598 000c 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 1599              		.loc 1 680 5 view .LVU458
 1600 0010 10F0010F 		tst	r0, #1
 1601 0014 12D1     		bne	.L132
 681:Core/Src/z_qflash_W25QXXX.c **** 		result=HAL_ERROR;
 682:Core/Src/z_qflash_W25QXXX.c **** 	} else if (!((sr & 2)==0)) {  //if write_enabled, disable it
 1602              		.loc 1 682 9 is_stmt 1 view .LVU459
 1603              		.loc 1 682 12 is_stmt 0 view .LVU460
 1604 0016 10F00200 		ands	r0, r0, #2
 1605 001a 10D0     		beq	.L131
 683:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_WriteDisable();
 1606              		.loc 1 683 3 is_stmt 1 view .LVU461
ARM GAS  /tmp/ccdMdDsR.s 			page 43


 1607 001c FFF7FEFF 		bl	QFlash_WriteDisable
 1608              	.LVL92:
 684:Core/Src/z_qflash_W25QXXX.c **** 		HAL_Delay(1);
 1609              		.loc 1 684 3 view .LVU462
 1610 0020 0120     		movs	r0, #1
 1611 0022 FFF7FEFF 		bl	HAL_Delay
 1612              	.LVL93:
 685:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_ReadSR1(&sr);
 1613              		.loc 1 685 3 view .LVU463
 1614 0026 0DF10700 		add	r0, sp, #7
 1615 002a FFF7FEFF 		bl	QFlash_ReadSR1
 1616              	.LVL94:
 686:Core/Src/z_qflash_W25QXXX.c **** 		if (!((sr & 2)==0)){ //why flash is still writeable? It shouldn't
 1617              		.loc 1 686 3 view .LVU464
 1618              		.loc 1 686 13 is_stmt 0 view .LVU465
 1619 002e 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 1620              		.loc 1 686 6 view .LVU466
 1621 0032 10F00200 		ands	r0, r0, #2
 1622 0036 02D0     		beq	.L131
 687:Core/Src/z_qflash_W25QXXX.c **** 			result=HAL_ERROR;
 1623              		.loc 1 687 10 view .LVU467
 1624 0038 0120     		movs	r0, #1
 1625 003a 00E0     		b	.L131
 1626              	.L132:
 681:Core/Src/z_qflash_W25QXXX.c **** 	} else if (!((sr & 2)==0)) {  //if write_enabled, disable it
 1627              		.loc 1 681 9 view .LVU468
 1628 003c 0120     		movs	r0, #1
 1629              	.L131:
 1630              	.LVL95:
 688:Core/Src/z_qflash_W25QXXX.c **** 		}
 689:Core/Src/z_qflash_W25QXXX.c **** 	}
 690:Core/Src/z_qflash_W25QXXX.c **** 	return result;
 1631              		.loc 1 690 2 is_stmt 1 view .LVU469
 691:Core/Src/z_qflash_W25QXXX.c **** }
 1632              		.loc 1 691 1 is_stmt 0 view .LVU470
 1633 003e 03B0     		add	sp, sp, #12
 1634              	.LCFI44:
 1635              		.cfi_def_cfa_offset 4
 1636              		@ sp needed
 1637 0040 5DF804FB 		ldr	pc, [sp], #4
 1638              		.cfi_endproc
 1639              	.LFE161:
 1641              		.section	.text.QFlash_WaitForWritingComplete,"ax",%progbits
 1642              		.align	1
 1643              		.global	QFlash_WaitForWritingComplete
 1644              		.syntax unified
 1645              		.thumb
 1646              		.thumb_func
 1647              		.fpu fpv5-d16
 1649              	QFlash_WaitForWritingComplete:
 1650              	.LFB162:
 692:Core/Src/z_qflash_W25QXXX.c **** 
 693:Core/Src/z_qflash_W25QXXX.c **** 
 694:Core/Src/z_qflash_W25QXXX.c **** 
 695:Core/Src/z_qflash_W25QXXX.c **** 
 696:Core/Src/z_qflash_W25QXXX.c **** 
 697:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 44


 698:Core/Src/z_qflash_W25QXXX.c **** 
 699:Core/Src/z_qflash_W25QXXX.c **** 
 700:Core/Src/z_qflash_W25QXXX.c **** 
 701:Core/Src/z_qflash_W25QXXX.c **** 
 702:Core/Src/z_qflash_W25QXXX.c **** 
 703:Core/Src/z_qflash_W25QXXX.c **** 
 704:Core/Src/z_qflash_W25QXXX.c **** 
 705:Core/Src/z_qflash_W25QXXX.c **** /**************************
 706:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	keeps looping inside this function until "BUSY" bit in SR1 register
 707:Core/Src/z_qflash_W25QXXX.c ****  * 			becomes 0, meaning that the runnin data operation (writing or erasing)
 708:Core/Src/z_qflash_W25QXXX.c ****  * 			on the chip, ended
 709:Core/Src/z_qflash_W25QXXX.c ****  **************************/
 710:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WaitForWritingComplete(){
 1651              		.loc 1 710 50 is_stmt 1 view -0
 1652              		.cfi_startproc
 1653              		@ args = 0, pretend = 0, frame = 80
 1654              		@ frame_needed = 0, uses_anonymous_args = 0
 1655 0000 00B5     		push	{lr}
 1656              	.LCFI45:
 1657              		.cfi_def_cfa_offset 4
 1658              		.cfi_offset 14, -4
 1659 0002 95B0     		sub	sp, sp, #84
 1660              	.LCFI46:
 1661              		.cfi_def_cfa_offset 88
 711:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1662              		.loc 1 711 2 view .LVU472
 1663              		.loc 1 711 22 is_stmt 0 view .LVU473
 1664 0004 3822     		movs	r2, #56
 1665 0006 0021     		movs	r1, #0
 1666 0008 06A8     		add	r0, sp, #24
 1667 000a FFF7FEFF 		bl	memset
 1668              	.LVL96:
 712:Core/Src/z_qflash_W25QXXX.c **** 
 713:Core/Src/z_qflash_W25QXXX.c **** 
 714:Core/Src/z_qflash_W25QXXX.c **** /* using HAL_QSPI_AutoPolling()*/
 715:Core/Src/z_qflash_W25QXXX.c **** 
 716:Core/Src/z_qflash_W25QXXX.c **** QSPI_AutoPollingTypeDef sConfig;
 1669              		.loc 1 716 1 is_stmt 1 view .LVU474
 717:Core/Src/z_qflash_W25QXXX.c **** 
 718:Core/Src/z_qflash_W25QXXX.c **** QFlash_DefaultCmd(&sCommand);
 1670              		.loc 1 718 1 view .LVU475
 1671 000e 06A8     		add	r0, sp, #24
 1672 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 1673              	.LVL97:
 719:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Instruction = W25_R_SR1;
 1674              		.loc 1 719 5 view .LVU476
 1675              		.loc 1 719 26 is_stmt 0 view .LVU477
 1676 0014 0523     		movs	r3, #5
 1677 0016 0693     		str	r3, [sp, #24]
 720:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode = QSPI_ADDRESS_NONE;
 1678              		.loc 1 720 5 is_stmt 1 view .LVU478
 1679              		.loc 1 720 26 is_stmt 0 view .LVU479
 1680 0018 0023     		movs	r3, #0
 1681 001a 0D93     		str	r3, [sp, #52]
 721:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode = QSPI_DATA_1_LINE;
 1682              		.loc 1 721 5 is_stmt 1 view .LVU480
 1683              		.loc 1 721 23 is_stmt 0 view .LVU481
ARM GAS  /tmp/ccdMdDsR.s 			page 45


 1684 001c 4FF08072 		mov	r2, #16777216
 1685 0020 0F92     		str	r2, [sp, #60]
 722:Core/Src/z_qflash_W25QXXX.c **** 
 723:Core/Src/z_qflash_W25QXXX.c ****     sConfig.Mask = SR1_BIT_BSY;
 1686              		.loc 1 723 5 is_stmt 1 view .LVU482
 1687              		.loc 1 723 18 is_stmt 0 view .LVU483
 1688 0022 0122     		movs	r2, #1
 1689 0024 0192     		str	r2, [sp, #4]
 724:Core/Src/z_qflash_W25QXXX.c ****     sConfig.Match = 0;
 1690              		.loc 1 724 5 is_stmt 1 view .LVU484
 1691              		.loc 1 724 19 is_stmt 0 view .LVU485
 1692 0026 0093     		str	r3, [sp]
 725:Core/Src/z_qflash_W25QXXX.c ****     sConfig.MatchMode = QSPI_MATCH_MODE_AND;
 1693              		.loc 1 725 5 is_stmt 1 view .LVU486
 1694              		.loc 1 725 23 is_stmt 0 view .LVU487
 1695 0028 0493     		str	r3, [sp, #16]
 726:Core/Src/z_qflash_W25QXXX.c ****     sConfig.StatusBytesSize = 1;
 1696              		.loc 1 726 5 is_stmt 1 view .LVU488
 1697              		.loc 1 726 29 is_stmt 0 view .LVU489
 1698 002a 0392     		str	r2, [sp, #12]
 727:Core/Src/z_qflash_W25QXXX.c ****     sConfig.Interval = 0x10;
 1699              		.loc 1 727 5 is_stmt 1 view .LVU490
 1700              		.loc 1 727 22 is_stmt 0 view .LVU491
 1701 002c 1023     		movs	r3, #16
 1702 002e 0293     		str	r3, [sp, #8]
 728:Core/Src/z_qflash_W25QXXX.c ****     sConfig.AutomaticStop = QSPI_AUTOMATIC_STOP_ENABLE;
 1703              		.loc 1 728 5 is_stmt 1 view .LVU492
 1704              		.loc 1 728 27 is_stmt 0 view .LVU493
 1705 0030 4FF48003 		mov	r3, #4194304
 1706 0034 0593     		str	r3, [sp, #20]
 729:Core/Src/z_qflash_W25QXXX.c **** 
 730:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 731:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 1707              		.loc 1 731 2 is_stmt 1 view .LVU494
 1708              	.L136:
 1709              		.loc 1 731 26 discriminator 1 view .LVU495
 1710              		.loc 1 731 8 discriminator 1 view .LVU496
 1711              		.loc 1 731 9 is_stmt 0 discriminator 1 view .LVU497
 1712 0036 084B     		ldr	r3, .L141
 1713 0038 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1714              		.loc 1 731 8 discriminator 1 view .LVU498
 1715 003a 002B     		cmp	r3, #0
 1716 003c FBD0     		beq	.L136
 1717              		.loc 1 731 27 is_stmt 1 discriminator 2 view .LVU499
 732:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 733:Core/Src/z_qflash_W25QXXX.c **** 
 734:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_AutoPolling(&FLASH_QSPI_PORT, &sCommand, &sConfig, QFLASH_BSY_TIMEOUT) != HAL_OK) 
 1718              		.loc 1 734 5 discriminator 2 view .LVU500
 1719              		.loc 1 734 9 is_stmt 0 discriminator 2 view .LVU501
 1720 003e 074B     		ldr	r3, .L141+4
 1721 0040 6A46     		mov	r2, sp
 1722 0042 06A9     		add	r1, sp, #24
 1723 0044 0648     		ldr	r0, .L141+8
 1724 0046 FFF7FEFF 		bl	HAL_QSPI_AutoPolling
 1725              	.LVL98:
 1726              		.loc 1 734 8 discriminator 2 view .LVU502
 1727 004a 10B9     		cbnz	r0, .L140
ARM GAS  /tmp/ccdMdDsR.s 			page 46


 1728              	.L137:
 735:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 736:Core/Src/z_qflash_W25QXXX.c ****     }
 737:Core/Src/z_qflash_W25QXXX.c **** 
 738:Core/Src/z_qflash_W25QXXX.c **** /* alternative implementation "SPI style"
 739:Core/Src/z_qflash_W25QXXX.c ****  * looping, directly  reading Status Register 1
 740:Core/Src/z_qflash_W25QXXX.c ****  * until Busy flag resets
 741:Core/Src/z_qflash_W25QXXX.c ****  * (k just count loops)
 742:Core/Src/z_qflash_W25QXXX.c ****  */
 743:Core/Src/z_qflash_W25QXXX.c **** /*
 744:Core/Src/z_qflash_W25QXXX.c **** 	uint8_t sr;
 745:Core/Src/z_qflash_W25QXXX.c ****     uint32_t k=0;
 746:Core/Src/z_qflash_W25QXXX.c **** 	do {
 747:Core/Src/z_qflash_W25QXXX.c **** 		sr=QFlash_ReadSR1();
 748:Core/Src/z_qflash_W25QXXX.c **** 		sr=(sr & 1);
 749:Core/Src/z_qflash_W25QXXX.c **** 		k+=1;
 750:Core/Src/z_qflash_W25QXXX.c **** 	}	while (sr);
 751:Core/Src/z_qflash_W25QXXX.c **** 
 752:Core/Src/z_qflash_W25QXXX.c **** */
 753:Core/Src/z_qflash_W25QXXX.c **** 
 754:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
 755:Core/Src/z_qflash_W25QXXX.c **** 
 756:Core/Src/z_qflash_W25QXXX.c **** }
 1729              		.loc 1 756 1 view .LVU503
 1730 004c 15B0     		add	sp, sp, #84
 1731              	.LCFI47:
 1732              		.cfi_remember_state
 1733              		.cfi_def_cfa_offset 4
 1734              		@ sp needed
 1735 004e 5DF804FB 		ldr	pc, [sp], #4
 1736              	.L140:
 1737              	.LCFI48:
 1738              		.cfi_restore_state
 735:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 1739              		.loc 1 735 16 view .LVU504
 1740 0052 0120     		movs	r0, #1
 1741 0054 FAE7     		b	.L137
 1742              	.L142:
 1743 0056 00BF     		.align	2
 1744              	.L141:
 1745 0058 00000000 		.word	.LANCHOR0
 1746 005c A0860100 		.word	100000
 1747 0060 00000000 		.word	hqspi
 1748              		.cfi_endproc
 1749              	.LFE162:
 1751              		.section	.text.QFlash_WriteSR2,"ax",%progbits
 1752              		.align	1
 1753              		.global	QFlash_WriteSR2
 1754              		.syntax unified
 1755              		.thumb
 1756              		.thumb_func
 1757              		.fpu fpv5-d16
 1759              	QFlash_WriteSR2:
 1760              	.LVL99:
 1761              	.LFB159:
 582:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1762              		.loc 1 582 49 is_stmt 1 view -0
ARM GAS  /tmp/ccdMdDsR.s 			page 47


 1763              		.cfi_startproc
 1764              		@ args = 0, pretend = 0, frame = 64
 1765              		@ frame_needed = 0, uses_anonymous_args = 0
 582:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1766              		.loc 1 582 49 is_stmt 0 view .LVU506
 1767 0000 10B5     		push	{r4, lr}
 1768              	.LCFI49:
 1769              		.cfi_def_cfa_offset 8
 1770              		.cfi_offset 4, -8
 1771              		.cfi_offset 14, -4
 1772 0002 90B0     		sub	sp, sp, #64
 1773              	.LCFI50:
 1774              		.cfi_def_cfa_offset 72
 1775 0004 8DF80700 		strb	r0, [sp, #7]
 583:Core/Src/z_qflash_W25QXXX.c **** 
 1776              		.loc 1 583 2 is_stmt 1 view .LVU507
 583:Core/Src/z_qflash_W25QXXX.c **** 
 1777              		.loc 1 583 22 is_stmt 0 view .LVU508
 1778 0008 3822     		movs	r2, #56
 1779 000a 0021     		movs	r1, #0
 1780 000c 02A8     		add	r0, sp, #8
 1781              	.LVL100:
 583:Core/Src/z_qflash_W25QXXX.c **** 
 1782              		.loc 1 583 22 view .LVU509
 1783 000e FFF7FEFF 		bl	memset
 1784              	.LVL101:
 585:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1785              		.loc 1 585 2 is_stmt 1 view .LVU510
 585:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1786              		.loc 1 585 6 is_stmt 0 view .LVU511
 1787 0012 FFF7FEFF 		bl	QFlash_WriteEnable
 1788              	.LVL102:
 585:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1789              		.loc 1 585 5 view .LVU512
 1790 0016 18B1     		cbz	r0, .L150
 586:Core/Src/z_qflash_W25QXXX.c **** 
 1791              		.loc 1 586 10 view .LVU513
 1792 0018 0124     		movs	r4, #1
 1793              	.L144:
 618:Core/Src/z_qflash_W25QXXX.c **** 
 1794              		.loc 1 618 1 view .LVU514
 1795 001a 2046     		mov	r0, r4
 1796 001c 10B0     		add	sp, sp, #64
 1797              	.LCFI51:
 1798              		.cfi_remember_state
 1799              		.cfi_def_cfa_offset 8
 1800              		@ sp needed
 1801 001e 10BD     		pop	{r4, pc}
 1802              	.L150:
 1803              	.LCFI52:
 1804              		.cfi_restore_state
 588:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_SR2;
 1805              		.loc 1 588 2 is_stmt 1 view .LVU515
 1806 0020 02A8     		add	r0, sp, #8
 1807 0022 FFF7FEFF 		bl	QFlash_DefaultCmd
 1808              	.LVL103:
 589:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
ARM GAS  /tmp/ccdMdDsR.s 			page 48


 1809              		.loc 1 589 2 view .LVU516
 589:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 1810              		.loc 1 589 23 is_stmt 0 view .LVU517
 1811 0026 3123     		movs	r3, #49
 1812 0028 0293     		str	r3, [sp, #8]
 590:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1813              		.loc 1 590 2 is_stmt 1 view .LVU518
 590:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1814              		.loc 1 590 22 is_stmt 0 view .LVU519
 1815 002a 4FF08073 		mov	r3, #16777216
 1816 002e 0B93     		str	r3, [sp, #44]
 591:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1817              		.loc 1 591 2 is_stmt 1 view .LVU520
 591:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1818              		.loc 1 591 23 is_stmt 0 view .LVU521
 1819 0030 0023     		movs	r3, #0
 1820 0032 0993     		str	r3, [sp, #36]
 592:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1821              		.loc 1 592 2 is_stmt 1 view .LVU522
 592:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1822              		.loc 1 592 23 is_stmt 0 view .LVU523
 1823 0034 0593     		str	r3, [sp, #20]
 593:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 1824              		.loc 1 593 2 is_stmt 1 view .LVU524
 593:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 1825              		.loc 1 593 20 is_stmt 0 view .LVU525
 1826 0036 0393     		str	r3, [sp, #12]
 594:Core/Src/z_qflash_W25QXXX.c **** 
 1827              		.loc 1 594 2 is_stmt 1 view .LVU526
 594:Core/Src/z_qflash_W25QXXX.c **** 
 1828              		.loc 1 594 20 is_stmt 0 view .LVU527
 1829 0038 0123     		movs	r3, #1
 1830 003a 0C93     		str	r3, [sp, #48]
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1831              		.loc 1 597 2 is_stmt 1 view .LVU528
 1832              	.L145:
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1833              		.loc 1 597 26 discriminator 1 view .LVU529
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1834              		.loc 1 597 8 discriminator 1 view .LVU530
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1835              		.loc 1 597 9 is_stmt 0 discriminator 1 view .LVU531
 1836 003c 0E4B     		ldr	r3, .L153
 1837 003e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1838              		.loc 1 597 8 discriminator 1 view .LVU532
 1839 0040 002B     		cmp	r3, #0
 1840 0042 FBD0     		beq	.L145
 597:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 1841              		.loc 1 597 27 is_stmt 1 discriminator 2 view .LVU533
 598:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 1842              		.loc 1 598 2 discriminator 2 view .LVU534
 598:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 1843              		.loc 1 598 15 is_stmt 0 discriminator 2 view .LVU535
 1844 0044 0023     		movs	r3, #0
 1845 0046 0C4A     		ldr	r2, .L153
 1846 0048 1370     		strb	r3, [r2]
ARM GAS  /tmp/ccdMdDsR.s 			page 49


 599:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 1847              		.loc 1 599 2 is_stmt 1 discriminator 2 view .LVU536
 599:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 1848              		.loc 1 599 23 is_stmt 0 discriminator 2 view .LVU537
 1849 004a 0C4A     		ldr	r2, .L153+4
 1850 004c 1370     		strb	r3, [r2]
 600:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1851              		.loc 1 600 2 is_stmt 1 discriminator 2 view .LVU538
 600:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1852              		.loc 1 600 6 is_stmt 0 discriminator 2 view .LVU539
 1853 004e 41F28832 		movw	r2, #5000
 1854 0052 02A9     		add	r1, sp, #8
 1855 0054 0A48     		ldr	r0, .L153+8
 1856 0056 FFF7FEFF 		bl	HAL_QSPI_Command
 1857              	.LVL104:
 600:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1858              		.loc 1 600 5 discriminator 2 view .LVU540
 1859 005a 08B1     		cbz	r0, .L151
 601:Core/Src/z_qflash_W25QXXX.c **** 	}
 1860              		.loc 1 601 10 view .LVU541
 1861 005c 0124     		movs	r4, #1
 1862 005e DCE7     		b	.L144
 1863              	.L151:
 603:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1864              		.loc 1 603 2 is_stmt 1 view .LVU542
 603:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1865              		.loc 1 603 6 is_stmt 0 view .LVU543
 1866 0060 0DF10701 		add	r1, sp, #7
 1867 0064 0648     		ldr	r0, .L153+8
 1868 0066 FFF7FEFF 		bl	HAL_QSPI_Transmit_DMA
 1869              	.LVL105:
 603:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1870              		.loc 1 603 5 view .LVU544
 1871 006a 0446     		mov	r4, r0
 1872 006c 08B1     		cbz	r0, .L152
 604:Core/Src/z_qflash_W25QXXX.c **** 	}
 1873              		.loc 1 604 10 view .LVU545
 1874 006e 0124     		movs	r4, #1
 1875 0070 D3E7     		b	.L144
 1876              	.L152:
 615:Core/Src/z_qflash_W25QXXX.c **** 
 1877              		.loc 1 615 2 is_stmt 1 view .LVU546
 1878 0072 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 1879              	.LVL106:
 617:Core/Src/z_qflash_W25QXXX.c **** }
 1880              		.loc 1 617 2 view .LVU547
 617:Core/Src/z_qflash_W25QXXX.c **** }
 1881              		.loc 1 617 9 is_stmt 0 view .LVU548
 1882 0076 D0E7     		b	.L144
 1883              	.L154:
 1884              		.align	2
 1885              	.L153:
 1886 0078 00000000 		.word	.LANCHOR0
 1887 007c 00000000 		.word	.LANCHOR1
 1888 0080 00000000 		.word	hqspi
 1889              		.cfi_endproc
 1890              	.LFE159:
ARM GAS  /tmp/ccdMdDsR.s 			page 50


 1892              		.section	.text.QFlash_WriteSR3,"ax",%progbits
 1893              		.align	1
 1894              		.global	QFlash_WriteSR3
 1895              		.syntax unified
 1896              		.thumb
 1897              		.thumb_func
 1898              		.fpu fpv5-d16
 1900              	QFlash_WriteSR3:
 1901              	.LVL107:
 1902              	.LFB160:
 624:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1903              		.loc 1 624 49 is_stmt 1 view -0
 1904              		.cfi_startproc
 1905              		@ args = 0, pretend = 0, frame = 64
 1906              		@ frame_needed = 0, uses_anonymous_args = 0
 624:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 1907              		.loc 1 624 49 is_stmt 0 view .LVU550
 1908 0000 10B5     		push	{r4, lr}
 1909              	.LCFI53:
 1910              		.cfi_def_cfa_offset 8
 1911              		.cfi_offset 4, -8
 1912              		.cfi_offset 14, -4
 1913 0002 90B0     		sub	sp, sp, #64
 1914              	.LCFI54:
 1915              		.cfi_def_cfa_offset 72
 1916 0004 8DF80700 		strb	r0, [sp, #7]
 625:Core/Src/z_qflash_W25QXXX.c **** 
 1917              		.loc 1 625 2 is_stmt 1 view .LVU551
 625:Core/Src/z_qflash_W25QXXX.c **** 
 1918              		.loc 1 625 22 is_stmt 0 view .LVU552
 1919 0008 3822     		movs	r2, #56
 1920 000a 0021     		movs	r1, #0
 1921 000c 02A8     		add	r0, sp, #8
 1922              	.LVL108:
 625:Core/Src/z_qflash_W25QXXX.c **** 
 1923              		.loc 1 625 22 view .LVU553
 1924 000e FFF7FEFF 		bl	memset
 1925              	.LVL109:
 627:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1926              		.loc 1 627 2 is_stmt 1 view .LVU554
 627:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1927              		.loc 1 627 6 is_stmt 0 view .LVU555
 1928 0012 FFF7FEFF 		bl	QFlash_WriteEnable
 1929              	.LVL110:
 627:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1930              		.loc 1 627 5 view .LVU556
 1931 0016 18B1     		cbz	r0, .L161
 628:Core/Src/z_qflash_W25QXXX.c **** 
 1932              		.loc 1 628 10 view .LVU557
 1933 0018 0124     		movs	r4, #1
 1934              	.L156:
 660:Core/Src/z_qflash_W25QXXX.c **** 
 1935              		.loc 1 660 1 view .LVU558
 1936 001a 2046     		mov	r0, r4
 1937 001c 10B0     		add	sp, sp, #64
 1938              	.LCFI55:
 1939              		.cfi_remember_state
ARM GAS  /tmp/ccdMdDsR.s 			page 51


 1940              		.cfi_def_cfa_offset 8
 1941              		@ sp needed
 1942 001e 10BD     		pop	{r4, pc}
 1943              	.L161:
 1944              	.LCFI56:
 1945              		.cfi_restore_state
 630:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_W_SR3;
 1946              		.loc 1 630 2 is_stmt 1 view .LVU559
 1947 0020 02A8     		add	r0, sp, #8
 1948 0022 FFF7FEFF 		bl	QFlash_DefaultCmd
 1949              	.LVL111:
 631:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 1950              		.loc 1 631 2 view .LVU560
 631:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.DataMode 		= QSPI_DATA_1_LINE;
 1951              		.loc 1 631 23 is_stmt 0 view .LVU561
 1952 0026 1123     		movs	r3, #17
 1953 0028 0293     		str	r3, [sp, #8]
 632:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1954              		.loc 1 632 2 is_stmt 1 view .LVU562
 632:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 1955              		.loc 1 632 22 is_stmt 0 view .LVU563
 1956 002a 4FF08073 		mov	r3, #16777216
 1957 002e 0B93     		str	r3, [sp, #44]
 633:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1958              		.loc 1 633 2 is_stmt 1 view .LVU564
 633:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressSize	= QSPI_ADDRESS_NONE;
 1959              		.loc 1 633 23 is_stmt 0 view .LVU565
 1960 0030 0023     		movs	r3, #0
 1961 0032 0993     		str	r3, [sp, #36]
 634:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1962              		.loc 1 634 2 is_stmt 1 view .LVU566
 634:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= 0x0;
 1963              		.loc 1 634 23 is_stmt 0 view .LVU567
 1964 0034 0593     		str	r3, [sp, #20]
 635:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 1965              		.loc 1 635 2 is_stmt 1 view .LVU568
 635:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= 1;
 1966              		.loc 1 635 20 is_stmt 0 view .LVU569
 1967 0036 0393     		str	r3, [sp, #12]
 636:Core/Src/z_qflash_W25QXXX.c **** 
 1968              		.loc 1 636 2 is_stmt 1 view .LVU570
 636:Core/Src/z_qflash_W25QXXX.c **** 
 1969              		.loc 1 636 20 is_stmt 0 view .LVU571
 1970 0038 0123     		movs	r3, #1
 1971 003a 0C93     		str	r3, [sp, #48]
 649:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1972              		.loc 1 649 2 is_stmt 1 view .LVU572
 649:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1973              		.loc 1 649 6 is_stmt 0 view .LVU573
 1974 003c 41F28832 		movw	r2, #5000
 1975 0040 02A9     		add	r1, sp, #8
 1976 0042 0A48     		ldr	r0, .L164
 1977 0044 FFF7FEFF 		bl	HAL_QSPI_Command
 1978              	.LVL112:
 649:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1979              		.loc 1 649 5 view .LVU574
 1980 0048 08B1     		cbz	r0, .L162
ARM GAS  /tmp/ccdMdDsR.s 			page 52


 650:Core/Src/z_qflash_W25QXXX.c **** 	}
 1981              		.loc 1 650 10 view .LVU575
 1982 004a 0124     		movs	r4, #1
 1983 004c E5E7     		b	.L156
 1984              	.L162:
 652:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1985              		.loc 1 652 2 is_stmt 1 view .LVU576
 652:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1986              		.loc 1 652 6 is_stmt 0 view .LVU577
 1987 004e 41F28832 		movw	r2, #5000
 1988 0052 0DF10701 		add	r1, sp, #7
 1989 0056 0548     		ldr	r0, .L164
 1990 0058 FFF7FEFF 		bl	HAL_QSPI_Transmit
 1991              	.LVL113:
 652:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 1992              		.loc 1 652 5 view .LVU578
 1993 005c 0446     		mov	r4, r0
 1994 005e 08B1     		cbz	r0, .L163
 653:Core/Src/z_qflash_W25QXXX.c **** 	}
 1995              		.loc 1 653 10 view .LVU579
 1996 0060 0124     		movs	r4, #1
 1997 0062 DAE7     		b	.L156
 1998              	.L163:
 657:Core/Src/z_qflash_W25QXXX.c **** 
 1999              		.loc 1 657 2 is_stmt 1 view .LVU580
 2000 0064 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2001              	.LVL114:
 659:Core/Src/z_qflash_W25QXXX.c **** }
 2002              		.loc 1 659 2 view .LVU581
 659:Core/Src/z_qflash_W25QXXX.c **** }
 2003              		.loc 1 659 9 is_stmt 0 view .LVU582
 2004 0068 D7E7     		b	.L156
 2005              	.L165:
 2006 006a 00BF     		.align	2
 2007              	.L164:
 2008 006c 00000000 		.word	hqspi
 2009              		.cfi_endproc
 2010              	.LFE160:
 2012              		.section	.text.QFlash_WriteASinglePage,"ax",%progbits
 2013              		.align	1
 2014              		.global	QFlash_WriteASinglePage
 2015              		.syntax unified
 2016              		.thumb
 2017              		.thumb_func
 2018              		.fpu fpv5-d16
 2020              	QFlash_WriteASinglePage:
 2021              	.LVL115:
 2022              	.LFB163:
 757:Core/Src/z_qflash_W25QXXX.c **** 
 758:Core/Src/z_qflash_W25QXXX.c **** 
 759:Core/Src/z_qflash_W25QXXX.c **** 
 760:Core/Src/z_qflash_W25QXXX.c **** 
 761:Core/Src/z_qflash_W25QXXX.c **** 
 762:Core/Src/z_qflash_W25QXXX.c **** 
 763:Core/Src/z_qflash_W25QXXX.c **** 
 764:Core/Src/z_qflash_W25QXXX.c **** /***********************************************************************
 765:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	it writes into a single FLASH page
ARM GAS  /tmp/ccdMdDsR.s 			page 53


 766:Core/Src/z_qflash_W25QXXX.c ****  * 			function doesn't check for the BUSY flag in SR1
 767:Core/Src/z_qflash_W25QXXX.c ****  * 			function doesn't check for the EEPROM writing enabled
 768:Core/Src/z_qflash_W25QXXX.c ****  * 			function doesn't wait for the writing complete
 769:Core/Src/z_qflash_W25QXXX.c ****  * 			function doesn't check for the EEPROM page boundary override
 770:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr		EEPROM address to start writing
 771:Core/Src/z_qflash_W25QXXX.c ****  *  		data		buffer containing data to write into EEPROM
 772:Core/Src/z_qflash_W25QXXX.c ****  * 			dataSize	number of bytes to write
 773:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************************************/
 774:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_WriteASinglePage(uint32_t addr, uint8_t* dataptr, uint16_t dataSize){
 2023              		.loc 1 774 94 is_stmt 1 view -0
 2024              		.cfi_startproc
 2025              		@ args = 0, pretend = 0, frame = 56
 2026              		@ frame_needed = 0, uses_anonymous_args = 0
 2027              		.loc 1 774 94 is_stmt 0 view .LVU584
 2028 0000 70B5     		push	{r4, r5, r6, lr}
 2029              	.LCFI57:
 2030              		.cfi_def_cfa_offset 16
 2031              		.cfi_offset 4, -16
 2032              		.cfi_offset 5, -12
 2033              		.cfi_offset 6, -8
 2034              		.cfi_offset 14, -4
 2035 0002 8EB0     		sub	sp, sp, #56
 2036              	.LCFI58:
 2037              		.cfi_def_cfa_offset 72
 2038 0004 0546     		mov	r5, r0
 2039 0006 0E46     		mov	r6, r1
 2040 0008 1446     		mov	r4, r2
 775:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2041              		.loc 1 775 2 is_stmt 1 view .LVU585
 2042              		.loc 1 775 22 is_stmt 0 view .LVU586
 2043 000a 3822     		movs	r2, #56
 2044              	.LVL116:
 2045              		.loc 1 775 22 view .LVU587
 2046 000c 0021     		movs	r1, #0
 2047              	.LVL117:
 2048              		.loc 1 775 22 view .LVU588
 2049 000e 6846     		mov	r0, sp
 2050              	.LVL118:
 2051              		.loc 1 775 22 view .LVU589
 2052 0010 FFF7FEFF 		bl	memset
 2053              	.LVL119:
 776:Core/Src/z_qflash_W25QXXX.c **** 
 777:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2054              		.loc 1 777 2 is_stmt 1 view .LVU590
 2055 0014 6846     		mov	r0, sp
 2056 0016 FFF7FEFF 		bl	QFlash_DefaultCmd
 2057              	.LVL120:
 778:Core/Src/z_qflash_W25QXXX.c **** 	if (!dataSize)
 2058              		.loc 1 778 2 view .LVU591
 2059              		.loc 1 778 5 is_stmt 0 view .LVU592
 2060 001a 14B3     		cbz	r4, .L169
 779:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_OK;
 780:Core/Src/z_qflash_W25QXXX.c **** 
 781:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Instruction	= QFLASH_WRITE_COMMAND;
 2061              		.loc 1 781 5 is_stmt 1 view .LVU593
 2062              		.loc 1 781 26 is_stmt 0 view .LVU594
 2063 001c 3223     		movs	r3, #50
ARM GAS  /tmp/ccdMdDsR.s 			page 54


 2064 001e 0093     		str	r3, [sp]
 782:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode	= QSPI_ADDRESS_1_LINE;
 2065              		.loc 1 782 2 is_stmt 1 view .LVU595
 2066              		.loc 1 782 23 is_stmt 0 view .LVU596
 2067 0020 4FF48063 		mov	r3, #1024
 2068 0024 0793     		str	r3, [sp, #28]
 783:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QFLASH_WDATA_MODE;
 2069              		.loc 1 783 5 is_stmt 1 view .LVU597
 2070              		.loc 1 783 25 is_stmt 0 view .LVU598
 2071 0026 4FF04073 		mov	r3, #50331648
 2072 002a 0993     		str	r3, [sp, #36]
 784:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData			= dataSize;
 2073              		.loc 1 784 2 is_stmt 1 view .LVU599
 2074              		.loc 1 784 20 is_stmt 0 view .LVU600
 2075 002c 0A94     		str	r4, [sp, #40]
 785:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address		= addr;
 2076              		.loc 1 785 2 is_stmt 1 view .LVU601
 2077              		.loc 1 785 20 is_stmt 0 view .LVU602
 2078 002e 0195     		str	r5, [sp, #4]
 786:Core/Src/z_qflash_W25QXXX.c **** 
 787:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 788:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 2079              		.loc 1 788 2 is_stmt 1 view .LVU603
 2080              	.L168:
 2081              		.loc 1 788 26 discriminator 1 view .LVU604
 2082              		.loc 1 788 8 discriminator 1 view .LVU605
 2083              		.loc 1 788 9 is_stmt 0 discriminator 1 view .LVU606
 2084 0030 0D4B     		ldr	r3, .L174
 2085 0032 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2086              		.loc 1 788 8 discriminator 1 view .LVU607
 2087 0034 002B     		cmp	r3, #0
 2088 0036 FBD0     		beq	.L168
 2089              		.loc 1 788 27 is_stmt 1 discriminator 2 view .LVU608
 789:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 2090              		.loc 1 789 2 discriminator 2 view .LVU609
 2091              		.loc 1 789 15 is_stmt 0 discriminator 2 view .LVU610
 2092 0038 0023     		movs	r3, #0
 2093 003a 0B4A     		ldr	r2, .L174
 2094 003c 1370     		strb	r3, [r2]
 790:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 2095              		.loc 1 790 2 is_stmt 1 discriminator 2 view .LVU611
 2096              		.loc 1 790 23 is_stmt 0 discriminator 2 view .LVU612
 2097 003e 0B4A     		ldr	r2, .L174+4
 2098 0040 1370     		strb	r3, [r2]
 791:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 2099              		.loc 1 791 5 is_stmt 1 discriminator 2 view .LVU613
 2100              		.loc 1 791 9 is_stmt 0 discriminator 2 view .LVU614
 2101 0042 41F28832 		movw	r2, #5000
 2102 0046 6946     		mov	r1, sp
 2103 0048 0948     		ldr	r0, .L174+8
 2104 004a FFF7FEFF 		bl	HAL_QSPI_Command
 2105              	.LVL121:
 2106              		.loc 1 791 8 discriminator 2 view .LVU615
 2107 004e 08B1     		cbz	r0, .L173
 792:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2108              		.loc 1 792 16 view .LVU616
 2109 0050 0120     		movs	r0, #1
ARM GAS  /tmp/ccdMdDsR.s 			page 55


 2110 0052 07E0     		b	.L167
 2111              	.L173:
 793:Core/Src/z_qflash_W25QXXX.c ****     }
 794:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Transmit_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
 2112              		.loc 1 794 5 is_stmt 1 view .LVU617
 2113              		.loc 1 794 9 is_stmt 0 view .LVU618
 2114 0054 3146     		mov	r1, r6
 2115 0056 0648     		ldr	r0, .L174+8
 2116 0058 FFF7FEFF 		bl	HAL_QSPI_Transmit_DMA
 2117              	.LVL122:
 2118              		.loc 1 794 8 view .LVU619
 2119 005c 10B1     		cbz	r0, .L167
 795:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 2120              		.loc 1 795 13 view .LVU620
 2121 005e 0120     		movs	r0, #1
 2122 0060 00E0     		b	.L167
 2123              	.L169:
 779:Core/Src/z_qflash_W25QXXX.c **** 
 2124              		.loc 1 779 10 view .LVU621
 2125 0062 0020     		movs	r0, #0
 2126              	.L167:
 796:Core/Src/z_qflash_W25QXXX.c ****     }
 797:Core/Src/z_qflash_W25QXXX.c **** #else
 798:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 799:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 800:Core/Src/z_qflash_W25QXXX.c ****     }
 801:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Transmit(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive da
 802:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 803:Core/Src/z_qflash_W25QXXX.c ****     }
 804:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 805:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 806:Core/Src/z_qflash_W25QXXX.c **** }
 2127              		.loc 1 806 1 view .LVU622
 2128 0064 0EB0     		add	sp, sp, #56
 2129              	.LCFI59:
 2130              		.cfi_def_cfa_offset 16
 2131              		@ sp needed
 2132 0066 70BD     		pop	{r4, r5, r6, pc}
 2133              	.LVL123:
 2134              	.L175:
 2135              		.loc 1 806 1 view .LVU623
 2136              		.align	2
 2137              	.L174:
 2138 0068 00000000 		.word	.LANCHOR0
 2139 006c 00000000 		.word	.LANCHOR1
 2140 0070 00000000 		.word	hqspi
 2141              		.cfi_endproc
 2142              	.LFE163:
 2144              		.section	.text.QFlash_Write,"ax",%progbits
 2145              		.align	1
 2146              		.global	QFlash_Write
 2147              		.syntax unified
 2148              		.thumb
 2149              		.thumb_func
 2150              		.fpu fpv5-d16
 2152              	QFlash_Write:
 2153              	.LVL124:
ARM GAS  /tmp/ccdMdDsR.s 			page 56


 2154              	.LFB164:
 807:Core/Src/z_qflash_W25QXXX.c **** 
 808:Core/Src/z_qflash_W25QXXX.c **** 
 809:Core/Src/z_qflash_W25QXXX.c **** 
 810:Core/Src/z_qflash_W25QXXX.c **** 
 811:Core/Src/z_qflash_W25QXXX.c **** /**********************************************************************
 812:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	function writing into EEPROM
 813:Core/Src/z_qflash_W25QXXX.c ****  * 			Handling "write enable" commands
 814:Core/Src/z_qflash_W25QXXX.c ****  * 			It splits (if needed) received data into the single pages,
 815:Core/Src/z_qflash_W25QXXX.c ****  * 			lounching writing sessions for each page
 816:Core/Src/z_qflash_W25QXXX.c ****  * 			and waiting the writing complete each time
 817:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr		EEPROM address to start writing
 818:Core/Src/z_qflash_W25QXXX.c ****  *  		data		buffer containing data to write into EEPROM
 819:Core/Src/z_qflash_W25QXXX.c ****  * 			dataSize	number of bytes to write
 820:Core/Src/z_qflash_W25QXXX.c ****  ***********************************************************************/
 821:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef  QFlash_Write(uint32_t addr, uint8_t* data, uint32_t dataSize){
 2155              		.loc 1 821 81 is_stmt 1 view -0
 2156              		.cfi_startproc
 2157              		@ args = 0, pretend = 0, frame = 0
 2158              		@ frame_needed = 0, uses_anonymous_args = 0
 2159              		.loc 1 821 81 is_stmt 0 view .LVU625
 2160 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2161              	.LCFI60:
 2162              		.cfi_def_cfa_offset 24
 2163              		.cfi_offset 4, -24
 2164              		.cfi_offset 5, -20
 2165              		.cfi_offset 6, -16
 2166              		.cfi_offset 7, -12
 2167              		.cfi_offset 8, -8
 2168              		.cfi_offset 14, -4
 822:Core/Src/z_qflash_W25QXXX.c **** uint32_t quota;
 2169              		.loc 1 822 1 is_stmt 1 view .LVU626
 823:Core/Src/z_qflash_W25QXXX.c **** uint32_t inpage_addr;
 2170              		.loc 1 823 1 view .LVU627
 824:Core/Src/z_qflash_W25QXXX.c **** 
 825:Core/Src/z_qflash_W25QXXX.c **** 	if (dataSize==0)
 2171              		.loc 1 825 2 view .LVU628
 2172              		.loc 1 825 5 is_stmt 0 view .LVU629
 2173 0004 B2B3     		cbz	r2, .L180
 2174 0006 0646     		mov	r6, r0
 2175 0008 0F46     		mov	r7, r1
 2176 000a 9046     		mov	r8, r2
 826:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_OK;
 827:Core/Src/z_qflash_W25QXXX.c **** 
 828:Core/Src/z_qflash_W25QXXX.c **** 	// quota is the data size transferred until now
 829:Core/Src/z_qflash_W25QXXX.c **** 	quota=0;
 2177              		.loc 1 829 2 is_stmt 1 view .LVU630
 2178              	.LVL125:
 830:Core/Src/z_qflash_W25QXXX.c **** 
 831:Core/Src/z_qflash_W25QXXX.c **** 	// define the starting write position inside the first Flash page to write...
 832:Core/Src/z_qflash_W25QXXX.c **** 	inpage_addr=addr & (EXT_FLASH_PAGE_SIZE-1);
 2179              		.loc 1 832 2 view .LVU631
 2180              		.loc 1 832 13 is_stmt 0 view .LVU632
 2181 000c C5B2     		uxtb	r5, r0
 2182              	.LVL126:
 833:Core/Src/z_qflash_W25QXXX.c **** 
 834:Core/Src/z_qflash_W25QXXX.c **** 	// ... so I can detect if more than 1 Flash page has still to be written
ARM GAS  /tmp/ccdMdDsR.s 			page 57


 835:Core/Src/z_qflash_W25QXXX.c **** 	while ((dataSize-quota+inpage_addr)>EXT_FLASH_PAGE_SIZE){
 2183              		.loc 1 835 2 is_stmt 1 view .LVU633
 829:Core/Src/z_qflash_W25QXXX.c **** 
 2184              		.loc 1 829 7 is_stmt 0 view .LVU634
 2185 000e 0024     		movs	r4, #0
 2186              		.loc 1 835 8 view .LVU635
 2187 0010 05E0     		b	.L178
 2188              	.LVL127:
 2189              	.L188:
 836:Core/Src/z_qflash_W25QXXX.c **** 	//loop here, writing separate flash pages...
 837:Core/Src/z_qflash_W25QXXX.c **** 
 838:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteEnable())
 839:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 840:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,EXT_FLASH_PAGE_SIZE-inpage_addr))
 841:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 842:Core/Src/z_qflash_W25QXXX.c **** 
 843:Core/Src/z_qflash_W25QXXX.c **** 		quota+=(EXT_FLASH_PAGE_SIZE-inpage_addr);
 2190              		.loc 1 843 3 is_stmt 1 view .LVU636
 2191              		.loc 1 843 8 is_stmt 0 view .LVU637
 2192 0012 641B     		subs	r4, r4, r5
 2193              	.LVL128:
 2194              		.loc 1 843 8 view .LVU638
 2195 0014 04F58074 		add	r4, r4, #256
 2196              	.LVL129:
 844:Core/Src/z_qflash_W25QXXX.c **** 		// having aligned data to page border on the first writing
 845:Core/Src/z_qflash_W25QXXX.c **** 		// next writings start from 0 position inside a page
 846:Core/Src/z_qflash_W25QXXX.c **** 		inpage_addr=0;
 2197              		.loc 1 846 3 is_stmt 1 view .LVU639
 847:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_WaitForWritingComplete();
 2198              		.loc 1 847 3 view .LVU640
 2199 0018 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2200              	.LVL130:
 846:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_WaitForWritingComplete();
 2201              		.loc 1 846 14 is_stmt 0 view .LVU641
 2202 001c 0025     		movs	r5, #0
 2203              	.LVL131:
 2204              	.L178:
 835:Core/Src/z_qflash_W25QXXX.c **** 	//loop here, writing separate flash pages...
 2205              		.loc 1 835 8 is_stmt 1 view .LVU642
 835:Core/Src/z_qflash_W25QXXX.c **** 	//loop here, writing separate flash pages...
 2206              		.loc 1 835 18 is_stmt 0 view .LVU643
 2207 001e A8EB0403 		sub	r3, r8, r4
 835:Core/Src/z_qflash_W25QXXX.c **** 	//loop here, writing separate flash pages...
 2208              		.loc 1 835 24 view .LVU644
 2209 0022 2B44     		add	r3, r3, r5
 835:Core/Src/z_qflash_W25QXXX.c **** 	//loop here, writing separate flash pages...
 2210              		.loc 1 835 8 view .LVU645
 2211 0024 B3F5807F 		cmp	r3, #256
 2212 0028 0DD9     		bls	.L187
 838:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2213              		.loc 1 838 3 is_stmt 1 view .LVU646
 838:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2214              		.loc 1 838 7 is_stmt 0 view .LVU647
 2215 002a FFF7FEFF 		bl	QFlash_WriteEnable
 2216              	.LVL132:
 838:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2217              		.loc 1 838 6 view .LVU648
ARM GAS  /tmp/ccdMdDsR.s 			page 58


 2218 002e 28BB     		cbnz	r0, .L181
 840:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2219              		.loc 1 840 3 is_stmt 1 view .LVU649
 840:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2220              		.loc 1 840 7 is_stmt 0 view .LVU650
 2221 0030 C5F58072 		rsb	r2, r5, #256
 2222 0034 92B2     		uxth	r2, r2
 2223 0036 3919     		adds	r1, r7, r4
 2224 0038 A019     		adds	r0, r4, r6
 2225 003a FFF7FEFF 		bl	QFlash_WriteASinglePage
 2226              	.LVL133:
 840:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2227              		.loc 1 840 6 view .LVU651
 2228 003e 0028     		cmp	r0, #0
 2229 0040 E7D0     		beq	.L188
 841:Core/Src/z_qflash_W25QXXX.c **** 
 2230              		.loc 1 841 11 view .LVU652
 2231 0042 0124     		movs	r4, #1
 2232              	.LVL134:
 841:Core/Src/z_qflash_W25QXXX.c **** 
 2233              		.loc 1 841 11 view .LVU653
 2234 0044 17E0     		b	.L177
 2235              	.LVL135:
 2236              	.L187:
 848:Core/Src/z_qflash_W25QXXX.c **** 	}
 849:Core/Src/z_qflash_W25QXXX.c **** 							// now just write the last Flash page...
 850:Core/Src/z_qflash_W25QXXX.c **** 	if (dataSize-quota) {	// ... if any
 2237              		.loc 1 850 2 is_stmt 1 view .LVU654
 2238              		.loc 1 850 5 is_stmt 0 view .LVU655
 2239 0046 4445     		cmp	r4, r8
 2240 0048 01D1     		bne	.L189
 851:Core/Src/z_qflash_W25QXXX.c **** 
 852:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteEnable())
 853:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 854:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,dataSize-quota))
 855:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 856:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_WaitForWritingComplete();
 857:Core/Src/z_qflash_W25QXXX.c **** 	}
 858:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 2241              		.loc 1 858 9 view .LVU656
 2242 004a 0024     		movs	r4, #0
 2243              	.LVL136:
 2244              		.loc 1 858 9 view .LVU657
 2245 004c 13E0     		b	.L177
 2246              	.LVL137:
 2247              	.L189:
 852:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2248              		.loc 1 852 3 is_stmt 1 view .LVU658
 852:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2249              		.loc 1 852 7 is_stmt 0 view .LVU659
 2250 004e FFF7FEFF 		bl	QFlash_WriteEnable
 2251              	.LVL138:
 852:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2252              		.loc 1 852 6 view .LVU660
 2253 0052 08B1     		cbz	r0, .L190
 853:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,dataSize-quota))
 2254              		.loc 1 853 11 view .LVU661
ARM GAS  /tmp/ccdMdDsR.s 			page 59


 2255 0054 0124     		movs	r4, #1
 2256              	.LVL139:
 853:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,dataSize-quota))
 2257              		.loc 1 853 11 view .LVU662
 2258 0056 0EE0     		b	.L177
 2259              	.LVL140:
 2260              	.L190:
 854:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2261              		.loc 1 854 3 is_stmt 1 view .LVU663
 854:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2262              		.loc 1 854 7 is_stmt 0 view .LVU664
 2263 0058 A8EB0402 		sub	r2, r8, r4
 2264 005c 92B2     		uxth	r2, r2
 2265 005e 3919     		adds	r1, r7, r4
 2266 0060 A019     		adds	r0, r4, r6
 2267 0062 FFF7FEFF 		bl	QFlash_WriteASinglePage
 2268              	.LVL141:
 854:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2269              		.loc 1 854 6 view .LVU665
 2270 0066 0446     		mov	r4, r0
 2271              	.LVL142:
 854:Core/Src/z_qflash_W25QXXX.c **** 			return HAL_ERROR;
 2272              		.loc 1 854 6 view .LVU666
 2273 0068 08B1     		cbz	r0, .L191
 855:Core/Src/z_qflash_W25QXXX.c **** 		QFlash_WaitForWritingComplete();
 2274              		.loc 1 855 11 view .LVU667
 2275 006a 0124     		movs	r4, #1
 2276 006c 03E0     		b	.L177
 2277              	.L191:
 856:Core/Src/z_qflash_W25QXXX.c **** 	}
 2278              		.loc 1 856 3 is_stmt 1 view .LVU668
 2279 006e FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2280              	.LVL143:
 2281 0072 00E0     		b	.L177
 2282              	.LVL144:
 2283              	.L180:
 826:Core/Src/z_qflash_W25QXXX.c **** 
 2284              		.loc 1 826 10 is_stmt 0 view .LVU669
 2285 0074 0024     		movs	r4, #0
 2286              	.LVL145:
 2287              	.L177:
 859:Core/Src/z_qflash_W25QXXX.c **** }
 2288              		.loc 1 859 1 view .LVU670
 2289 0076 2046     		mov	r0, r4
 2290 0078 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2291              	.LVL146:
 2292              	.L181:
 839:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,EXT_FLASH_PAGE_SIZE-inpage_addr))
 2293              		.loc 1 839 11 view .LVU671
 2294 007c 0124     		movs	r4, #1
 2295              	.LVL147:
 839:Core/Src/z_qflash_W25QXXX.c **** 		if (QFlash_WriteASinglePage(addr+quota,data+quota,EXT_FLASH_PAGE_SIZE-inpage_addr))
 2296              		.loc 1 839 11 view .LVU672
 2297 007e FAE7     		b	.L177
 2298              		.cfi_endproc
 2299              	.LFE164:
 2301              		.section	.text.QFlash_SErase4k,"ax",%progbits
ARM GAS  /tmp/ccdMdDsR.s 			page 60


 2302              		.align	1
 2303              		.global	QFlash_SErase4k
 2304              		.syntax unified
 2305              		.thumb
 2306              		.thumb_func
 2307              		.fpu fpv5-d16
 2309              	QFlash_SErase4k:
 2310              	.LVL148:
 2311              	.LFB165:
 860:Core/Src/z_qflash_W25QXXX.c **** 
 861:Core/Src/z_qflash_W25QXXX.c **** 
 862:Core/Src/z_qflash_W25QXXX.c **** 
 863:Core/Src/z_qflash_W25QXXX.c **** 
 864:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 865:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Erase to 0XFF all bytes in a 4k block
 866:Core/Src/z_qflash_W25QXXX.c ****  * 			4k block bounary is 0x1000, that means:
 867:Core/Src/z_qflash_W25QXXX.c ****  * 			0x1000, 0x2000, 0x3000, ...
 868:Core/Src/z_qflash_W25QXXX.c ****  * 			waiting the writing complete in each page
 869:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr	starting erase address
 870:Core/Src/z_qflash_W25QXXX.c ****  * 					(it must be a 4k sector boundary)
 871:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 872:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef  QFlash_SErase4k(uint32_t addr){
 2312              		.loc 1 872 50 is_stmt 1 view -0
 2313              		.cfi_startproc
 2314              		@ args = 0, pretend = 0, frame = 56
 2315              		@ frame_needed = 0, uses_anonymous_args = 0
 2316              		.loc 1 872 50 is_stmt 0 view .LVU674
 2317 0000 10B5     		push	{r4, lr}
 2318              	.LCFI61:
 2319              		.cfi_def_cfa_offset 8
 2320              		.cfi_offset 4, -8
 2321              		.cfi_offset 14, -4
 2322 0002 8EB0     		sub	sp, sp, #56
 2323              	.LCFI62:
 2324              		.cfi_def_cfa_offset 64
 2325 0004 0446     		mov	r4, r0
 873:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2326              		.loc 1 873 2 is_stmt 1 view .LVU675
 2327              		.loc 1 873 22 is_stmt 0 view .LVU676
 2328 0006 3822     		movs	r2, #56
 2329 0008 0021     		movs	r1, #0
 2330 000a 6846     		mov	r0, sp
 2331              	.LVL149:
 2332              		.loc 1 873 22 view .LVU677
 2333 000c FFF7FEFF 		bl	memset
 2334              	.LVL150:
 874:Core/Src/z_qflash_W25QXXX.c **** 
 875:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2335              		.loc 1 875 2 is_stmt 1 view .LVU678
 2336 0010 6846     		mov	r0, sp
 2337 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 2338              	.LVL151:
 876:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2339              		.loc 1 876 2 view .LVU679
 2340              		.loc 1 876 6 is_stmt 0 view .LVU680
 2341 0016 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2342              	.LVL152:
ARM GAS  /tmp/ccdMdDsR.s 			page 61


 2343              		.loc 1 876 5 view .LVU681
 2344 001a 10B1     		cbz	r0, .L200
 877:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2345              		.loc 1 877 10 view .LVU682
 2346 001c 0120     		movs	r0, #1
 2347              	.L193:
 878:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 879:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 880:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_S_ERASE4K;
 881:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 882:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 883:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 884:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 885:Core/Src/z_qflash_W25QXXX.c **** 
 886:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 887:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 888:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 889:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 890:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 891:Core/Src/z_qflash_W25QXXX.c ****     }
 892:Core/Src/z_qflash_W25QXXX.c **** 
 893:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 894:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 895:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 896:Core/Src/z_qflash_W25QXXX.c **** }
 2348              		.loc 1 896 1 view .LVU683
 2349 001e 0EB0     		add	sp, sp, #56
 2350              	.LCFI63:
 2351              		.cfi_remember_state
 2352              		.cfi_def_cfa_offset 8
 2353              		@ sp needed
 2354 0020 10BD     		pop	{r4, pc}
 2355              	.LVL153:
 2356              	.L200:
 2357              	.LCFI64:
 2358              		.cfi_restore_state
 878:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2359              		.loc 1 878 2 is_stmt 1 view .LVU684
 878:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2360              		.loc 1 878 6 is_stmt 0 view .LVU685
 2361 0022 FFF7FEFF 		bl	QFlash_WriteEnable
 2362              	.LVL154:
 878:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2363              		.loc 1 878 5 view .LVU686
 2364 0026 D8B9     		cbnz	r0, .L196
 880:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2365              		.loc 1 880 2 is_stmt 1 view .LVU687
 880:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2366              		.loc 1 880 23 is_stmt 0 view .LVU688
 2367 0028 2023     		movs	r3, #32
 2368 002a 0093     		str	r3, [sp]
 881:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2369              		.loc 1 881 5 is_stmt 1 view .LVU689
 881:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2370              		.loc 1 881 25 is_stmt 0 view .LVU690
 2371 002c 0023     		movs	r3, #0
 2372 002e 0993     		str	r3, [sp, #36]
ARM GAS  /tmp/ccdMdDsR.s 			page 62


 882:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2373              		.loc 1 882 2 is_stmt 1 view .LVU691
 882:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2374              		.loc 1 882 24 is_stmt 0 view .LVU692
 2375 0030 4FF48062 		mov	r2, #1024
 2376 0034 0792     		str	r2, [sp, #28]
 883:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2377              		.loc 1 883 2 is_stmt 1 view .LVU693
 883:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2378              		.loc 1 883 20 is_stmt 0 view .LVU694
 2379 0036 0A93     		str	r3, [sp, #40]
 884:Core/Src/z_qflash_W25QXXX.c **** 
 2380              		.loc 1 884 2 is_stmt 1 view .LVU695
 884:Core/Src/z_qflash_W25QXXX.c **** 
 2381              		.loc 1 884 21 is_stmt 0 view .LVU696
 2382 0038 0194     		str	r4, [sp, #4]
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2383              		.loc 1 887 2 is_stmt 1 view .LVU697
 2384              	.L194:
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2385              		.loc 1 887 26 discriminator 1 view .LVU698
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2386              		.loc 1 887 8 discriminator 1 view .LVU699
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2387              		.loc 1 887 9 is_stmt 0 discriminator 1 view .LVU700
 2388 003a 0A4B     		ldr	r3, .L202
 2389 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2390              		.loc 1 887 8 discriminator 1 view .LVU701
 2391 003e 002B     		cmp	r3, #0
 2392 0040 FBD0     		beq	.L194
 887:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2393              		.loc 1 887 27 is_stmt 1 discriminator 2 view .LVU702
 889:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2394              		.loc 1 889 5 discriminator 2 view .LVU703
 889:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2395              		.loc 1 889 9 is_stmt 0 discriminator 2 view .LVU704
 2396 0042 41F28832 		movw	r2, #5000
 2397 0046 6946     		mov	r1, sp
 2398 0048 0748     		ldr	r0, .L202+4
 2399 004a FFF7FEFF 		bl	HAL_QSPI_Command
 2400              	.LVL155:
 889:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2401              		.loc 1 889 8 discriminator 2 view .LVU705
 2402 004e 08B1     		cbz	r0, .L201
 890:Core/Src/z_qflash_W25QXXX.c ****     }
 2403              		.loc 1 890 16 view .LVU706
 2404 0050 0120     		movs	r0, #1
 2405 0052 E4E7     		b	.L193
 2406              	.L201:
 893:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2407              		.loc 1 893 2 is_stmt 1 view .LVU707
 893:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2408              		.loc 1 893 6 is_stmt 0 view .LVU708
 2409 0054 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2410              	.LVL156:
 893:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
ARM GAS  /tmp/ccdMdDsR.s 			page 63


 2411              		.loc 1 893 5 view .LVU709
 2412 0058 0028     		cmp	r0, #0
 2413 005a E0D0     		beq	.L193
 894:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 2414              		.loc 1 894 10 view .LVU710
 2415 005c 0120     		movs	r0, #1
 2416 005e DEE7     		b	.L193
 2417              	.L196:
 879:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_S_ERASE4K;
 2418              		.loc 1 879 10 view .LVU711
 2419 0060 0120     		movs	r0, #1
 2420 0062 DCE7     		b	.L193
 2421              	.L203:
 2422              		.align	2
 2423              	.L202:
 2424 0064 00000000 		.word	.LANCHOR0
 2425 0068 00000000 		.word	hqspi
 2426              		.cfi_endproc
 2427              	.LFE165:
 2429              		.section	.text.QFlash_BErase32k,"ax",%progbits
 2430              		.align	1
 2431              		.global	QFlash_BErase32k
 2432              		.syntax unified
 2433              		.thumb
 2434              		.thumb_func
 2435              		.fpu fpv5-d16
 2437              	QFlash_BErase32k:
 2438              	.LVL157:
 2439              	.LFB166:
 897:Core/Src/z_qflash_W25QXXX.c **** 
 898:Core/Src/z_qflash_W25QXXX.c **** 
 899:Core/Src/z_qflash_W25QXXX.c **** 
 900:Core/Src/z_qflash_W25QXXX.c **** 
 901:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 902:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Erase to 0XFF all bytes in a 32k block
 903:Core/Src/z_qflash_W25QXXX.c ****  * 			32k block bounary is 0x08000, that means:
 904:Core/Src/z_qflash_W25QXXX.c ****  * 			0x008000, 0x010000, 0x018000, ...
 905:Core/Src/z_qflash_W25QXXX.c ****  * 			waiting the writing complete in each page
 906:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr	starting erase address
 907:Core/Src/z_qflash_W25QXXX.c ****  * 					(it must be a 32k block boundary)
 908:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 909:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef  QFlash_BErase32k(uint32_t addr){
 2440              		.loc 1 909 51 is_stmt 1 view -0
 2441              		.cfi_startproc
 2442              		@ args = 0, pretend = 0, frame = 56
 2443              		@ frame_needed = 0, uses_anonymous_args = 0
 2444              		.loc 1 909 51 is_stmt 0 view .LVU713
 2445 0000 10B5     		push	{r4, lr}
 2446              	.LCFI65:
 2447              		.cfi_def_cfa_offset 8
 2448              		.cfi_offset 4, -8
 2449              		.cfi_offset 14, -4
 2450 0002 8EB0     		sub	sp, sp, #56
 2451              	.LCFI66:
 2452              		.cfi_def_cfa_offset 64
 2453 0004 0446     		mov	r4, r0
 910:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
ARM GAS  /tmp/ccdMdDsR.s 			page 64


 2454              		.loc 1 910 2 is_stmt 1 view .LVU714
 2455              		.loc 1 910 22 is_stmt 0 view .LVU715
 2456 0006 3822     		movs	r2, #56
 2457 0008 0021     		movs	r1, #0
 2458 000a 6846     		mov	r0, sp
 2459              	.LVL158:
 2460              		.loc 1 910 22 view .LVU716
 2461 000c FFF7FEFF 		bl	memset
 2462              	.LVL159:
 911:Core/Src/z_qflash_W25QXXX.c **** 
 912:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2463              		.loc 1 912 2 is_stmt 1 view .LVU717
 2464 0010 6846     		mov	r0, sp
 2465 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 2466              	.LVL160:
 913:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2467              		.loc 1 913 2 view .LVU718
 2468              		.loc 1 913 6 is_stmt 0 view .LVU719
 2469 0016 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2470              	.LVL161:
 2471              		.loc 1 913 5 view .LVU720
 2472 001a 10B1     		cbz	r0, .L212
 914:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2473              		.loc 1 914 10 view .LVU721
 2474 001c 0120     		movs	r0, #1
 2475              	.L205:
 915:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 916:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 917:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_B_ERASE32K;
 918:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 919:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 920:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 921:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 922:Core/Src/z_qflash_W25QXXX.c **** 
 923:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 924:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 925:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 926:Core/Src/z_qflash_W25QXXX.c **** 
 927:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 928:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 929:Core/Src/z_qflash_W25QXXX.c ****     }
 930:Core/Src/z_qflash_W25QXXX.c **** 
 931:Core/Src/z_qflash_W25QXXX.c ****     if (QFlash_WaitForWritingComplete())
 932:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 933:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 934:Core/Src/z_qflash_W25QXXX.c **** }
 2476              		.loc 1 934 1 view .LVU722
 2477 001e 0EB0     		add	sp, sp, #56
 2478              	.LCFI67:
 2479              		.cfi_remember_state
 2480              		.cfi_def_cfa_offset 8
 2481              		@ sp needed
 2482 0020 10BD     		pop	{r4, pc}
 2483              	.LVL162:
 2484              	.L212:
 2485              	.LCFI68:
 2486              		.cfi_restore_state
ARM GAS  /tmp/ccdMdDsR.s 			page 65


 915:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2487              		.loc 1 915 2 is_stmt 1 view .LVU723
 915:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2488              		.loc 1 915 6 is_stmt 0 view .LVU724
 2489 0022 FFF7FEFF 		bl	QFlash_WriteEnable
 2490              	.LVL163:
 915:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2491              		.loc 1 915 5 view .LVU725
 2492 0026 D8B9     		cbnz	r0, .L208
 917:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2493              		.loc 1 917 2 is_stmt 1 view .LVU726
 917:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2494              		.loc 1 917 23 is_stmt 0 view .LVU727
 2495 0028 5223     		movs	r3, #82
 2496 002a 0093     		str	r3, [sp]
 918:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2497              		.loc 1 918 5 is_stmt 1 view .LVU728
 918:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2498              		.loc 1 918 25 is_stmt 0 view .LVU729
 2499 002c 0023     		movs	r3, #0
 2500 002e 0993     		str	r3, [sp, #36]
 919:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2501              		.loc 1 919 2 is_stmt 1 view .LVU730
 919:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2502              		.loc 1 919 24 is_stmt 0 view .LVU731
 2503 0030 4FF48062 		mov	r2, #1024
 2504 0034 0792     		str	r2, [sp, #28]
 920:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2505              		.loc 1 920 2 is_stmt 1 view .LVU732
 920:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2506              		.loc 1 920 20 is_stmt 0 view .LVU733
 2507 0036 0A93     		str	r3, [sp, #40]
 921:Core/Src/z_qflash_W25QXXX.c **** 
 2508              		.loc 1 921 2 is_stmt 1 view .LVU734
 921:Core/Src/z_qflash_W25QXXX.c **** 
 2509              		.loc 1 921 21 is_stmt 0 view .LVU735
 2510 0038 0194     		str	r4, [sp, #4]
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2511              		.loc 1 924 2 is_stmt 1 view .LVU736
 2512              	.L206:
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2513              		.loc 1 924 26 discriminator 1 view .LVU737
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2514              		.loc 1 924 8 discriminator 1 view .LVU738
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2515              		.loc 1 924 9 is_stmt 0 discriminator 1 view .LVU739
 2516 003a 0A4B     		ldr	r3, .L214
 2517 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2518              		.loc 1 924 8 discriminator 1 view .LVU740
 2519 003e 002B     		cmp	r3, #0
 2520 0040 FBD0     		beq	.L206
 924:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2521              		.loc 1 924 27 is_stmt 1 discriminator 2 view .LVU741
 927:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2522              		.loc 1 927 2 discriminator 2 view .LVU742
 927:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
ARM GAS  /tmp/ccdMdDsR.s 			page 66


 2523              		.loc 1 927 6 is_stmt 0 discriminator 2 view .LVU743
 2524 0042 41F28832 		movw	r2, #5000
 2525 0046 6946     		mov	r1, sp
 2526 0048 0748     		ldr	r0, .L214+4
 2527 004a FFF7FEFF 		bl	HAL_QSPI_Command
 2528              	.LVL164:
 927:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2529              		.loc 1 927 5 discriminator 2 view .LVU744
 2530 004e 08B1     		cbz	r0, .L213
 928:Core/Src/z_qflash_W25QXXX.c ****     }
 2531              		.loc 1 928 16 view .LVU745
 2532 0050 0120     		movs	r0, #1
 2533 0052 E4E7     		b	.L205
 2534              	.L213:
 931:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2535              		.loc 1 931 5 is_stmt 1 view .LVU746
 931:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2536              		.loc 1 931 9 is_stmt 0 view .LVU747
 2537 0054 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2538              	.LVL165:
 931:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2539              		.loc 1 931 8 view .LVU748
 2540 0058 0028     		cmp	r0, #0
 2541 005a E0D0     		beq	.L205
 932:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 2542              		.loc 1 932 10 view .LVU749
 2543 005c 0120     		movs	r0, #1
 2544 005e DEE7     		b	.L205
 2545              	.L208:
 916:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_B_ERASE32K;
 2546              		.loc 1 916 10 view .LVU750
 2547 0060 0120     		movs	r0, #1
 2548 0062 DCE7     		b	.L205
 2549              	.L215:
 2550              		.align	2
 2551              	.L214:
 2552 0064 00000000 		.word	.LANCHOR0
 2553 0068 00000000 		.word	hqspi
 2554              		.cfi_endproc
 2555              	.LFE166:
 2557              		.section	.text.QFlash_BErase64k,"ax",%progbits
 2558              		.align	1
 2559              		.global	QFlash_BErase64k
 2560              		.syntax unified
 2561              		.thumb
 2562              		.thumb_func
 2563              		.fpu fpv5-d16
 2565              	QFlash_BErase64k:
 2566              	.LVL166:
 2567              	.LFB167:
 935:Core/Src/z_qflash_W25QXXX.c **** 
 936:Core/Src/z_qflash_W25QXXX.c **** 
 937:Core/Src/z_qflash_W25QXXX.c **** 
 938:Core/Src/z_qflash_W25QXXX.c **** 
 939:Core/Src/z_qflash_W25QXXX.c **** 
 940:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 941:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Erase to 0XFF all bytes in a 64k block
ARM GAS  /tmp/ccdMdDsR.s 			page 67


 942:Core/Src/z_qflash_W25QXXX.c ****  * 			64k block bounary is 0x08000, that means:
 943:Core/Src/z_qflash_W25QXXX.c ****  * 			0x010000, 0x020000, 0x030000, ...
 944:Core/Src/z_qflash_W25QXXX.c ****  * 			waiting the writing complete in each page
 945:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	addr	starting erase address
 946:Core/Src/z_qflash_W25QXXX.c ****  * 					(it must be a 64k block boundary)
 947:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 948:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_BErase64k(uint32_t addr){
 2568              		.loc 1 948 50 is_stmt 1 view -0
 2569              		.cfi_startproc
 2570              		@ args = 0, pretend = 0, frame = 56
 2571              		@ frame_needed = 0, uses_anonymous_args = 0
 2572              		.loc 1 948 50 is_stmt 0 view .LVU752
 2573 0000 10B5     		push	{r4, lr}
 2574              	.LCFI69:
 2575              		.cfi_def_cfa_offset 8
 2576              		.cfi_offset 4, -8
 2577              		.cfi_offset 14, -4
 2578 0002 8EB0     		sub	sp, sp, #56
 2579              	.LCFI70:
 2580              		.cfi_def_cfa_offset 64
 2581 0004 0446     		mov	r4, r0
 949:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2582              		.loc 1 949 2 is_stmt 1 view .LVU753
 2583              		.loc 1 949 22 is_stmt 0 view .LVU754
 2584 0006 3822     		movs	r2, #56
 2585 0008 0021     		movs	r1, #0
 2586 000a 6846     		mov	r0, sp
 2587              	.LVL167:
 2588              		.loc 1 949 22 view .LVU755
 2589 000c FFF7FEFF 		bl	memset
 2590              	.LVL168:
 950:Core/Src/z_qflash_W25QXXX.c **** 
 951:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2591              		.loc 1 951 2 is_stmt 1 view .LVU756
 2592 0010 6846     		mov	r0, sp
 2593 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 2594              	.LVL169:
 952:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2595              		.loc 1 952 2 view .LVU757
 2596              		.loc 1 952 6 is_stmt 0 view .LVU758
 2597 0016 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2598              	.LVL170:
 2599              		.loc 1 952 5 view .LVU759
 2600 001a 10B1     		cbz	r0, .L224
 953:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2601              		.loc 1 953 10 view .LVU760
 2602 001c 0120     		movs	r0, #1
 2603              	.L217:
 954:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 955:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 956:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_B_ERASE64K;
 957:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 958:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 959:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 960:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 961:Core/Src/z_qflash_W25QXXX.c **** 
 962:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
ARM GAS  /tmp/ccdMdDsR.s 			page 68


 963:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 964:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 965:Core/Src/z_qflash_W25QXXX.c **** 
 966:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 967:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 968:Core/Src/z_qflash_W25QXXX.c ****     }
 969:Core/Src/z_qflash_W25QXXX.c **** 
 970:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 971:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 972:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 973:Core/Src/z_qflash_W25QXXX.c **** }
 2604              		.loc 1 973 1 view .LVU761
 2605 001e 0EB0     		add	sp, sp, #56
 2606              	.LCFI71:
 2607              		.cfi_remember_state
 2608              		.cfi_def_cfa_offset 8
 2609              		@ sp needed
 2610 0020 10BD     		pop	{r4, pc}
 2611              	.LVL171:
 2612              	.L224:
 2613              	.LCFI72:
 2614              		.cfi_restore_state
 954:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2615              		.loc 1 954 2 is_stmt 1 view .LVU762
 954:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2616              		.loc 1 954 6 is_stmt 0 view .LVU763
 2617 0022 FFF7FEFF 		bl	QFlash_WriteEnable
 2618              	.LVL172:
 954:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 2619              		.loc 1 954 5 view .LVU764
 2620 0026 D8B9     		cbnz	r0, .L220
 956:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2621              		.loc 1 956 2 is_stmt 1 view .LVU765
 956:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2622              		.loc 1 956 23 is_stmt 0 view .LVU766
 2623 0028 D823     		movs	r3, #216
 2624 002a 0093     		str	r3, [sp]
 957:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2625              		.loc 1 957 5 is_stmt 1 view .LVU767
 957:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.AddressMode 	= QSPI_ADDRESS_1_LINE;
 2626              		.loc 1 957 25 is_stmt 0 view .LVU768
 2627 002c 0023     		movs	r3, #0
 2628 002e 0993     		str	r3, [sp, #36]
 958:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2629              		.loc 1 958 2 is_stmt 1 view .LVU769
 958:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.NbData 		= 0;
 2630              		.loc 1 958 24 is_stmt 0 view .LVU770
 2631 0030 4FF48062 		mov	r2, #1024
 2632 0034 0792     		str	r2, [sp, #28]
 959:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2633              		.loc 1 959 2 is_stmt 1 view .LVU771
 959:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Address 		= addr;
 2634              		.loc 1 959 20 is_stmt 0 view .LVU772
 2635 0036 0A93     		str	r3, [sp, #40]
 960:Core/Src/z_qflash_W25QXXX.c **** 
 2636              		.loc 1 960 2 is_stmt 1 view .LVU773
 960:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 69


 2637              		.loc 1 960 21 is_stmt 0 view .LVU774
 2638 0038 0194     		str	r4, [sp, #4]
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2639              		.loc 1 963 2 is_stmt 1 view .LVU775
 2640              	.L218:
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2641              		.loc 1 963 26 discriminator 1 view .LVU776
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2642              		.loc 1 963 8 discriminator 1 view .LVU777
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2643              		.loc 1 963 9 is_stmt 0 discriminator 1 view .LVU778
 2644 003a 0A4B     		ldr	r3, .L226
 2645 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2646              		.loc 1 963 8 discriminator 1 view .LVU779
 2647 003e 002B     		cmp	r3, #0
 2648 0040 FBD0     		beq	.L218
 963:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2649              		.loc 1 963 27 is_stmt 1 discriminator 2 view .LVU780
 966:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2650              		.loc 1 966 2 discriminator 2 view .LVU781
 966:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2651              		.loc 1 966 6 is_stmt 0 discriminator 2 view .LVU782
 2652 0042 41F28832 		movw	r2, #5000
 2653 0046 6946     		mov	r1, sp
 2654 0048 0748     		ldr	r0, .L226+4
 2655 004a FFF7FEFF 		bl	HAL_QSPI_Command
 2656              	.LVL173:
 966:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2657              		.loc 1 966 5 discriminator 2 view .LVU783
 2658 004e 08B1     		cbz	r0, .L225
 967:Core/Src/z_qflash_W25QXXX.c ****     }
 2659              		.loc 1 967 16 view .LVU784
 2660 0050 0120     		movs	r0, #1
 2661 0052 E4E7     		b	.L217
 2662              	.L225:
 970:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2663              		.loc 1 970 2 is_stmt 1 view .LVU785
 970:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2664              		.loc 1 970 6 is_stmt 0 view .LVU786
 2665 0054 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2666              	.LVL174:
 970:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2667              		.loc 1 970 5 view .LVU787
 2668 0058 0028     		cmp	r0, #0
 2669 005a E0D0     		beq	.L217
 971:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 2670              		.loc 1 971 10 view .LVU788
 2671 005c 0120     		movs	r0, #1
 2672 005e DEE7     		b	.L217
 2673              	.L220:
 955:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_B_ERASE64K;
 2674              		.loc 1 955 10 view .LVU789
 2675 0060 0120     		movs	r0, #1
 2676 0062 DCE7     		b	.L217
 2677              	.L227:
 2678              		.align	2
ARM GAS  /tmp/ccdMdDsR.s 			page 70


 2679              	.L226:
 2680 0064 00000000 		.word	.LANCHOR0
 2681 0068 00000000 		.word	hqspi
 2682              		.cfi_endproc
 2683              	.LFE167:
 2685              		.section	.text.QFlash_ChipErase,"ax",%progbits
 2686              		.align	1
 2687              		.global	QFlash_ChipErase
 2688              		.syntax unified
 2689              		.thumb
 2690              		.thumb_func
 2691              		.fpu fpv5-d16
 2693              	QFlash_ChipErase:
 2694              	.LFB168:
 974:Core/Src/z_qflash_W25QXXX.c **** 
 975:Core/Src/z_qflash_W25QXXX.c **** 
 976:Core/Src/z_qflash_W25QXXX.c **** 
 977:Core/Src/z_qflash_W25QXXX.c **** 
 978:Core/Src/z_qflash_W25QXXX.c **** /**********************************
 979:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Full chip erase to 0XFF
 980:Core/Src/z_qflash_W25QXXX.c ****  * 			Chip Erase may need up to 100s
 981:Core/Src/z_qflash_W25QXXX.c ****  * 			(typ. 20s)
 982:Core/Src/z_qflash_W25QXXX.c ****  * 			waiting the writing complete in each page
 983:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
 984:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ChipErase(){
 2695              		.loc 1 984 37 is_stmt 1 view -0
 2696              		.cfi_startproc
 2697              		@ args = 0, pretend = 0, frame = 56
 2698              		@ frame_needed = 0, uses_anonymous_args = 0
 2699 0000 00B5     		push	{lr}
 2700              	.LCFI73:
 2701              		.cfi_def_cfa_offset 4
 2702              		.cfi_offset 14, -4
 2703 0002 8FB0     		sub	sp, sp, #60
 2704              	.LCFI74:
 2705              		.cfi_def_cfa_offset 64
 985:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2706              		.loc 1 985 2 view .LVU791
 2707              		.loc 1 985 22 is_stmt 0 view .LVU792
 2708 0004 3822     		movs	r2, #56
 2709 0006 0021     		movs	r1, #0
 2710 0008 6846     		mov	r0, sp
 2711 000a FFF7FEFF 		bl	memset
 2712              	.LVL175:
 986:Core/Src/z_qflash_W25QXXX.c **** 
 987:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2713              		.loc 1 987 2 is_stmt 1 view .LVU793
 2714 000e 6846     		mov	r0, sp
 2715 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 2716              	.LVL176:
 988:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2717              		.loc 1 988 2 view .LVU794
 2718              		.loc 1 988 6 is_stmt 0 view .LVU795
 2719 0014 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2720              	.LVL177:
 2721              		.loc 1 988 5 view .LVU796
 2722 0018 18B1     		cbz	r0, .L236
ARM GAS  /tmp/ccdMdDsR.s 			page 71


 989:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2723              		.loc 1 989 10 view .LVU797
 2724 001a 0120     		movs	r0, #1
 2725              	.L229:
 990:Core/Src/z_qflash_W25QXXX.c **** 
 991:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WriteEnable())
 992:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 993:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_CH_ERASE;
 994:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 995:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 996:Core/Src/z_qflash_W25QXXX.c **** 
 997:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
 998:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 999:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
1000:Core/Src/z_qflash_W25QXXX.c **** 
1001:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
1002:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
1003:Core/Src/z_qflash_W25QXXX.c ****     }
1004:Core/Src/z_qflash_W25QXXX.c **** 
1005:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
1006:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
1007:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
1008:Core/Src/z_qflash_W25QXXX.c **** }
 2726              		.loc 1 1008 1 view .LVU798
 2727 001c 0FB0     		add	sp, sp, #60
 2728              	.LCFI75:
 2729              		.cfi_remember_state
 2730              		.cfi_def_cfa_offset 4
 2731              		@ sp needed
 2732 001e 5DF804FB 		ldr	pc, [sp], #4
 2733              	.L236:
 2734              	.LCFI76:
 2735              		.cfi_restore_state
 991:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2736              		.loc 1 991 2 is_stmt 1 view .LVU799
 991:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2737              		.loc 1 991 6 is_stmt 0 view .LVU800
 2738 0022 FFF7FEFF 		bl	QFlash_WriteEnable
 2739              	.LVL178:
 991:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2740              		.loc 1 991 5 view .LVU801
 2741 0026 B8B9     		cbnz	r0, .L232
 993:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2742              		.loc 1 993 2 is_stmt 1 view .LVU802
 993:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2743              		.loc 1 993 23 is_stmt 0 view .LVU803
 2744 0028 C723     		movs	r3, #199
 2745 002a 0093     		str	r3, [sp]
 994:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 2746              		.loc 1 994 5 is_stmt 1 view .LVU804
 994:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 2747              		.loc 1 994 25 is_stmt 0 view .LVU805
 2748 002c 0023     		movs	r3, #0
 2749 002e 0993     		str	r3, [sp, #36]
 995:Core/Src/z_qflash_W25QXXX.c **** 
 2750              		.loc 1 995 5 is_stmt 1 view .LVU806
 995:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 72


 2751              		.loc 1 995 26 is_stmt 0 view .LVU807
 2752 0030 0793     		str	r3, [sp, #28]
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2753              		.loc 1 998 2 is_stmt 1 view .LVU808
 2754              	.L230:
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2755              		.loc 1 998 26 discriminator 1 view .LVU809
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2756              		.loc 1 998 8 discriminator 1 view .LVU810
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2757              		.loc 1 998 9 is_stmt 0 discriminator 1 view .LVU811
 2758 0032 0A4B     		ldr	r3, .L238
 2759 0034 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2760              		.loc 1 998 8 discriminator 1 view .LVU812
 2761 0036 002B     		cmp	r3, #0
 2762 0038 FBD0     		beq	.L230
 998:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
 2763              		.loc 1 998 27 is_stmt 1 discriminator 2 view .LVU813
1001:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2764              		.loc 1 1001 5 discriminator 2 view .LVU814
1001:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2765              		.loc 1 1001 9 is_stmt 0 discriminator 2 view .LVU815
 2766 003a 41F28832 		movw	r2, #5000
 2767 003e 6946     		mov	r1, sp
 2768 0040 0748     		ldr	r0, .L238+4
 2769 0042 FFF7FEFF 		bl	HAL_QSPI_Command
 2770              	.LVL179:
1001:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2771              		.loc 1 1001 8 discriminator 2 view .LVU816
 2772 0046 08B1     		cbz	r0, .L237
1002:Core/Src/z_qflash_W25QXXX.c ****     }
 2773              		.loc 1 1002 16 view .LVU817
 2774 0048 0120     		movs	r0, #1
 2775 004a E7E7     		b	.L229
 2776              	.L237:
1005:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2777              		.loc 1 1005 2 is_stmt 1 view .LVU818
1005:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2778              		.loc 1 1005 6 is_stmt 0 view .LVU819
 2779 004c FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2780              	.LVL180:
1005:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
 2781              		.loc 1 1005 5 view .LVU820
 2782 0050 0028     		cmp	r0, #0
 2783 0052 E3D0     		beq	.L229
1006:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
 2784              		.loc 1 1006 10 view .LVU821
 2785 0054 0120     		movs	r0, #1
 2786 0056 E1E7     		b	.L229
 2787              	.L232:
 992:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_CH_ERASE;
 2788              		.loc 1 992 10 view .LVU822
 2789 0058 0120     		movs	r0, #1
 2790 005a DFE7     		b	.L229
 2791              	.L239:
 2792              		.align	2
ARM GAS  /tmp/ccdMdDsR.s 			page 73


 2793              	.L238:
 2794 005c 00000000 		.word	.LANCHOR0
 2795 0060 00000000 		.word	hqspi
 2796              		.cfi_endproc
 2797              	.LFE168:
 2799              		.section	.text.QFlash_PowerDown,"ax",%progbits
 2800              		.align	1
 2801              		.global	QFlash_PowerDown
 2802              		.syntax unified
 2803              		.thumb
 2804              		.thumb_func
 2805              		.fpu fpv5-d16
 2807              	QFlash_PowerDown:
 2808              	.LFB169:
1009:Core/Src/z_qflash_W25QXXX.c **** 
1010:Core/Src/z_qflash_W25QXXX.c **** 
1011:Core/Src/z_qflash_W25QXXX.c **** 
1012:Core/Src/z_qflash_W25QXXX.c **** 
1013:Core/Src/z_qflash_W25QXXX.c **** 
1014:Core/Src/z_qflash_W25QXXX.c **** /**********************************
1015:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Initiates a powerdown
1016:Core/Src/z_qflash_W25QXXX.c ****  * 			after a powerDown only accepted a porweUp command
1017:Core/Src/z_qflash_W25QXXX.c ****  * 			opwerDown operation is 3us long
1018:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
1019:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_PowerDown(){
 2809              		.loc 1 1019 37 is_stmt 1 view -0
 2810              		.cfi_startproc
 2811              		@ args = 0, pretend = 0, frame = 56
 2812              		@ frame_needed = 0, uses_anonymous_args = 0
 2813 0000 00B5     		push	{lr}
 2814              	.LCFI77:
 2815              		.cfi_def_cfa_offset 4
 2816              		.cfi_offset 14, -4
 2817 0002 8FB0     		sub	sp, sp, #60
 2818              	.LCFI78:
 2819              		.cfi_def_cfa_offset 64
1020:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2820              		.loc 1 1020 2 view .LVU824
 2821              		.loc 1 1020 22 is_stmt 0 view .LVU825
 2822 0004 3822     		movs	r2, #56
 2823 0006 0021     		movs	r1, #0
 2824 0008 6846     		mov	r0, sp
 2825 000a FFF7FEFF 		bl	memset
 2826              	.LVL181:
1021:Core/Src/z_qflash_W25QXXX.c **** 
1022:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 2827              		.loc 1 1022 2 is_stmt 1 view .LVU826
 2828 000e 6846     		mov	r0, sp
 2829 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 2830              	.LVL182:
1023:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2831              		.loc 1 1023 2 view .LVU827
 2832              		.loc 1 1023 6 is_stmt 0 view .LVU828
 2833 0014 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2834              	.LVL183:
 2835              		.loc 1 1023 5 view .LVU829
 2836 0018 90B9     		cbnz	r0, .L243
ARM GAS  /tmp/ccdMdDsR.s 			page 74


1024:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
1025:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_POWERDOWN;
 2837              		.loc 1 1025 2 is_stmt 1 view .LVU830
 2838              		.loc 1 1025 23 is_stmt 0 view .LVU831
 2839 001a B923     		movs	r3, #185
 2840 001c 0093     		str	r3, [sp]
1026:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2841              		.loc 1 1026 5 is_stmt 1 view .LVU832
 2842              		.loc 1 1026 25 is_stmt 0 view .LVU833
 2843 001e 0023     		movs	r3, #0
 2844 0020 0993     		str	r3, [sp, #36]
1027:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 2845              		.loc 1 1027 5 is_stmt 1 view .LVU834
 2846              		.loc 1 1027 26 is_stmt 0 view .LVU835
 2847 0022 0793     		str	r3, [sp, #28]
1028:Core/Src/z_qflash_W25QXXX.c **** 
1029:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
1030:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 2848              		.loc 1 1030 2 is_stmt 1 view .LVU836
 2849              	.L242:
 2850              		.loc 1 1030 26 discriminator 1 view .LVU837
 2851              		.loc 1 1030 8 discriminator 1 view .LVU838
 2852              		.loc 1 1030 9 is_stmt 0 discriminator 1 view .LVU839
 2853 0024 084B     		ldr	r3, .L247
 2854 0026 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2855              		.loc 1 1030 8 discriminator 1 view .LVU840
 2856 0028 002B     		cmp	r3, #0
 2857 002a FBD0     		beq	.L242
 2858              		.loc 1 1030 27 is_stmt 1 discriminator 2 view .LVU841
1031:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
1032:Core/Src/z_qflash_W25QXXX.c **** 
1033:Core/Src/z_qflash_W25QXXX.c **** 	if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send command
 2859              		.loc 1 1033 2 discriminator 2 view .LVU842
 2860              		.loc 1 1033 6 is_stmt 0 discriminator 2 view .LVU843
 2861 002c 41F28832 		movw	r2, #5000
 2862 0030 6946     		mov	r1, sp
 2863 0032 0648     		ldr	r0, .L247+4
 2864 0034 FFF7FEFF 		bl	HAL_QSPI_Command
 2865              	.LVL184:
 2866              		.loc 1 1033 5 discriminator 2 view .LVU844
 2867 0038 20B9     		cbnz	r0, .L246
 2868              	.L241:
1034:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
1035:Core/Src/z_qflash_W25QXXX.c ****     }
1036:Core/Src/z_qflash_W25QXXX.c **** 
1037:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
1038:Core/Src/z_qflash_W25QXXX.c **** }
 2869              		.loc 1 1038 1 view .LVU845
 2870 003a 0FB0     		add	sp, sp, #60
 2871              	.LCFI79:
 2872              		.cfi_remember_state
 2873              		.cfi_def_cfa_offset 4
 2874              		@ sp needed
 2875 003c 5DF804FB 		ldr	pc, [sp], #4
 2876              	.L243:
 2877              	.LCFI80:
 2878              		.cfi_restore_state
ARM GAS  /tmp/ccdMdDsR.s 			page 75


1024:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_POWERDOWN;
 2879              		.loc 1 1024 10 view .LVU846
 2880 0040 0120     		movs	r0, #1
 2881 0042 FAE7     		b	.L241
 2882              	.L246:
1034:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2883              		.loc 1 1034 16 view .LVU847
 2884 0044 0120     		movs	r0, #1
 2885 0046 F8E7     		b	.L241
 2886              	.L248:
 2887              		.align	2
 2888              	.L247:
 2889 0048 00000000 		.word	.LANCHOR0
 2890 004c 00000000 		.word	hqspi
 2891              		.cfi_endproc
 2892              	.LFE169:
 2894              		.section	.text.QFlash_PowerUp,"ax",%progbits
 2895              		.align	1
 2896              		.global	QFlash_PowerUp
 2897              		.syntax unified
 2898              		.thumb
 2899              		.thumb_func
 2900              		.fpu fpv5-d16
 2902              	QFlash_PowerUp:
 2903              	.LFB170:
1039:Core/Src/z_qflash_W25QXXX.c **** 
1040:Core/Src/z_qflash_W25QXXX.c **** 
1041:Core/Src/z_qflash_W25QXXX.c **** 
1042:Core/Src/z_qflash_W25QXXX.c **** 
1043:Core/Src/z_qflash_W25QXXX.c **** 
1044:Core/Src/z_qflash_W25QXXX.c **** 
1045:Core/Src/z_qflash_W25QXXX.c **** 
1046:Core/Src/z_qflash_W25QXXX.c **** /**********************************
1047:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	Release from powerdown (3 us to restart) or read device ID
1048:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
1049:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_PowerUp(){
 2904              		.loc 1 1049 35 is_stmt 1 view -0
 2905              		.cfi_startproc
 2906              		@ args = 0, pretend = 0, frame = 56
 2907              		@ frame_needed = 0, uses_anonymous_args = 0
 2908 0000 00B5     		push	{lr}
 2909              	.LCFI81:
 2910              		.cfi_def_cfa_offset 4
 2911              		.cfi_offset 14, -4
 2912 0002 8FB0     		sub	sp, sp, #60
 2913              	.LCFI82:
 2914              		.cfi_def_cfa_offset 64
1050:Core/Src/z_qflash_W25QXXX.c **** 	QSPI_CommandTypeDef sCommand = {0};
 2915              		.loc 1 1050 2 view .LVU849
 2916              		.loc 1 1050 22 is_stmt 0 view .LVU850
 2917 0004 3822     		movs	r2, #56
 2918 0006 0021     		movs	r1, #0
 2919 0008 6846     		mov	r0, sp
 2920 000a FFF7FEFF 		bl	memset
 2921              	.LVL185:
1051:Core/Src/z_qflash_W25QXXX.c **** 
1052:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
ARM GAS  /tmp/ccdMdDsR.s 			page 76


 2922              		.loc 1 1052 2 is_stmt 1 view .LVU851
 2923 000e 6846     		mov	r0, sp
 2924 0010 FFF7FEFF 		bl	QFlash_DefaultCmd
 2925              	.LVL186:
1053:Core/Src/z_qflash_W25QXXX.c **** 	if (QFlash_WaitForWritingComplete())
 2926              		.loc 1 1053 2 view .LVU852
 2927              		.loc 1 1053 6 is_stmt 0 view .LVU853
 2928 0014 FFF7FEFF 		bl	QFlash_WaitForWritingComplete
 2929              	.LVL187:
 2930              		.loc 1 1053 5 view .LVU854
 2931 0018 90B9     		cbnz	r0, .L252
1054:Core/Src/z_qflash_W25QXXX.c **** 		return HAL_ERROR;
1055:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_POWERUP_ID;
 2932              		.loc 1 1055 2 is_stmt 1 view .LVU855
 2933              		.loc 1 1055 23 is_stmt 0 view .LVU856
 2934 001a AB23     		movs	r3, #171
 2935 001c 0093     		str	r3, [sp]
1056:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_NONE;
 2936              		.loc 1 1056 5 is_stmt 1 view .LVU857
 2937              		.loc 1 1056 25 is_stmt 0 view .LVU858
 2938 001e 0023     		movs	r3, #0
 2939 0020 0993     		str	r3, [sp, #36]
1057:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_NONE;
 2940              		.loc 1 1057 5 is_stmt 1 view .LVU859
 2941              		.loc 1 1057 26 is_stmt 0 view .LVU860
 2942 0022 0793     		str	r3, [sp, #28]
1058:Core/Src/z_qflash_W25QXXX.c **** 
1059:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
1060:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 2943              		.loc 1 1060 2 is_stmt 1 view .LVU861
 2944              	.L251:
 2945              		.loc 1 1060 26 discriminator 1 view .LVU862
 2946              		.loc 1 1060 8 discriminator 1 view .LVU863
 2947              		.loc 1 1060 9 is_stmt 0 discriminator 1 view .LVU864
 2948 0024 084B     		ldr	r3, .L256
 2949 0026 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2950              		.loc 1 1060 8 discriminator 1 view .LVU865
 2951 0028 002B     		cmp	r3, #0
 2952 002a FBD0     		beq	.L251
 2953              		.loc 1 1060 27 is_stmt 1 discriminator 2 view .LVU866
1061:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
1062:Core/Src/z_qflash_W25QXXX.c **** 
1063:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 2954              		.loc 1 1063 5 discriminator 2 view .LVU867
 2955              		.loc 1 1063 9 is_stmt 0 discriminator 2 view .LVU868
 2956 002c 41F28832 		movw	r2, #5000
 2957 0030 6946     		mov	r1, sp
 2958 0032 0648     		ldr	r0, .L256+4
 2959 0034 FFF7FEFF 		bl	HAL_QSPI_Command
 2960              	.LVL188:
 2961              		.loc 1 1063 8 discriminator 2 view .LVU869
 2962 0038 20B9     		cbnz	r0, .L255
 2963              	.L250:
1064:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
1065:Core/Src/z_qflash_W25QXXX.c ****     }
1066:Core/Src/z_qflash_W25QXXX.c **** 
1067:Core/Src/z_qflash_W25QXXX.c ****     return HAL_OK;
ARM GAS  /tmp/ccdMdDsR.s 			page 77


1068:Core/Src/z_qflash_W25QXXX.c **** }
 2964              		.loc 1 1068 1 view .LVU870
 2965 003a 0FB0     		add	sp, sp, #60
 2966              	.LCFI83:
 2967              		.cfi_remember_state
 2968              		.cfi_def_cfa_offset 4
 2969              		@ sp needed
 2970 003c 5DF804FB 		ldr	pc, [sp], #4
 2971              	.L252:
 2972              	.LCFI84:
 2973              		.cfi_restore_state
1054:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_POWERUP_ID;
 2974              		.loc 1 1054 10 view .LVU871
 2975 0040 0120     		movs	r0, #1
 2976 0042 FAE7     		b	.L250
 2977              	.L255:
1064:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 2978              		.loc 1 1064 16 view .LVU872
 2979 0044 0120     		movs	r0, #1
 2980 0046 F8E7     		b	.L250
 2981              	.L257:
 2982              		.align	2
 2983              	.L256:
 2984 0048 00000000 		.word	.LANCHOR0
 2985 004c 00000000 		.word	hqspi
 2986              		.cfi_endproc
 2987              	.LFE170:
 2989              		.section	.text.QFlash_ReadDevID,"ax",%progbits
 2990              		.align	1
 2991              		.global	QFlash_ReadDevID
 2992              		.syntax unified
 2993              		.thumb
 2994              		.thumb_func
 2995              		.fpu fpv5-d16
 2997              	QFlash_ReadDevID:
 2998              	.LVL189:
 2999              	.LFB171:
1069:Core/Src/z_qflash_W25QXXX.c **** 
1070:Core/Src/z_qflash_W25QXXX.c **** 
1071:Core/Src/z_qflash_W25QXXX.c **** 
1072:Core/Src/z_qflash_W25QXXX.c **** 
1073:Core/Src/z_qflash_W25QXXX.c **** /**********************************
1074:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	read device id from chip
1075:Core/Src/z_qflash_W25QXXX.c ****  * @PARAM	dataptr	receives Device ID
1076:Core/Src/z_qflash_W25QXXX.c ****  *********************************/
1077:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadDevID(uint8_t *dataptr){
 3000              		.loc 1 1077 53 is_stmt 1 view -0
 3001              		.cfi_startproc
 3002              		@ args = 0, pretend = 0, frame = 56
 3003              		@ frame_needed = 0, uses_anonymous_args = 0
 3004              		.loc 1 1077 53 is_stmt 0 view .LVU874
 3005 0000 10B5     		push	{r4, lr}
 3006              	.LCFI85:
 3007              		.cfi_def_cfa_offset 8
 3008              		.cfi_offset 4, -8
 3009              		.cfi_offset 14, -4
 3010 0002 8EB0     		sub	sp, sp, #56
ARM GAS  /tmp/ccdMdDsR.s 			page 78


 3011              	.LCFI86:
 3012              		.cfi_def_cfa_offset 64
 3013 0004 0446     		mov	r4, r0
1078:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 3014              		.loc 1 1078 1 is_stmt 1 view .LVU875
 3015              		.loc 1 1078 21 is_stmt 0 view .LVU876
 3016 0006 3822     		movs	r2, #56
 3017 0008 0021     		movs	r1, #0
 3018 000a 6846     		mov	r0, sp
 3019              	.LVL190:
 3020              		.loc 1 1078 21 view .LVU877
 3021 000c FFF7FEFF 		bl	memset
 3022              	.LVL191:
1079:Core/Src/z_qflash_W25QXXX.c **** 
1080:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 3023              		.loc 1 1080 2 is_stmt 1 view .LVU878
 3024 0010 6846     		mov	r0, sp
 3025 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 3026              	.LVL192:
1081:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_POWERUP_ID;
 3027              		.loc 1 1081 2 view .LVU879
 3028              		.loc 1 1081 23 is_stmt 0 view .LVU880
 3029 0016 AB23     		movs	r3, #171
 3030 0018 0093     		str	r3, [sp]
1082:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
 3031              		.loc 1 1082 5 is_stmt 1 view .LVU881
 3032              		.loc 1 1082 25 is_stmt 0 view .LVU882
 3033 001a 4FF08073 		mov	r3, #16777216
 3034 001e 0993     		str	r3, [sp, #36]
1083:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_1_LINE;
 3035              		.loc 1 1083 5 is_stmt 1 view .LVU883
 3036              		.loc 1 1083 26 is_stmt 0 view .LVU884
 3037 0020 4FF48063 		mov	r3, #1024
 3038 0024 0793     		str	r3, [sp, #28]
1084:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressSize 	= QSPI_ADDRESS_24_BITS;  // I need to send 3 dummy bytes avter command
 3039              		.loc 1 1084 5 is_stmt 1 view .LVU885
 3040              		.loc 1 1084 27 is_stmt 0 view .LVU886
 3041 0026 4FF40053 		mov	r3, #8192
 3042 002a 0393     		str	r3, [sp, #12]
1085:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address		= 0;
 3043              		.loc 1 1085 5 is_stmt 1 view .LVU887
 3044              		.loc 1 1085 23 is_stmt 0 view .LVU888
 3045 002c 0023     		movs	r3, #0
 3046 002e 0193     		str	r3, [sp, #4]
1086:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 1; //after 3 dummy bytes I can read the Device ID
 3047              		.loc 1 1086 5 is_stmt 1 view .LVU889
 3048              		.loc 1 1086 23 is_stmt 0 view .LVU890
 3049 0030 0122     		movs	r2, #1
 3050 0032 0A92     		str	r2, [sp, #40]
1087:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 	= 0;
 3051              		.loc 1 1087 5 is_stmt 1 view .LVU891
 3052              		.loc 1 1087 27 is_stmt 0 view .LVU892
 3053 0034 0593     		str	r3, [sp, #20]
1088:Core/Src/z_qflash_W25QXXX.c **** 
1089:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
1090:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 3054              		.loc 1 1090 2 is_stmt 1 view .LVU893
ARM GAS  /tmp/ccdMdDsR.s 			page 79


 3055              	.L259:
 3056              		.loc 1 1090 26 discriminator 1 view .LVU894
 3057              		.loc 1 1090 8 discriminator 1 view .LVU895
 3058              		.loc 1 1090 9 is_stmt 0 discriminator 1 view .LVU896
 3059 0036 0F4B     		ldr	r3, .L266
 3060 0038 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3061              		.loc 1 1090 8 discriminator 1 view .LVU897
 3062 003a 002B     		cmp	r3, #0
 3063 003c FBD0     		beq	.L259
 3064              		.loc 1 1090 27 is_stmt 1 discriminator 2 view .LVU898
1091:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 3065              		.loc 1 1091 2 discriminator 2 view .LVU899
 3066              		.loc 1 1091 15 is_stmt 0 discriminator 2 view .LVU900
 3067 003e 0023     		movs	r3, #0
 3068 0040 0C4A     		ldr	r2, .L266
 3069 0042 1370     		strb	r3, [r2]
1092:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 3070              		.loc 1 1092 2 is_stmt 1 discriminator 2 view .LVU901
 3071              		.loc 1 1092 23 is_stmt 0 discriminator 2 view .LVU902
 3072 0044 0C4A     		ldr	r2, .L266+4
 3073 0046 1370     		strb	r3, [r2]
1093:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 3074              		.loc 1 1093 5 is_stmt 1 discriminator 2 view .LVU903
 3075              		.loc 1 1093 9 is_stmt 0 discriminator 2 view .LVU904
 3076 0048 41F28832 		movw	r2, #5000
 3077 004c 6946     		mov	r1, sp
 3078 004e 0B48     		ldr	r0, .L266+8
 3079 0050 FFF7FEFF 		bl	HAL_QSPI_Command
 3080              	.LVL193:
 3081              		.loc 1 1093 8 discriminator 2 view .LVU905
 3082 0054 18B1     		cbz	r0, .L264
1094:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 3083              		.loc 1 1094 16 view .LVU906
 3084 0056 0124     		movs	r4, #1
 3085              	.LVL194:
 3086              	.L260:
1095:Core/Src/z_qflash_W25QXXX.c ****     }
1096:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, dataptr) != HAL_OK) { // Receive data
1097:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
1098:Core/Src/z_qflash_W25QXXX.c ****     }
1099:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
1100:Core/Src/z_qflash_W25QXXX.c **** #else
1101:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
1102:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
1103:Core/Src/z_qflash_W25QXXX.c ****     }
1104:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { // Receive dat
1105:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
1106:Core/Src/z_qflash_W25QXXX.c ****     }
1107:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
1108:Core/Src/z_qflash_W25QXXX.c **** 
1109:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
1110:Core/Src/z_qflash_W25QXXX.c **** }
 3087              		.loc 1 1110 1 view .LVU907
 3088 0058 2046     		mov	r0, r4
 3089 005a 0EB0     		add	sp, sp, #56
 3090              	.LCFI87:
 3091              		.cfi_remember_state
ARM GAS  /tmp/ccdMdDsR.s 			page 80


 3092              		.cfi_def_cfa_offset 8
 3093              		@ sp needed
 3094 005c 10BD     		pop	{r4, pc}
 3095              	.LVL195:
 3096              	.L264:
 3097              	.LCFI88:
 3098              		.cfi_restore_state
1096:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3099              		.loc 1 1096 5 is_stmt 1 view .LVU908
1096:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3100              		.loc 1 1096 9 is_stmt 0 view .LVU909
 3101 005e 2146     		mov	r1, r4
 3102 0060 0648     		ldr	r0, .L266+8
 3103 0062 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 3104              	.LVL196:
1096:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3105              		.loc 1 1096 8 view .LVU910
 3106 0066 0446     		mov	r4, r0
 3107              	.LVL197:
1096:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3108              		.loc 1 1096 8 view .LVU911
 3109 0068 08B1     		cbz	r0, .L265
1097:Core/Src/z_qflash_W25QXXX.c ****     }
 3110              		.loc 1 1097 13 view .LVU912
 3111 006a 0124     		movs	r4, #1
 3112 006c F4E7     		b	.L260
 3113              	.L265:
1099:Core/Src/z_qflash_W25QXXX.c **** #else
 3114              		.loc 1 1099 2 is_stmt 1 view .LVU913
 3115 006e FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 3116              	.LVL198:
1109:Core/Src/z_qflash_W25QXXX.c **** }
 3117              		.loc 1 1109 2 view .LVU914
1109:Core/Src/z_qflash_W25QXXX.c **** }
 3118              		.loc 1 1109 9 is_stmt 0 view .LVU915
 3119 0072 F1E7     		b	.L260
 3120              	.L267:
 3121              		.align	2
 3122              	.L266:
 3123 0074 00000000 		.word	.LANCHOR0
 3124 0078 00000000 		.word	.LANCHOR1
 3125 007c 00000000 		.word	hqspi
 3126              		.cfi_endproc
 3127              	.LFE171:
 3129              		.section	.text.QFlash_ReadManufactutrerAndDevID,"ax",%progbits
 3130              		.align	1
 3131              		.global	QFlash_ReadManufactutrerAndDevID
 3132              		.syntax unified
 3133              		.thumb
 3134              		.thumb_func
 3135              		.fpu fpv5-d16
 3137              	QFlash_ReadManufactutrerAndDevID:
 3138              	.LVL199:
 3139              	.LFB172:
1111:Core/Src/z_qflash_W25QXXX.c **** 
1112:Core/Src/z_qflash_W25QXXX.c **** 
1113:Core/Src/z_qflash_W25QXXX.c **** 
ARM GAS  /tmp/ccdMdDsR.s 			page 81


1114:Core/Src/z_qflash_W25QXXX.c **** 
1115:Core/Src/z_qflash_W25QXXX.c **** 
1116:Core/Src/z_qflash_W25QXXX.c **** HAL_StatusTypeDef QFlash_ReadManufactutrerAndDevID(uint16_t *dataptr) {
 3140              		.loc 1 1116 71 is_stmt 1 view -0
 3141              		.cfi_startproc
 3142              		@ args = 0, pretend = 0, frame = 56
 3143              		@ frame_needed = 0, uses_anonymous_args = 0
 3144              		.loc 1 1116 71 is_stmt 0 view .LVU917
 3145 0000 10B5     		push	{r4, lr}
 3146              	.LCFI89:
 3147              		.cfi_def_cfa_offset 8
 3148              		.cfi_offset 4, -8
 3149              		.cfi_offset 14, -4
 3150 0002 8EB0     		sub	sp, sp, #56
 3151              	.LCFI90:
 3152              		.cfi_def_cfa_offset 64
 3153 0004 0446     		mov	r4, r0
1117:Core/Src/z_qflash_W25QXXX.c **** QSPI_CommandTypeDef sCommand = {0};
 3154              		.loc 1 1117 1 is_stmt 1 view .LVU918
 3155              		.loc 1 1117 21 is_stmt 0 view .LVU919
 3156 0006 3822     		movs	r2, #56
 3157 0008 0021     		movs	r1, #0
 3158 000a 6846     		mov	r0, sp
 3159              	.LVL200:
 3160              		.loc 1 1117 21 view .LVU920
 3161 000c FFF7FEFF 		bl	memset
 3162              	.LVL201:
1118:Core/Src/z_qflash_W25QXXX.c **** 
1119:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_DefaultCmd(&sCommand);
 3163              		.loc 1 1119 2 is_stmt 1 view .LVU921
 3164 0010 6846     		mov	r0, sp
 3165 0012 FFF7FEFF 		bl	QFlash_DefaultCmd
 3166              	.LVL202:
1120:Core/Src/z_qflash_W25QXXX.c **** 	sCommand.Instruction	= W25_MAN_DEVICE_ID;
 3167              		.loc 1 1120 2 view .LVU922
 3168              		.loc 1 1120 23 is_stmt 0 view .LVU923
 3169 0016 9023     		movs	r3, #144
 3170 0018 0093     		str	r3, [sp]
1121:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DataMode 		= QSPI_DATA_1_LINE;
 3171              		.loc 1 1121 5 is_stmt 1 view .LVU924
 3172              		.loc 1 1121 25 is_stmt 0 view .LVU925
 3173 001a 4FF08073 		mov	r3, #16777216
 3174 001e 0993     		str	r3, [sp, #36]
1122:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressMode	= QSPI_ADDRESS_1_LINE;
 3175              		.loc 1 1122 5 is_stmt 1 view .LVU926
 3176              		.loc 1 1122 26 is_stmt 0 view .LVU927
 3177 0020 4FF48063 		mov	r3, #1024
 3178 0024 0793     		str	r3, [sp, #28]
1123:Core/Src/z_qflash_W25QXXX.c ****     sCommand.AddressSize 	= QSPI_ADDRESS_24_BITS;  // I need to send 3 dummy bytes avter command
 3179              		.loc 1 1123 5 is_stmt 1 view .LVU928
 3180              		.loc 1 1123 27 is_stmt 0 view .LVU929
 3181 0026 4FF40053 		mov	r3, #8192
 3182 002a 0393     		str	r3, [sp, #12]
1124:Core/Src/z_qflash_W25QXXX.c ****     sCommand.Address		= 0;
 3183              		.loc 1 1124 5 is_stmt 1 view .LVU930
 3184              		.loc 1 1124 23 is_stmt 0 view .LVU931
 3185 002c 0023     		movs	r3, #0
ARM GAS  /tmp/ccdMdDsR.s 			page 82


 3186 002e 0193     		str	r3, [sp, #4]
1125:Core/Src/z_qflash_W25QXXX.c ****     sCommand.NbData			= 2; //after 3 dummy bytes I can read the Device ID
 3187              		.loc 1 1125 5 is_stmt 1 view .LVU932
 3188              		.loc 1 1125 23 is_stmt 0 view .LVU933
 3189 0030 0222     		movs	r2, #2
 3190 0032 0A92     		str	r2, [sp, #40]
1126:Core/Src/z_qflash_W25QXXX.c ****     sCommand.DummyCycles 	= 0;
 3191              		.loc 1 1126 5 is_stmt 1 view .LVU934
 3192              		.loc 1 1126 27 is_stmt 0 view .LVU935
 3193 0034 0593     		str	r3, [sp, #20]
1127:Core/Src/z_qflash_W25QXXX.c **** 
1128:Core/Src/z_qflash_W25QXXX.c **** #ifdef EXT_FLASH_QSPI_DMA_MODE
1129:Core/Src/z_qflash_W25QXXX.c **** 	while (!QSpiAvailable) {};  // waiting for a free QSPI port.
 3194              		.loc 1 1129 2 is_stmt 1 view .LVU936
 3195              	.L269:
 3196              		.loc 1 1129 26 discriminator 1 view .LVU937
 3197              		.loc 1 1129 8 discriminator 1 view .LVU938
 3198              		.loc 1 1129 9 is_stmt 0 discriminator 1 view .LVU939
 3199 0036 0F4B     		ldr	r3, .L276
 3200 0038 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3201              		.loc 1 1129 8 discriminator 1 view .LVU940
 3202 003a 002B     		cmp	r3, #0
 3203 003c FBD0     		beq	.L269
 3204              		.loc 1 1129 27 is_stmt 1 discriminator 2 view .LVU941
1130:Core/Src/z_qflash_W25QXXX.c **** 	QSpiAvailable=0;			//set QSPI busy
 3205              		.loc 1 1130 2 discriminator 2 view .LVU942
 3206              		.loc 1 1130 15 is_stmt 0 discriminator 2 view .LVU943
 3207 003e 0023     		movs	r3, #0
 3208 0040 0C4A     		ldr	r2, .L276
 3209 0042 1370     		strb	r3, [r2]
1131:Core/Src/z_qflash_W25QXXX.c **** 	QSpiReadDataAvailable=0;	//set data read unavailable yet
 3210              		.loc 1 1131 2 is_stmt 1 discriminator 2 view .LVU944
 3211              		.loc 1 1131 23 is_stmt 0 discriminator 2 view .LVU945
 3212 0044 0C4A     		ldr	r2, .L276+4
 3213 0046 1370     		strb	r3, [r2]
1132:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
 3214              		.loc 1 1132 5 is_stmt 1 discriminator 2 view .LVU946
 3215              		.loc 1 1132 9 is_stmt 0 discriminator 2 view .LVU947
 3216 0048 41F28832 		movw	r2, #5000
 3217 004c 6946     		mov	r1, sp
 3218 004e 0B48     		ldr	r0, .L276+8
 3219 0050 FFF7FEFF 		bl	HAL_QSPI_Command
 3220              	.LVL203:
 3221              		.loc 1 1132 8 discriminator 2 view .LVU948
 3222 0054 18B1     		cbz	r0, .L274
1133:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
 3223              		.loc 1 1133 16 view .LVU949
 3224 0056 0124     		movs	r4, #1
 3225              	.LVL204:
 3226              	.L270:
1134:Core/Src/z_qflash_W25QXXX.c ****     }
1135:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive_DMA(&FLASH_QSPI_PORT, (uint8_t *) dataptr) != HAL_OK) { // Receive data
1136:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
1137:Core/Src/z_qflash_W25QXXX.c ****     }
1138:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_WaitForDataAvailable(0);
1139:Core/Src/z_qflash_W25QXXX.c **** #else
1140:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Command(&FLASH_QSPI_PORT, &sCommand, QFLASH_DEF_TIMEOUT) != HAL_OK) {  //Send comm
ARM GAS  /tmp/ccdMdDsR.s 			page 83


1141:Core/Src/z_qflash_W25QXXX.c ****         return HAL_ERROR;
1142:Core/Src/z_qflash_W25QXXX.c ****     }
1143:Core/Src/z_qflash_W25QXXX.c ****     if (HAL_QSPI_Receive(&FLASH_QSPI_PORT, (uint8_t *) dataptr, QFLASH_DEF_TIMEOUT) != HAL_OK) { //
1144:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
1145:Core/Src/z_qflash_W25QXXX.c ****     }
1146:Core/Src/z_qflash_W25QXXX.c **** #endif //EXT_FLASH_QSPI_DMA_MODE
1147:Core/Src/z_qflash_W25QXXX.c **** 
1148:Core/Src/z_qflash_W25QXXX.c **** 	return HAL_OK;
1149:Core/Src/z_qflash_W25QXXX.c **** }
 3227              		.loc 1 1149 1 view .LVU950
 3228 0058 2046     		mov	r0, r4
 3229 005a 0EB0     		add	sp, sp, #56
 3230              	.LCFI91:
 3231              		.cfi_remember_state
 3232              		.cfi_def_cfa_offset 8
 3233              		@ sp needed
 3234 005c 10BD     		pop	{r4, pc}
 3235              	.LVL205:
 3236              	.L274:
 3237              	.LCFI92:
 3238              		.cfi_restore_state
1135:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3239              		.loc 1 1135 5 is_stmt 1 view .LVU951
1135:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3240              		.loc 1 1135 9 is_stmt 0 view .LVU952
 3241 005e 2146     		mov	r1, r4
 3242 0060 0648     		ldr	r0, .L276+8
 3243 0062 FFF7FEFF 		bl	HAL_QSPI_Receive_DMA
 3244              	.LVL206:
1135:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3245              		.loc 1 1135 8 view .LVU953
 3246 0066 0446     		mov	r4, r0
 3247              	.LVL207:
1135:Core/Src/z_qflash_W25QXXX.c ****     	return HAL_ERROR;
 3248              		.loc 1 1135 8 view .LVU954
 3249 0068 08B1     		cbz	r0, .L275
1136:Core/Src/z_qflash_W25QXXX.c ****     }
 3250              		.loc 1 1136 13 view .LVU955
 3251 006a 0124     		movs	r4, #1
 3252 006c F4E7     		b	.L270
 3253              	.L275:
1138:Core/Src/z_qflash_W25QXXX.c **** #else
 3254              		.loc 1 1138 2 is_stmt 1 view .LVU956
 3255 006e FFF7FEFF 		bl	QFlash_WaitForDataAvailable
 3256              	.LVL208:
1148:Core/Src/z_qflash_W25QXXX.c **** }
 3257              		.loc 1 1148 2 view .LVU957
1148:Core/Src/z_qflash_W25QXXX.c **** }
 3258              		.loc 1 1148 9 is_stmt 0 view .LVU958
 3259 0072 F1E7     		b	.L270
 3260              	.L277:
 3261              		.align	2
 3262              	.L276:
 3263 0074 00000000 		.word	.LANCHOR0
 3264 0078 00000000 		.word	.LANCHOR1
 3265 007c 00000000 		.word	hqspi
 3266              		.cfi_endproc
ARM GAS  /tmp/ccdMdDsR.s 			page 84


 3267              	.LFE172:
 3269              		.section	.text.DataReader_WaitForReceiveDone,"ax",%progbits
 3270              		.align	1
 3271              		.global	DataReader_WaitForReceiveDone
 3272              		.syntax unified
 3273              		.thumb
 3274              		.thumb_func
 3275              		.fpu fpv5-d16
 3277              	DataReader_WaitForReceiveDone:
 3278              	.LFB173:
1150:Core/Src/z_qflash_W25QXXX.c **** 
1151:Core/Src/z_qflash_W25QXXX.c **** 
1152:Core/Src/z_qflash_W25QXXX.c **** #endif //FLASH_QSPI_MEMORY_MAPPED
1153:Core/Src/z_qflash_W25QXXX.c **** 
1154:Core/Src/z_qflash_W25QXXX.c **** 
1155:Core/Src/z_qflash_W25QXXX.c **** 
1156:Core/Src/z_qflash_W25QXXX.c **** /**************************************
1157:Core/Src/z_qflash_W25QXXX.c ****  * functions required for TouchGFX
1158:Core/Src/z_qflash_W25QXXX.c ****  * integration
1159:Core/Src/z_qflash_W25QXXX.c ****  **************************************/
1160:Core/Src/z_qflash_W25QXXX.c **** 
1161:Core/Src/z_qflash_W25QXXX.c **** 
1162:Core/Src/z_qflash_W25QXXX.c **** void DataReader_WaitForReceiveDone(){
 3279              		.loc 1 1162 37 is_stmt 1 view -0
 3280              		.cfi_startproc
 3281              		@ args = 0, pretend = 0, frame = 0
 3282              		@ frame_needed = 0, uses_anonymous_args = 0
 3283              		@ link register save eliminated.
1163:Core/Src/z_qflash_W25QXXX.c **** // nothing to do, being reading always in polling mode
1164:Core/Src/z_qflash_W25QXXX.c **** 	return;
 3284              		.loc 1 1164 2 view .LVU960
1165:Core/Src/z_qflash_W25QXXX.c **** }
 3285              		.loc 1 1165 1 is_stmt 0 view .LVU961
 3286 0000 7047     		bx	lr
 3287              		.cfi_endproc
 3288              	.LFE173:
 3290              		.section	.text.DataReader_ReadData,"ax",%progbits
 3291              		.align	1
 3292              		.global	DataReader_ReadData
 3293              		.syntax unified
 3294              		.thumb
 3295              		.thumb_func
 3296              		.fpu fpv5-d16
 3298              	DataReader_ReadData:
 3299              	.LVL209:
 3300              	.LFB174:
1166:Core/Src/z_qflash_W25QXXX.c **** 
1167:Core/Src/z_qflash_W25QXXX.c **** void DataReader_ReadData(uint32_t address24, uint8_t* buffer, uint32_t length){
 3301              		.loc 1 1167 79 is_stmt 1 view -0
 3302              		.cfi_startproc
 3303              		@ args = 0, pretend = 0, frame = 0
 3304              		@ frame_needed = 0, uses_anonymous_args = 0
 3305              		.loc 1 1167 79 is_stmt 0 view .LVU963
 3306 0000 08B5     		push	{r3, lr}
 3307              	.LCFI93:
 3308              		.cfi_def_cfa_offset 8
 3309              		.cfi_offset 3, -8
ARM GAS  /tmp/ccdMdDsR.s 			page 85


 3310              		.cfi_offset 14, -4
1168:Core/Src/z_qflash_W25QXXX.c **** #ifdef FLASH_QSPI_MEMORY_MAPPED
1169:Core/Src/z_qflash_W25QXXX.c **** 	memcpy(buffer, (void *)0x90000000+address24, length);
1170:Core/Src/z_qflash_W25QXXX.c **** #else
1171:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_Read(address24, buffer, length);
 3311              		.loc 1 1171 2 is_stmt 1 view .LVU964
 3312 0002 FFF7FEFF 		bl	QFlash_Read
 3313              	.LVL210:
1172:Core/Src/z_qflash_W25QXXX.c **** #endif //FLASH_QSPI_MEMORY_MAPPED
1173:Core/Src/z_qflash_W25QXXX.c **** }
 3314              		.loc 1 1173 1 is_stmt 0 view .LVU965
 3315 0006 08BD     		pop	{r3, pc}
 3316              		.cfi_endproc
 3317              	.LFE174:
 3319              		.section	.text.DataReader_StartDMAReadData,"ax",%progbits
 3320              		.align	1
 3321              		.global	DataReader_StartDMAReadData
 3322              		.syntax unified
 3323              		.thumb
 3324              		.thumb_func
 3325              		.fpu fpv5-d16
 3327              	DataReader_StartDMAReadData:
 3328              	.LVL211:
 3329              	.LFB175:
1174:Core/Src/z_qflash_W25QXXX.c **** 
1175:Core/Src/z_qflash_W25QXXX.c **** 
1176:Core/Src/z_qflash_W25QXXX.c **** void DataReader_StartDMAReadData(uint32_t address24, uint8_t* buffer, uint32_t length){
 3330              		.loc 1 1176 87 is_stmt 1 view -0
 3331              		.cfi_startproc
 3332              		@ args = 0, pretend = 0, frame = 0
 3333              		@ frame_needed = 0, uses_anonymous_args = 0
 3334              		.loc 1 1176 87 is_stmt 0 view .LVU967
 3335 0000 08B5     		push	{r3, lr}
 3336              	.LCFI94:
 3337              		.cfi_def_cfa_offset 8
 3338              		.cfi_offset 3, -8
 3339              		.cfi_offset 14, -4
1177:Core/Src/z_qflash_W25QXXX.c **** //currently using polling mode
1178:Core/Src/z_qflash_W25QXXX.c **** #ifdef FLASH_QSPI_MEMORY_MAPPED
1179:Core/Src/z_qflash_W25QXXX.c **** 	memcpy(buffer, (void *)0x90000000+address24, length);
1180:Core/Src/z_qflash_W25QXXX.c **** #else
1181:Core/Src/z_qflash_W25QXXX.c **** 	QFlash_Read(address24, buffer, length);
 3340              		.loc 1 1181 2 is_stmt 1 view .LVU968
 3341 0002 FFF7FEFF 		bl	QFlash_Read
 3342              	.LVL212:
1182:Core/Src/z_qflash_W25QXXX.c **** #endif //FLASH_QSPI_MEMORY_MAPPED
1183:Core/Src/z_qflash_W25QXXX.c **** }
 3343              		.loc 1 1183 1 is_stmt 0 view .LVU969
 3344 0006 08BD     		pop	{r3, pc}
 3345              		.cfi_endproc
 3346              	.LFE175:
 3348              		.section	.text.HAL_QSPI_CmdCpltCallback,"ax",%progbits
 3349              		.align	1
 3350              		.global	HAL_QSPI_CmdCpltCallback
 3351              		.syntax unified
 3352              		.thumb
 3353              		.thumb_func
ARM GAS  /tmp/ccdMdDsR.s 			page 86


 3354              		.fpu fpv5-d16
 3356              	HAL_QSPI_CmdCpltCallback:
 3357              	.LVL213:
 3358              	.LFB176:
1184:Core/Src/z_qflash_W25QXXX.c **** 
1185:Core/Src/z_qflash_W25QXXX.c **** 
1186:Core/Src/z_qflash_W25QXXX.c **** void HAL_QSPI_CmdCpltCallback(QSPI_HandleTypeDef *l_hqspi) {
 3359              		.loc 1 1186 60 is_stmt 1 view -0
 3360              		.cfi_startproc
 3361              		@ args = 0, pretend = 0, frame = 0
 3362              		@ frame_needed = 0, uses_anonymous_args = 0
 3363              		@ link register save eliminated.
1187:Core/Src/z_qflash_W25QXXX.c **** 	if (l_hqspi==&FLASH_QSPI_PORT) {
 3364              		.loc 1 1187 2 view .LVU971
 3365              		.loc 1 1187 5 is_stmt 0 view .LVU972
 3366 0000 034B     		ldr	r3, .L286
 3367 0002 8342     		cmp	r3, r0
 3368 0004 00D0     		beq	.L285
 3369              	.L283:
1188:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
1189:Core/Src/z_qflash_W25QXXX.c **** 	}
1190:Core/Src/z_qflash_W25QXXX.c **** }
 3370              		.loc 1 1190 1 view .LVU973
 3371 0006 7047     		bx	lr
 3372              	.L285:
1188:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
 3373              		.loc 1 1188 3 is_stmt 1 view .LVU974
1188:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
 3374              		.loc 1 1188 16 is_stmt 0 view .LVU975
 3375 0008 024B     		ldr	r3, .L286+4
 3376 000a 0122     		movs	r2, #1
 3377 000c 1A70     		strb	r2, [r3]
 3378              		.loc 1 1190 1 view .LVU976
 3379 000e FAE7     		b	.L283
 3380              	.L287:
 3381              		.align	2
 3382              	.L286:
 3383 0010 00000000 		.word	hqspi
 3384 0014 00000000 		.word	.LANCHOR0
 3385              		.cfi_endproc
 3386              	.LFE176:
 3388              		.section	.text.HAL_QSPI_RxCpltCallback,"ax",%progbits
 3389              		.align	1
 3390              		.global	HAL_QSPI_RxCpltCallback
 3391              		.syntax unified
 3392              		.thumb
 3393              		.thumb_func
 3394              		.fpu fpv5-d16
 3396              	HAL_QSPI_RxCpltCallback:
 3397              	.LVL214:
 3398              	.LFB177:
1191:Core/Src/z_qflash_W25QXXX.c **** 
1192:Core/Src/z_qflash_W25QXXX.c **** 
1193:Core/Src/z_qflash_W25QXXX.c **** void HAL_QSPI_RxCpltCallback (QSPI_HandleTypeDef *l_hqspi){
 3399              		.loc 1 1193 59 is_stmt 1 view -0
 3400              		.cfi_startproc
 3401              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccdMdDsR.s 			page 87


 3402              		@ frame_needed = 0, uses_anonymous_args = 0
 3403              		@ link register save eliminated.
1194:Core/Src/z_qflash_W25QXXX.c **** 	if (l_hqspi==&FLASH_QSPI_PORT) {
 3404              		.loc 1 1194 2 view .LVU978
 3405              		.loc 1 1194 5 is_stmt 0 view .LVU979
 3406 0000 044B     		ldr	r3, .L291
 3407 0002 8342     		cmp	r3, r0
 3408 0004 00D0     		beq	.L290
 3409              	.L288:
1195:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available
1196:Core/Src/z_qflash_W25QXXX.c **** 		QSpiReadDataAvailable=1; 	//set data requested available flag
1197:Core/Src/z_qflash_W25QXXX.c **** 	}
1198:Core/Src/z_qflash_W25QXXX.c **** }
 3410              		.loc 1 1198 1 view .LVU980
 3411 0006 7047     		bx	lr
 3412              	.L290:
1195:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available
 3413              		.loc 1 1195 3 is_stmt 1 view .LVU981
1195:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available
 3414              		.loc 1 1195 16 is_stmt 0 view .LVU982
 3415 0008 0123     		movs	r3, #1
 3416 000a 034A     		ldr	r2, .L291+4
 3417 000c 1370     		strb	r3, [r2]
1196:Core/Src/z_qflash_W25QXXX.c **** 	}
 3418              		.loc 1 1196 3 is_stmt 1 view .LVU983
1196:Core/Src/z_qflash_W25QXXX.c **** 	}
 3419              		.loc 1 1196 24 is_stmt 0 view .LVU984
 3420 000e 034A     		ldr	r2, .L291+8
 3421 0010 1370     		strb	r3, [r2]
 3422              		.loc 1 1198 1 view .LVU985
 3423 0012 F8E7     		b	.L288
 3424              	.L292:
 3425              		.align	2
 3426              	.L291:
 3427 0014 00000000 		.word	hqspi
 3428 0018 00000000 		.word	.LANCHOR0
 3429 001c 00000000 		.word	.LANCHOR1
 3430              		.cfi_endproc
 3431              	.LFE177:
 3433              		.section	.text.HAL_QSPI_TxCpltCallback,"ax",%progbits
 3434              		.align	1
 3435              		.global	HAL_QSPI_TxCpltCallback
 3436              		.syntax unified
 3437              		.thumb
 3438              		.thumb_func
 3439              		.fpu fpv5-d16
 3441              	HAL_QSPI_TxCpltCallback:
 3442              	.LVL215:
 3443              	.LFB178:
1199:Core/Src/z_qflash_W25QXXX.c **** 
1200:Core/Src/z_qflash_W25QXXX.c **** 
1201:Core/Src/z_qflash_W25QXXX.c **** void HAL_QSPI_TxCpltCallback(QSPI_HandleTypeDef *l_hqspi) {
 3444              		.loc 1 1201 59 is_stmt 1 view -0
 3445              		.cfi_startproc
 3446              		@ args = 0, pretend = 0, frame = 0
 3447              		@ frame_needed = 0, uses_anonymous_args = 0
 3448              		@ link register save eliminated.
ARM GAS  /tmp/ccdMdDsR.s 			page 88


1202:Core/Src/z_qflash_W25QXXX.c **** 	if (l_hqspi==&FLASH_QSPI_PORT) {
 3449              		.loc 1 1202 2 view .LVU987
 3450              		.loc 1 1202 5 is_stmt 0 view .LVU988
 3451 0000 034B     		ldr	r3, .L296
 3452 0002 8342     		cmp	r3, r0
 3453 0004 00D0     		beq	.L295
 3454              	.L293:
1203:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
1204:Core/Src/z_qflash_W25QXXX.c **** 	}
1205:Core/Src/z_qflash_W25QXXX.c **** }
 3455              		.loc 1 1205 1 view .LVU989
 3456 0006 7047     		bx	lr
 3457              	.L295:
1203:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
 3458              		.loc 1 1203 3 is_stmt 1 view .LVU990
1203:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=1;			//set QuadSPI port available flag
 3459              		.loc 1 1203 16 is_stmt 0 view .LVU991
 3460 0008 024B     		ldr	r3, .L296+4
 3461 000a 0122     		movs	r2, #1
 3462 000c 1A70     		strb	r2, [r3]
 3463              		.loc 1 1205 1 view .LVU992
 3464 000e FAE7     		b	.L293
 3465              	.L297:
 3466              		.align	2
 3467              	.L296:
 3468 0010 00000000 		.word	hqspi
 3469 0014 00000000 		.word	.LANCHOR0
 3470              		.cfi_endproc
 3471              	.LFE178:
 3473              		.section	.text.HAL_QSPI_ErrorCallback,"ax",%progbits
 3474              		.align	1
 3475              		.global	HAL_QSPI_ErrorCallback
 3476              		.syntax unified
 3477              		.thumb
 3478              		.thumb_func
 3479              		.fpu fpv5-d16
 3481              	HAL_QSPI_ErrorCallback:
 3482              	.LVL216:
 3483              	.LFB179:
1206:Core/Src/z_qflash_W25QXXX.c **** 
1207:Core/Src/z_qflash_W25QXXX.c **** 
1208:Core/Src/z_qflash_W25QXXX.c **** /************************************************************
1209:Core/Src/z_qflash_W25QXXX.c ****  * @BRIEF	set to -1 global QSPI port availability flag
1210:Core/Src/z_qflash_W25QXXX.c ****  * 			in case of reading data, set to -1 even
1211:Core/Src/z_qflash_W25QXXX.c ****  * 			the Data availability flag
1212:Core/Src/z_qflash_W25QXXX.c ****  ************************************************************/
1213:Core/Src/z_qflash_W25QXXX.c **** void HAL_QSPI_ErrorCallback(QSPI_HandleTypeDef *l_hqspi){
 3484              		.loc 1 1213 57 is_stmt 1 view -0
 3485              		.cfi_startproc
 3486              		@ args = 0, pretend = 0, frame = 0
 3487              		@ frame_needed = 0, uses_anonymous_args = 0
 3488              		@ link register save eliminated.
1214:Core/Src/z_qflash_W25QXXX.c **** 	if (l_hqspi==&FLASH_QSPI_PORT) {
 3489              		.loc 1 1214 2 view .LVU994
 3490              		.loc 1 1214 5 is_stmt 0 view .LVU995
 3491 0000 064B     		ldr	r3, .L301
 3492 0002 8342     		cmp	r3, r0
ARM GAS  /tmp/ccdMdDsR.s 			page 89


 3493 0004 00D0     		beq	.L300
 3494              	.L298:
1215:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=-1;				//set QuadSPI port error
1216:Core/Src/z_qflash_W25QXXX.c **** 		if (!QSpiReadDataAvailable)		//if a data reading is running
1217:Core/Src/z_qflash_W25QXXX.c **** 			QSpiReadDataAvailable=-1; 	//notify the data reading failed
1218:Core/Src/z_qflash_W25QXXX.c **** 	}
1219:Core/Src/z_qflash_W25QXXX.c **** }
 3495              		.loc 1 1219 1 view .LVU996
 3496 0006 7047     		bx	lr
 3497              	.L300:
1215:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=-1;				//set QuadSPI port error
 3498              		.loc 1 1215 3 is_stmt 1 view .LVU997
1215:Core/Src/z_qflash_W25QXXX.c **** 		QSpiAvailable=-1;				//set QuadSPI port error
 3499              		.loc 1 1215 16 is_stmt 0 view .LVU998
 3500 0008 054B     		ldr	r3, .L301+4
 3501 000a FF22     		movs	r2, #255
 3502 000c 1A70     		strb	r2, [r3]
1216:Core/Src/z_qflash_W25QXXX.c **** 			QSpiReadDataAvailable=-1; 	//notify the data reading failed
 3503              		.loc 1 1216 3 is_stmt 1 view .LVU999
1216:Core/Src/z_qflash_W25QXXX.c **** 			QSpiReadDataAvailable=-1; 	//notify the data reading failed
 3504              		.loc 1 1216 7 is_stmt 0 view .LVU1000
 3505 000e 054B     		ldr	r3, .L301+8
 3506 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
1216:Core/Src/z_qflash_W25QXXX.c **** 			QSpiReadDataAvailable=-1; 	//notify the data reading failed
 3507              		.loc 1 1216 6 view .LVU1001
 3508 0012 002B     		cmp	r3, #0
 3509 0014 F7D1     		bne	.L298
1217:Core/Src/z_qflash_W25QXXX.c **** 	}
 3510              		.loc 1 1217 4 is_stmt 1 view .LVU1002
1217:Core/Src/z_qflash_W25QXXX.c **** 	}
 3511              		.loc 1 1217 25 is_stmt 0 view .LVU1003
 3512 0016 034B     		ldr	r3, .L301+8
 3513 0018 1A70     		strb	r2, [r3]
 3514              		.loc 1 1219 1 view .LVU1004
 3515 001a F4E7     		b	.L298
 3516              	.L302:
 3517              		.align	2
 3518              	.L301:
 3519 001c 00000000 		.word	hqspi
 3520 0020 00000000 		.word	.LANCHOR0
 3521 0024 00000000 		.word	.LANCHOR1
 3522              		.cfi_endproc
 3523              	.LFE179:
 3525              		.section	.data.QSpiAvailable,"aw"
 3526              		.set	.LANCHOR0,. + 0
 3529              	QSpiAvailable:
 3530 0000 01       		.byte	1
 3531              		.section	.data.QSpiReadDataAvailable,"aw"
 3532              		.set	.LANCHOR1,. + 0
 3535              	QSpiReadDataAvailable:
 3536 0000 01       		.byte	1
 3537              		.text
 3538              	.Letext0:
 3539              		.file 2 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/machine/_default_types.h"
 3540              		.file 3 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/sys/_stdint.h"
 3541              		.file 4 "Drivers/CMSIS/Include/core_cm7.h"
 3542              		.file 5 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/system_stm32h7xx.h"
ARM GAS  /tmp/ccdMdDsR.s 			page 90


 3543              		.file 6 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h753xx.h"
 3544              		.file 7 "/opt/gcc-arm-none-eabi-9-2020-q2-update/lib/gcc/arm-none-eabi/9.3.1/include/stddef.h"
 3545              		.file 8 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/sys/_types.h"
 3546              		.file 9 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/sys/reent.h"
 3547              		.file 10 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/sys/lock.h"
 3548              		.file 11 "/opt/gcc-arm-none-eabi-9-2020-q2-update/arm-none-eabi/include/math.h"
 3549              		.file 12 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 3550              		.file 13 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_mdma.h"
 3551              		.file 14 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_flash.h"
 3552              		.file 15 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_qspi.h"
 3553              		.file 16 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal.h"
 3554              		.file 17 "<built-in>"
ARM GAS  /tmp/ccdMdDsR.s 			page 91


DEFINED SYMBOLS
                            *ABS*:0000000000000000 z_qflash_W25QXXX.c
     /tmp/ccdMdDsR.s:17     .text.QFlash_IsQSPIAvailable:0000000000000000 $t
     /tmp/ccdMdDsR.s:25     .text.QFlash_IsQSPIAvailable:0000000000000000 QFlash_IsQSPIAvailable
     /tmp/ccdMdDsR.s:42     .text.QFlash_IsQSPIAvailable:0000000000000008 $d
     /tmp/ccdMdDsR.s:47     .text.QFlash_WaitForQSPIAvailable:0000000000000000 $t
     /tmp/ccdMdDsR.s:54     .text.QFlash_WaitForQSPIAvailable:0000000000000000 QFlash_WaitForQSPIAvailable
     /tmp/ccdMdDsR.s:118    .text.QFlash_WaitForQSPIAvailable:000000000000002c $d
     /tmp/ccdMdDsR.s:123    .text.QFlash_IsDataAvailable:0000000000000000 $t
     /tmp/ccdMdDsR.s:130    .text.QFlash_IsDataAvailable:0000000000000000 QFlash_IsDataAvailable
     /tmp/ccdMdDsR.s:146    .text.QFlash_IsDataAvailable:0000000000000008 $d
     /tmp/ccdMdDsR.s:151    .text.QFlash_WaitForDataAvailable:0000000000000000 $t
     /tmp/ccdMdDsR.s:158    .text.QFlash_WaitForDataAvailable:0000000000000000 QFlash_WaitForDataAvailable
     /tmp/ccdMdDsR.s:222    .text.QFlash_WaitForDataAvailable:000000000000002c $d
     /tmp/ccdMdDsR.s:227    .text.QFlash_DefaultCmd:0000000000000000 $t
     /tmp/ccdMdDsR.s:234    .text.QFlash_DefaultCmd:0000000000000000 QFlash_DefaultCmd
     /tmp/ccdMdDsR.s:281    .text.QFlash_Reset:0000000000000000 $t
     /tmp/ccdMdDsR.s:288    .text.QFlash_Reset:0000000000000000 QFlash_Reset
     /tmp/ccdMdDsR.s:412    .text.QFlash_Reset:0000000000000078 $d
     /tmp/ccdMdDsR.s:418    .text.QFlash_ReadJedecID:0000000000000000 $t
     /tmp/ccdMdDsR.s:425    .text.QFlash_ReadJedecID:0000000000000000 QFlash_ReadJedecID
     /tmp/ccdMdDsR.s:546    .text.QFlash_ReadJedecID:000000000000006c $d
     /tmp/ccdMdDsR.s:553    .text.QFlash_ReadSFDP:0000000000000000 $t
     /tmp/ccdMdDsR.s:560    .text.QFlash_ReadSFDP:0000000000000000 QFlash_ReadSFDP
     /tmp/ccdMdDsR.s:687    .text.QFlash_ReadSFDP:0000000000000078 $d
     /tmp/ccdMdDsR.s:694    .text.QFlash_Init:0000000000000000 $t
     /tmp/ccdMdDsR.s:701    .text.QFlash_Init:0000000000000000 QFlash_Init
     /tmp/ccdMdDsR.s:851    .text.QFlash_Read:0000000000000000 $t
     /tmp/ccdMdDsR.s:858    .text.QFlash_Read:0000000000000000 QFlash_Read
     /tmp/ccdMdDsR.s:987    .text.QFlash_Read:0000000000000070 $d
     /tmp/ccdMdDsR.s:994    .text.QFlash_WriteEnable:0000000000000000 $t
     /tmp/ccdMdDsR.s:1001   .text.QFlash_WriteEnable:0000000000000000 QFlash_WriteEnable
     /tmp/ccdMdDsR.s:1073   .text.QFlash_WriteEnable:0000000000000040 $d
     /tmp/ccdMdDsR.s:1079   .text.QFlash_WriteDisable:0000000000000000 $t
     /tmp/ccdMdDsR.s:1086   .text.QFlash_WriteDisable:0000000000000000 QFlash_WriteDisable
     /tmp/ccdMdDsR.s:1158   .text.QFlash_WriteDisable:0000000000000040 $d
     /tmp/ccdMdDsR.s:1164   .text.QFlash_ReadSR1:0000000000000000 $t
     /tmp/ccdMdDsR.s:1171   .text.QFlash_ReadSR1:0000000000000000 QFlash_ReadSR1
     /tmp/ccdMdDsR.s:1292   .text.QFlash_ReadSR1:000000000000006c $d
     /tmp/ccdMdDsR.s:1299   .text.QFlash_ReadSR2:0000000000000000 $t
     /tmp/ccdMdDsR.s:1306   .text.QFlash_ReadSR2:0000000000000000 QFlash_ReadSR2
     /tmp/ccdMdDsR.s:1427   .text.QFlash_ReadSR2:000000000000006c $d
     /tmp/ccdMdDsR.s:1434   .text.QFlash_ReadSR3:0000000000000000 $t
     /tmp/ccdMdDsR.s:1441   .text.QFlash_ReadSR3:0000000000000000 QFlash_ReadSR3
     /tmp/ccdMdDsR.s:1562   .text.QFlash_ReadSR3:000000000000006c $d
     /tmp/ccdMdDsR.s:1569   .text.QFlash_CheckSR1:0000000000000000 $t
     /tmp/ccdMdDsR.s:1576   .text.QFlash_CheckSR1:0000000000000000 QFlash_CheckSR1
     /tmp/ccdMdDsR.s:1642   .text.QFlash_WaitForWritingComplete:0000000000000000 $t
     /tmp/ccdMdDsR.s:1649   .text.QFlash_WaitForWritingComplete:0000000000000000 QFlash_WaitForWritingComplete
     /tmp/ccdMdDsR.s:1745   .text.QFlash_WaitForWritingComplete:0000000000000058 $d
     /tmp/ccdMdDsR.s:1752   .text.QFlash_WriteSR2:0000000000000000 $t
     /tmp/ccdMdDsR.s:1759   .text.QFlash_WriteSR2:0000000000000000 QFlash_WriteSR2
     /tmp/ccdMdDsR.s:1886   .text.QFlash_WriteSR2:0000000000000078 $d
     /tmp/ccdMdDsR.s:1893   .text.QFlash_WriteSR3:0000000000000000 $t
     /tmp/ccdMdDsR.s:1900   .text.QFlash_WriteSR3:0000000000000000 QFlash_WriteSR3
     /tmp/ccdMdDsR.s:2008   .text.QFlash_WriteSR3:000000000000006c $d
     /tmp/ccdMdDsR.s:2013   .text.QFlash_WriteASinglePage:0000000000000000 $t
ARM GAS  /tmp/ccdMdDsR.s 			page 92


     /tmp/ccdMdDsR.s:2020   .text.QFlash_WriteASinglePage:0000000000000000 QFlash_WriteASinglePage
     /tmp/ccdMdDsR.s:2138   .text.QFlash_WriteASinglePage:0000000000000068 $d
     /tmp/ccdMdDsR.s:2145   .text.QFlash_Write:0000000000000000 $t
     /tmp/ccdMdDsR.s:2152   .text.QFlash_Write:0000000000000000 QFlash_Write
     /tmp/ccdMdDsR.s:2302   .text.QFlash_SErase4k:0000000000000000 $t
     /tmp/ccdMdDsR.s:2309   .text.QFlash_SErase4k:0000000000000000 QFlash_SErase4k
     /tmp/ccdMdDsR.s:2424   .text.QFlash_SErase4k:0000000000000064 $d
     /tmp/ccdMdDsR.s:2430   .text.QFlash_BErase32k:0000000000000000 $t
     /tmp/ccdMdDsR.s:2437   .text.QFlash_BErase32k:0000000000000000 QFlash_BErase32k
     /tmp/ccdMdDsR.s:2552   .text.QFlash_BErase32k:0000000000000064 $d
     /tmp/ccdMdDsR.s:2558   .text.QFlash_BErase64k:0000000000000000 $t
     /tmp/ccdMdDsR.s:2565   .text.QFlash_BErase64k:0000000000000000 QFlash_BErase64k
     /tmp/ccdMdDsR.s:2680   .text.QFlash_BErase64k:0000000000000064 $d
     /tmp/ccdMdDsR.s:2686   .text.QFlash_ChipErase:0000000000000000 $t
     /tmp/ccdMdDsR.s:2693   .text.QFlash_ChipErase:0000000000000000 QFlash_ChipErase
     /tmp/ccdMdDsR.s:2794   .text.QFlash_ChipErase:000000000000005c $d
     /tmp/ccdMdDsR.s:2800   .text.QFlash_PowerDown:0000000000000000 $t
     /tmp/ccdMdDsR.s:2807   .text.QFlash_PowerDown:0000000000000000 QFlash_PowerDown
     /tmp/ccdMdDsR.s:2889   .text.QFlash_PowerDown:0000000000000048 $d
     /tmp/ccdMdDsR.s:2895   .text.QFlash_PowerUp:0000000000000000 $t
     /tmp/ccdMdDsR.s:2902   .text.QFlash_PowerUp:0000000000000000 QFlash_PowerUp
     /tmp/ccdMdDsR.s:2984   .text.QFlash_PowerUp:0000000000000048 $d
     /tmp/ccdMdDsR.s:2990   .text.QFlash_ReadDevID:0000000000000000 $t
     /tmp/ccdMdDsR.s:2997   .text.QFlash_ReadDevID:0000000000000000 QFlash_ReadDevID
     /tmp/ccdMdDsR.s:3123   .text.QFlash_ReadDevID:0000000000000074 $d
     /tmp/ccdMdDsR.s:3130   .text.QFlash_ReadManufactutrerAndDevID:0000000000000000 $t
     /tmp/ccdMdDsR.s:3137   .text.QFlash_ReadManufactutrerAndDevID:0000000000000000 QFlash_ReadManufactutrerAndDevID
     /tmp/ccdMdDsR.s:3263   .text.QFlash_ReadManufactutrerAndDevID:0000000000000074 $d
     /tmp/ccdMdDsR.s:3270   .text.DataReader_WaitForReceiveDone:0000000000000000 $t
     /tmp/ccdMdDsR.s:3277   .text.DataReader_WaitForReceiveDone:0000000000000000 DataReader_WaitForReceiveDone
     /tmp/ccdMdDsR.s:3291   .text.DataReader_ReadData:0000000000000000 $t
     /tmp/ccdMdDsR.s:3298   .text.DataReader_ReadData:0000000000000000 DataReader_ReadData
     /tmp/ccdMdDsR.s:3320   .text.DataReader_StartDMAReadData:0000000000000000 $t
     /tmp/ccdMdDsR.s:3327   .text.DataReader_StartDMAReadData:0000000000000000 DataReader_StartDMAReadData
     /tmp/ccdMdDsR.s:3349   .text.HAL_QSPI_CmdCpltCallback:0000000000000000 $t
     /tmp/ccdMdDsR.s:3356   .text.HAL_QSPI_CmdCpltCallback:0000000000000000 HAL_QSPI_CmdCpltCallback
     /tmp/ccdMdDsR.s:3383   .text.HAL_QSPI_CmdCpltCallback:0000000000000010 $d
     /tmp/ccdMdDsR.s:3389   .text.HAL_QSPI_RxCpltCallback:0000000000000000 $t
     /tmp/ccdMdDsR.s:3396   .text.HAL_QSPI_RxCpltCallback:0000000000000000 HAL_QSPI_RxCpltCallback
     /tmp/ccdMdDsR.s:3427   .text.HAL_QSPI_RxCpltCallback:0000000000000014 $d
     /tmp/ccdMdDsR.s:3434   .text.HAL_QSPI_TxCpltCallback:0000000000000000 $t
     /tmp/ccdMdDsR.s:3441   .text.HAL_QSPI_TxCpltCallback:0000000000000000 HAL_QSPI_TxCpltCallback
     /tmp/ccdMdDsR.s:3468   .text.HAL_QSPI_TxCpltCallback:0000000000000010 $d
     /tmp/ccdMdDsR.s:3474   .text.HAL_QSPI_ErrorCallback:0000000000000000 $t
     /tmp/ccdMdDsR.s:3481   .text.HAL_QSPI_ErrorCallback:0000000000000000 HAL_QSPI_ErrorCallback
     /tmp/ccdMdDsR.s:3519   .text.HAL_QSPI_ErrorCallback:000000000000001c $d
     /tmp/ccdMdDsR.s:3529   .data.QSpiAvailable:0000000000000000 QSpiAvailable
     /tmp/ccdMdDsR.s:3535   .data.QSpiReadDataAvailable:0000000000000000 QSpiReadDataAvailable

UNDEFINED SYMBOLS
HAL_GetTick
memset
HAL_QSPI_Command
HAL_Delay
hqspi
HAL_QSPI_Receive_DMA
HAL_QSPI_AutoPolling
ARM GAS  /tmp/ccdMdDsR.s 			page 93


HAL_QSPI_Transmit_DMA
HAL_QSPI_Transmit
